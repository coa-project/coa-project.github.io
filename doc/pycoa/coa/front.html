<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.1.0"/>
    <title>pycoa.coa.front API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../coa.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;pycoa.coa</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#about">About :</a></li>
  <li><a href="#basic-usage">Basic usage</a></li>
</ul>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#getversion">getversion</a>
            </li>
            <li>
                    <a class="function" href="#listoutput">listoutput</a>
            </li>
            <li>
                    <a class="function" href="#listvisu">listvisu</a>
            </li>
            <li>
                    <a class="function" href="#listwhom">listwhom</a>
            </li>
            <li>
                    <a class="function" href="#listwhat">listwhat</a>
            </li>
            <li>
                    <a class="function" href="#listhist">listhist</a>
            </li>
            <li>
                    <a class="function" href="#listplot">listplot</a>
            </li>
            <li>
                    <a class="function" href="#listoption">listoption</a>
            </li>
            <li>
                    <a class="function" href="#listtile">listtile</a>
            </li>
            <li>
                    <a class="function" href="#listwhich">listwhich</a>
            </li>
            <li>
                    <a class="function" href="#listwhere">listwhere</a>
            </li>
            <li>
                    <a class="function" href="#listbypop">listbypop</a>
            </li>
            <li>
                    <a class="function" href="#listmaplabel">listmaplabel</a>
            </li>
            <li>
                    <a class="function" href="#setwhom">setwhom</a>
            </li>
            <li>
                    <a class="function" href="#getwhom">getwhom</a>
            </li>
            <li>
                    <a class="function" href="#getkeywordinfo">getkeywordinfo</a>
            </li>
            <li>
                    <a class="function" href="#getrawdb">getrawdb</a>
            </li>
            <li>
                    <a class="function" href="#normbypop">normbypop</a>
            </li>
            <li>
                    <a class="function" href="#chartsinput_deco">chartsinput_deco</a>
            </li>
            <li>
                    <a class="function" href="#get">get</a>
            </li>
            <li>
                    <a class="function" href="#saveoutput">saveoutput</a>
            </li>
            <li>
                    <a class="function" href="#merger">merger</a>
            </li>
            <li>
                    <a class="function" href="#decomap">decomap</a>
            </li>
            <li>
                    <a class="function" href="#figuremap">figuremap</a>
            </li>
            <li>
                    <a class="function" href="#map">map</a>
            </li>
            <li>
                    <a class="function" href="#decohist">decohist</a>
            </li>
            <li>
                    <a class="function" href="#figurehist">figurehist</a>
            </li>
            <li>
                    <a class="function" href="#hist">hist</a>
            </li>
            <li>
                    <a class="function" href="#decoplot">decoplot</a>
            </li>
            <li>
                    <a class="function" href="#figureplot">figureplot</a>
            </li>
            <li>
                    <a class="function" href="#plot">plot</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
pycoa<wbr>.<a href="./../coa.html">coa</a><wbr>.front    </h1>

                        <div class="docstring"><p>Project : PyCoA - Copyright ©pycoa.fr
Date :    april 2020 - november 2023
Authors : Olivier Dadoun, Julien Browaeys, Tristan Beau
License: See joint LICENSE file</p>

<p>Module : coa.front</p>

<h2 id="about">About :</h2>

<p>This is the PyCoA front end functions. It provides easy access and
use of the whole PyCoA framework in a simplified way.
The use can change the database, the type of data, the output format
with keywords (see help of functions below).</p>

<h2 id="basic-usage">Basic usage</h2>

<p><em>* plotting covid deaths (default value) vs. time *</em>
    import coa.front as cf</p>

<pre><code>cf.plot(where='France')  # where keyword is mandatory
</code></pre>

<p><em>* getting recovered data for some countries *</em></p>

<pre><code>cf.get(where=['Spain','Italy'],which='recovered')
</code></pre>

<p><em>* listing available database and which data can be used *</em>
    cf.listwhom()
    cf.setwhom('jhu',reload=True) # return available keywords (aka 'which' data), reload DB is True by default
    cf.listwhich()   # idem
    cf.listwhat()    # return available time series type (weekly,
                     # daily...)
    cf.plot(option='sumall') # return the cumulative plot for all countries
                     # for default which keyword. See cf.listwhich() and
                    # and other cf.list**() function (see below)</p>
</div>

                        <input id="mod-front-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-front-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">&quot;&quot;&quot;Project : PyCoA - Copyright ©pycoa.fr</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">Date :    april 2020 - november 2023</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">Authors : Olivier Dadoun, Julien Browaeys, Tristan Beau</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">License: See joint LICENSE file</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">Module : coa.front</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">About :</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">-------</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">This is the PyCoA front end functions. It provides easy access and</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="sd">use of the whole PyCoA framework in a simplified way.</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">The use can change the database, the type of data, the output format</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">with keywords (see help of functions below).</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">Basic usage</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">-----------</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">** plotting covid deaths (default value) vs. time **</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="sd">    import coa.front as cf</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">    cf.plot(where=&#39;France&#39;)  # where keyword is mandatory</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">** getting recovered data for some countries **</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">    cf.get(where=[&#39;Spain&#39;,&#39;Italy&#39;],which=&#39;recovered&#39;)</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">** listing available database and which data can be used **</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">    cf.listwhom()</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">    cf.setwhom(&#39;jhu&#39;,reload=True) # return available keywords (aka &#39;which&#39; data), reload DB is True by default</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">    cf.listwhich()   # idem</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">    cf.listwhat()    # return available time series type (weekly,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">                     # daily...)</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    cf.plot(option=&#39;sumall&#39;) # return the cumulative plot for all countries</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">                     # for default which keyword. See cf.listwhich() and</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">                    # and other cf.list**() function (see below)</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="c1"># --- Imports ----------------------------------------------------------</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>    <span class="n">show</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>    <span class="n">output_notebook</span><span class="p">,</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="p">)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="kn">from</span> <span class="nn">coa.tools</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="n">kwargs_test</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>    <span class="n">extract_dates</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>    <span class="n">info</span><span class="p">,</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>    <span class="n">flat_list</span><span class="p">,</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="p">)</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="kn">import</span> <span class="nn">coa.covid19</span> <span class="k">as</span> <span class="nn">coco</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="kn">from</span> <span class="nn">coa.error</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="kn">import</span> <span class="nn">coa._version</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="kn">import</span> <span class="nn">coa.geo</span> <span class="k">as</span> <span class="nn">coge</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="kn">from</span> <span class="nn">coa.dbparser</span> <span class="kn">import</span> <span class="n">_db_list_dict</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="n">output_notebook</span><span class="p">(</span><span class="n">hide_banner</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="c1"># --- Needed global private variables ----------------------------------</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="n">_listwhom</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">_db_list_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="k">if</span> <span class="s1">&#39;coa_db&#39;</span> <span class="ow">in</span> <span class="n">__builtins__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">__builtins__</span><span class="p">[</span><span class="s1">&#39;coa_db&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">_listwhom</span><span class="p">:</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>        <span class="k">raise</span> <span class="n">CoaDbError</span><span class="p">(</span><span class="s2">&quot;The variable __builtin__.coa_db set to &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">__builtins__</span><span class="p">[</span><span class="s1">&#39;coa_db&#39;</span><span class="p">])</span> <span class="o">+</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>                         <span class="s2">&quot; which is an invalid db. Error.&quot;</span><span class="p">)</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>    <span class="n">_whom</span> <span class="o">=</span> <span class="n">__builtins__</span><span class="p">[</span><span class="s1">&#39;coa_db&#39;</span><span class="p">]</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="k">else</span><span class="p">:</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>    <span class="n">_whom</span> <span class="o">=</span> <span class="n">_listwhom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># default base</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="n">_gi</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="n">_dict_bypop</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;no&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;100&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span><span class="s1">&#39;1k&#39;</span><span class="p">:</span><span class="mf">1e3</span><span class="p">,</span><span class="s1">&#39;100k&#39;</span><span class="p">:</span><span class="mf">1e5</span><span class="p">,</span><span class="s1">&#39;1M&#39;</span><span class="p">:</span><span class="mf">1e6</span><span class="p">,</span><span class="s1">&#39;pop&#39;</span><span class="p">:</span><span class="mf">1.</span><span class="p">}</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="n">_listwhat</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="s1">&#39;daily&#39;</span><span class="p">,</span> <span class="s1">&#39;weekly&#39;</span><span class="p">]</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="n">_listoutput</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pandas&#39;</span><span class="p">,</span><span class="s1">&#39;geopandas&#39;</span><span class="p">,</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="s1">&#39;dict&#39;</span><span class="p">,</span> <span class="s1">&#39;array&#39;</span><span class="p">]</span>  <span class="c1"># first one is default for get</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="n">_listvisu</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bokeh&#39;</span><span class="p">,</span> <span class="s1">&#39;folium&#39;</span><span class="p">]</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="n">_listhist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bylocation&#39;</span><span class="p">,</span><span class="s1">&#39;byvalue&#39;</span><span class="p">,</span><span class="s1">&#39;pie&#39;</span><span class="p">]</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="n">_listplot</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span><span class="s1">&#39;menulocation&#39;</span><span class="p">,</span><span class="s1">&#39;versus&#39;</span><span class="p">,</span><span class="s1">&#39;spiral&#39;</span><span class="p">,</span><span class="s1">&#39;yearly&#39;</span><span class="p">]</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="n">_listmaplabel</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;textinteger&#39;</span><span class="p">,</span><span class="s1">&#39;spark&#39;</span><span class="p">,</span><span class="s1">&#39;spiral&#39;</span><span class="p">,</span><span class="s1">&#39;label%&#39;</span><span class="p">,</span><span class="s1">&#39;log&#39;</span><span class="p">,</span><span class="s1">&#39;unsorted&#39;</span><span class="p">,</span><span class="s1">&#39;exploded&#39;</span><span class="p">,</span><span class="s1">&#39;dense&#39;</span><span class="p">]</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="n">_listoption</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nonneg&#39;</span><span class="p">,</span> <span class="s1">&#39;nofillnan&#39;</span><span class="p">,</span> <span class="s1">&#39;smooth7&#39;</span><span class="p">,</span> <span class="s1">&#39;sumall&#39;</span><span class="p">]</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="c1"># --- Front end functions ----------------------------------------------</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="c1"># --- getversion() -----------------------------------------------------</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="k">def</span> <span class="nf">getversion</span><span class="p">():</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the current running version of pycoa.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>    <span class="k">return</span> <span class="n">coa</span><span class="o">.</span><span class="n">_version</span><span class="o">.</span><span class="n">__version__</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="c1"># --- listoutput() -----------------------------------------------------</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="k">def</span> <span class="nf">listoutput</span><span class="p">():</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently available output types for the</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">    get() function. The first one is the default output given if</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">    not specified.</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>    <span class="k">return</span> <span class="n">_listoutput</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="c1"># --- listvisu() -------------------------------------------------------</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="k">def</span> <span class="nf">listvisu</span><span class="p">():</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently available visualization for the</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">    map() function. The first one is the default output given if</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">    not specified.</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>    <span class="k">return</span> <span class="n">_listvisu</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="c1"># --- listwhom() -------------------------------------------------------</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="k">def</span> <span class="nf">listwhom</span><span class="p">(</span><span class="n">detailed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently avalailable databases for covid19</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">     data in PyCoA.</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">     The first one is the default one.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">     If detailed=True, gives information location of each given database.</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">_db_list_dict</span><span class="p">)</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>    <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Database&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;WW/iso3&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;Granularité&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="s1">&#39;WW/Name&#39;</span><span class="p">})</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Database&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">detailed</span><span class="p">):</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">([{</span><span class="s1">&#39;selector&#39;</span> <span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;props&#39;</span> <span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;border&#39;</span><span class="p">,</span><span class="s1">&#39;3px solid green&#39;</span><span class="p">)]}]))</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pandas has been pimped, use &#39;.data&#39; to get a pandas dataframe&quot;</span><span class="p">)</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>            <span class="k">return</span> <span class="n">df</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Database&#39;</span><span class="p">])</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>    <span class="k">except</span><span class="p">:</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Waiting for a boolean !&#39;</span><span class="p">)</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="c1"># --- listwhat() -------------------------------------------------------</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="k">def</span> <span class="nf">listwhat</span><span class="p">():</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently avalailable type of series available.</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">     The first one is the default one.</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>    <span class="k">return</span> <span class="n">_listwhat</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="c1"># --- listhist() -------------------------------------------------------</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="k">def</span> <span class="nf">listhist</span><span class="p">():</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently avalailable type of hist available.</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">     The first one is the default one.</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>    <span class="k">return</span> <span class="n">_listhist</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="c1"># --- listplot() -------------------------------------------------------</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="k">def</span> <span class="nf">listplot</span><span class="p">():</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently avalailable type of plots available.</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">     The first one is the default one.</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>    <span class="k">return</span> <span class="n">_listplot</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="c1"># --- listoption() -----------------------------------------------------</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="k">def</span> <span class="nf">listoption</span><span class="p">():</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently avalailable option apply to data.</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">     Default is no option.</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>    <span class="k">return</span> <span class="n">_listoption</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="c1"># --- listtile() -------------------------------------------------------</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="k">def</span> <span class="nf">listtile</span><span class="p">():</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently avalailable tile option for map()</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="sd">     Default is the first one.</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>    <span class="k">return</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">tiles_list</span><span class="p">()</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="c1"># --- listwhich() ------------------------------------------------------</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="k">def</span> <span class="nf">listwhich</span><span class="p">():</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get which are the available fields for the current base.</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">    Output is a list of string.</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">    By default, the listwhich()[0] is the default which field in other</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">    functions.</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>    <span class="k">if</span>  <span class="s1">&#39;_db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;setwhom MUST be defined first !&#39;</span><span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">_db</span><span class="o">.</span><span class="n">get_parserdb</span><span class="p">()</span><span class="o">.</span><span class="n">get_available_keywords</span><span class="p">())</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="c1"># --- listwhere() ------------------------------------------------------</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="k">def</span> <span class="nf">listwhere</span><span class="p">(</span><span class="n">clustered</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list of available regions/subregions managed by the current database</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>    <span class="k">if</span>  <span class="s1">&#39;_db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;setwhom MUST be defined first !&#39;</span><span class="p">)</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>        <span class="k">def</span> <span class="nf">clust</span><span class="p">():</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>            <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nation&#39;</span> <span class="ow">and</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;World&#39;</span><span class="p">,</span><span class="s1">&#39;Europe&#39;</span><span class="p">]:</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>                <span class="k">return</span>  <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">to_standard</span><span class="p">(</span><span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">get_region_list</span><span class="p">()</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>                    <span class="n">r</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;name_region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>                <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>                <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Europe&#39;</span><span class="p">:</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>                    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;European Union&#39;</span><span class="p">)</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>                <span class="k">return</span> <span class="n">r</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nation&#39;</span> <span class="ow">and</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;World&#39;</span><span class="p">,</span><span class="s1">&#39;Europe&#39;</span><span class="p">]:</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>            <span class="k">return</span> <span class="p">[</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="p">]</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="n">clustered</span><span class="p">:</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>            <span class="k">return</span> <span class="n">clust</span><span class="p">()</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>            <span class="k">if</span> <span class="n">_db</span><span class="o">.</span><span class="n">db_world</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>                <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nation&#39;</span> <span class="ow">and</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;World&#39;</span><span class="p">,</span><span class="s1">&#39;Europe&#39;</span><span class="p">]:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>                    <span class="n">r</span> <span class="o">=</span>  <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">to_standard</span><span class="p">(</span><span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>                    <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;World&#39;</span><span class="p">:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>                        <span class="n">r</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">get_GeoRegion</span><span class="p">()</span><span class="o">.</span><span class="n">get_countries_from_region</span><span class="p">(</span><span class="s1">&#39;world&#39;</span><span class="p">)</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>                        <span class="n">r</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">get_GeoRegion</span><span class="p">()</span><span class="o">.</span><span class="n">get_countries_from_region</span><span class="p">(</span><span class="s1">&#39;europe&#39;</span><span class="p">)</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>                    <span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">to_standard</span><span class="p">(</span><span class="n">c</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">r</span><span class="p">]</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>                <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;subregion&#39;</span><span class="p">:</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>                    <span class="n">pan</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">get_subregion_list</span><span class="p">()</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>                    <span class="n">r</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pan</span><span class="o">.</span><span class="n">name_subregion</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>                <span class="k">elif</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;region&#39;</span><span class="p">:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>                    <span class="n">r</span> <span class="o">=</span> <span class="n">clust</span><span class="p">()</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>                    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>                    <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;What is the granularity of your DB ?&#39;</span><span class="p">)</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>            <span class="k">return</span> <span class="n">r</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="c1"># --- listbypop() ------------------------------------------------------</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="k">def</span> <span class="nf">listbypop</span><span class="p">():</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list of available population normalization</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">_dict_bypop</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="c1"># --- listmaplabel() ------------------------------------------------------</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="k">def</span> <span class="nf">listmaplabel</span><span class="p">():</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list of available population normalization</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>    <span class="k">return</span> <span class="n">_listmaplabel</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="c1"># --- setwhom() --------------------------------------------------------</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="k">def</span> <span class="nf">setwhom</span><span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the covid19 database used, given as a string.</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">    Please see pycoa.listbase() for the available current list.</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="sd">    By default, the listbase()[0] is the default base used in other</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">    functions.</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>    <span class="n">kwargs_test</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;reload&#39;</span><span class="p">],</span> <span class="s1">&#39;Bad args used in the pycoa.saveoutput function.&#39;</span><span class="p">)</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>    <span class="n">refresh</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reload&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>    <span class="k">if</span> <span class="n">refresh</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="k">raise</span> <span class="n">CoaError</span><span class="p">(</span><span class="s1">&#39;reload must be a boolean ... &#39;</span><span class="p">)</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>    <span class="k">if</span> <span class="n">base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listwhom</span><span class="p">():</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>        <span class="k">raise</span> <span class="n">CoaDbError</span><span class="p">(</span><span class="n">base</span> <span class="o">+</span> <span class="s1">&#39; is not a supported database. &#39;</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>                                <span class="s1">&#39;See pycoa.listbase() for the full list.&#39;</span><span class="p">)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>        <span class="k">if</span> <span class="s1">&#39;_db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>            <span class="k">global</span> <span class="n">_db</span><span class="p">,</span> <span class="n">_cocoplot</span><span class="p">,</span> <span class="n">_whom</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>        <span class="n">_db</span><span class="p">,</span> <span class="n">_cocoplot</span> <span class="o">=</span> <span class="n">coco</span><span class="o">.</span><span class="n">DataBase</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="n">refresh</span><span class="p">)</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">refresh</span><span class="p">:</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>            <span class="n">_db</span><span class="o">.</span><span class="n">get_parserdb</span><span class="p">()</span><span class="o">.</span><span class="n">get_echoinfo</span><span class="p">()</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>        <span class="n">_whom</span> <span class="o">=</span> <span class="n">base</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="c1"># --- getwhom() --------------------------------------------------------</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="k">def</span> <span class="nf">getwhom</span><span class="p">(</span><span class="n">return_error</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the current base which is used</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>    <span class="k">if</span>  <span class="s1">&#39;_db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>        <span class="c1">#if return_error:</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="c1">#    raise CoaKeyError(&#39;setwhom MUST be defined first !&#39;)</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>        <span class="c1">#else:</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>        <span class="k">return</span> <span class="n">_whom</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="c1"># --- get(**kwargs) ----------------------------------------------------</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="k">def</span> <span class="nf">getkeywordinfo</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">        Return keyword_definition for the db selected</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>    <span class="k">if</span>  <span class="s1">&#39;_db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;setwhom MUST be defined first !&#39;</span><span class="p">)</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="k">if</span> <span class="n">which</span><span class="p">:</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>            <span class="k">if</span> <span class="n">which</span> <span class="ow">in</span> <span class="n">listwhich</span><span class="p">():</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>                <span class="nb">print</span><span class="p">(</span><span class="n">_db</span><span class="o">.</span><span class="n">get_parserdb</span><span class="p">()</span><span class="o">.</span><span class="n">get_keyword_definition</span><span class="p">(</span><span class="n">which</span><span class="p">))</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Parsed from this url:&#39;</span><span class="p">,</span><span class="n">_db</span><span class="o">.</span><span class="n">get_parserdb</span><span class="p">()</span><span class="o">.</span><span class="n">get_keyword_url</span><span class="p">(</span><span class="n">which</span><span class="p">))</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>                <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;This value do not exist please check.&#39;</span><span class="o">+</span><span class="s1">&#39;Available variable so far in this db &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">listwhich</span><span class="p">()))</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">get_parserdb</span><span class="p">()</span><span class="o">.</span><span class="n">get_dbdescription</span><span class="p">()</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>            <span class="k">return</span> <span class="n">df</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="k">def</span> <span class="nf">getrawdb</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a><span class="sd">        Return the main pandas i.e with all the which values loaded from the database selected</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>    <span class="n">col</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">_db</span><span class="o">.</span><span class="n">get_fulldb</span><span class="p">()</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>    <span class="n">mem</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:,}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_db</span><span class="o">.</span><span class="n">get_fulldb</span><span class="p">()[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>    <span class="n">info</span><span class="p">(</span><span class="s1">&#39;Memory usage of all columns: &#39;</span> <span class="o">+</span> <span class="n">mem</span> <span class="o">+</span> <span class="s1">&#39; bytes&#39;</span><span class="p">)</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">get_fulldb</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>    <span class="k">return</span> <span class="n">df</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="c1"># --- Normalisation by pop input pandas return pandas whith by pop new column</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="c1"># ---------------------------------------------------------------------</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="k">def</span> <span class="nf">normbypop</span><span class="p">(</span><span class="n">pandy</span><span class="p">,</span> <span class="n">val2norm</span><span class="p">,</span><span class="n">bypop</span><span class="p">):</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">        Return a pandas with a normalisation column add by population</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">        * can normalize by &#39;100&#39;, &#39;1k&#39;, &#39;100k&#39; or &#39;1M&#39;</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>    <span class="k">global</span> <span class="n">_gi</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>    <span class="k">if</span> <span class="n">pandy</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Seems to be an empty field&#39;</span><span class="p">)</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;codelocation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">list</span><span class="p">):</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="n">pandy</span> <span class="o">=</span> <span class="n">pandy</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>    <span class="k">if</span> <span class="n">_db</span><span class="o">.</span><span class="n">db_world</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_gi</span><span class="p">,</span><span class="n">coa</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">GeoInfo</span><span class="p">):</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>            <span class="n">_gi</span> <span class="o">=</span> <span class="n">coge</span><span class="o">.</span><span class="n">GeoInfo</span><span class="p">()</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>        <span class="n">pop_field</span><span class="o">=</span><span class="s1">&#39;population&#39;</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>        <span class="n">pandy</span> <span class="o">=</span> <span class="n">_gi</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">pandy</span><span class="p">,</span><span class="n">field</span><span class="o">=</span><span class="n">pop_field</span><span class="p">,</span><span class="n">geofield</span><span class="o">=</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_gi</span><span class="p">,</span><span class="n">coa</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">GeoCountry</span><span class="p">):</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>            <span class="n">_gi</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>            <span class="k">if</span> <span class="n">_gi</span><span class="o">.</span><span class="n">get_country</span><span class="p">()</span> <span class="o">!=</span> <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">get_country</span><span class="p">():</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>                <span class="n">_gi</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="k">if</span> <span class="n">_gi</span> <span class="o">==</span> <span class="kc">None</span> <span class="p">:</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>            <span class="n">_gi</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">geo</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>        <span class="n">pop_field</span><span class="o">=</span><span class="s1">&#39;population_subregion&#39;</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>        <span class="k">if</span> <span class="n">pop_field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_gi</span><span class="o">.</span><span class="n">get_list_properties</span><span class="p">():</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;The population information not available for this country. No normalization possible&#39;</span><span class="p">)</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>        <span class="n">pandy</span><span class="o">=</span><span class="n">_gi</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">pandy</span><span class="p">,</span><span class="n">field</span><span class="o">=</span><span class="n">pop_field</span><span class="p">,</span><span class="n">input_key</span><span class="o">=</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>    <span class="n">clust</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;clustername&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">clust</span><span class="p">:</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>        <span class="n">pandyi</span> <span class="o">=</span> <span class="n">pandy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;clustername&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span> <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>        <span class="n">pandyi</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">pop_field</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandyi</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)[</span><span class="n">pop_field</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pandyi</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)[</span><span class="s1">&#39;codelocation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="n">cody</span> <span class="o">=</span> <span class="n">pandyi</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)[</span><span class="s1">&#39;codelocation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">pandyi</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="n">cody</span> <span class="o">=</span> <span class="p">[</span><span class="n">pandyi</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)[</span><span class="s1">&#39;codelocation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">pandyi</span><span class="p">)</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="n">pandyi</span> <span class="o">=</span> <span class="n">pandyi</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">codelocation</span><span class="o">=</span><span class="n">cody</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pandyi</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span><span class="n">pandyi</span><span class="p">])</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s1">&#39;date&#39;</span><span class="p">,</span><span class="s1">&#39;clustername&#39;</span><span class="p">])</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>    <span class="n">pandy</span> <span class="o">=</span> <span class="n">df</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>    <span class="n">pandy</span><span class="o">=</span><span class="n">pandy</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>    <span class="n">pandy</span><span class="p">[</span><span class="n">pop_field</span><span class="p">]</span><span class="o">=</span><span class="n">pandy</span><span class="p">[</span><span class="n">pop_field</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>    <span class="k">if</span> <span class="n">bypop</span> <span class="o">==</span> <span class="s1">&#39;pop&#39;</span><span class="p">:</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>        <span class="n">pandy</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">val2norm</span><span class="o">+</span><span class="s1">&#39; per total population&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">pandy</span><span class="p">[</span><span class="n">val2norm</span><span class="p">]</span><span class="o">/</span><span class="n">pandy</span><span class="p">[</span><span class="n">pop_field</span><span class="p">]</span><span class="o">*</span><span class="n">_dict_bypop</span><span class="p">[</span><span class="n">bypop</span><span class="p">]</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>        <span class="n">pandy</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">val2norm</span><span class="o">+</span><span class="s1">&#39; per &#39;</span><span class="o">+</span><span class="n">bypop</span> <span class="o">+</span> <span class="s1">&#39; population&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">pandy</span><span class="p">[</span><span class="n">val2norm</span><span class="p">]</span><span class="o">/</span><span class="n">pandy</span><span class="p">[</span><span class="n">pop_field</span><span class="p">]</span><span class="o">*</span><span class="n">_dict_bypop</span><span class="p">[</span><span class="n">bypop</span><span class="p">]</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>    <span class="k">return</span> <span class="n">pandy</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a><span class="c1"># --- chartsinput_deco(f)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="c1"># ------  with wraps</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="c1"># ----------  wrapper(*args, **kwargs)</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="c1">#---------------------------------------</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="k">def</span> <span class="nf">chartsinput_deco</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">        Main decorator it mainly deals with arg testings</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">            wrapper dealing with arg testing</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>        <span class="n">kwargs_test</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>                    <span class="p">[</span><span class="s1">&#39;where&#39;</span><span class="p">,</span> <span class="s1">&#39;what&#39;</span><span class="p">,</span> <span class="s1">&#39;which&#39;</span><span class="p">,</span> <span class="s1">&#39;whom&#39;</span><span class="p">,</span><span class="s1">&#39;reload&#39;</span><span class="p">,</span><span class="s1">&#39;when&#39;</span><span class="p">,</span> <span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="s1">&#39;input_field&#39;</span><span class="p">,</span><span class="s1">&#39;output&#39;</span><span class="p">,</span>\
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>                    <span class="s1">&#39;title&#39;</span><span class="p">,</span><span class="s1">&#39;typeofplot&#39;</span><span class="p">,</span><span class="s1">&#39;typeofhist&#39;</span><span class="p">,</span><span class="s1">&#39;bins&#39;</span><span class="p">,</span><span class="s1">&#39;visu&#39;</span><span class="p">,</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span><span class="s1">&#39;dateslider&#39;</span><span class="p">,</span><span class="s1">&#39;maplabel&#39;</span><span class="p">,</span><span class="s1">&#39;option&#39;</span><span class="p">,</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>                    <span class="s1">&#39;mode&#39;</span><span class="p">,</span><span class="s1">&#39;guideline&#39;</span><span class="p">,</span><span class="s1">&#39;bypop&#39;</span><span class="p">,</span> <span class="s1">&#39;plot_width&#39;</span><span class="p">,</span><span class="s1">&#39;plot_height&#39;</span><span class="p">,</span><span class="s1">&#39;textcopyright&#39;</span><span class="p">,</span><span class="s1">&#39;cursor_date&#39;</span><span class="p">],</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>                    <span class="s1">&#39;Bad args used in the pycoa function.&#39;</span><span class="p">)</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>    <span class="c1"># no dateslider currently</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>        <span class="k">if</span> <span class="s1">&#39;_db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>            <span class="k">global</span> <span class="n">_db</span><span class="p">,</span> <span class="n">_cocoplot</span><span class="p">,</span> <span class="n">_whom</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>            <span class="n">_db</span><span class="p">,</span> <span class="n">_cocoplot</span> <span class="o">=</span> <span class="n">coco</span><span class="o">.</span><span class="n">DataBase</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">_whom</span><span class="p">)</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>            <span class="c1">#raise CoaKeyError(&#39;No database has been selected. You MUST define one using \&quot;setwhom()\&quot; &#39;)</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>        <span class="n">where</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;where&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>        <span class="n">which</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;which&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>        <span class="n">what</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;what&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>        <span class="n">whom</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;whom&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>        <span class="n">option</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>        <span class="n">when</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;when&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>        <span class="n">input_arg</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">option</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">what</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">input_field</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;option/what not compatible when input_fied/which is a list&#39;</span><span class="p">)</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>        <span class="k">if</span> <span class="s1">&#39;input_field&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>            <span class="n">which</span> <span class="o">=</span> <span class="n">input_field</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>            <span class="n">which</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>        <span class="k">if</span> <span class="n">what</span><span class="p">:</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>            <span class="k">if</span> <span class="n">what</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listwhat</span><span class="p">():</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>                <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;What option &#39;</span> <span class="o">+</span> <span class="n">what</span> <span class="o">+</span> <span class="s1">&#39; not supported. &#39;</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>                                                          <span class="s1">&#39;See listwhat() for full list.&#39;</span><span class="p">)</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>            <span class="k">if</span> <span class="s1">&#39;what&#39;</span><span class="o">==</span><span class="s1">&#39;sandard&#39;</span><span class="p">:</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>                <span class="n">what</span> <span class="o">=</span> <span class="n">which</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>            <span class="n">what</span> <span class="o">=</span> <span class="n">_listwhat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>        <span class="n">option</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="n">bypop</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">,</span><span class="s1">&#39;no&#39;</span><span class="p">)</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="n">listoutput</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listoutput</span><span class="p">():</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Output option &#39;</span> <span class="o">+</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; not supported. See help().&#39;</span><span class="p">)</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="k">if</span> <span class="n">whom</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>            <span class="n">whom</span> <span class="o">=</span> <span class="n">_whom</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>        <span class="k">if</span> <span class="n">whom</span> <span class="o">!=</span> <span class="n">_whom</span><span class="p">:</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>            <span class="n">setwhom</span><span class="p">(</span><span class="n">whom</span><span class="p">)</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>        <span class="k">if</span> <span class="n">bypop</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listbypop</span><span class="p">():</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;The bypop arg should be selected in &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">listbypop</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; only.&#39;</span><span class="p">)</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_arg</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>            <span class="k">if</span> <span class="n">input_arg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">input_arg</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>                <span class="n">pandy</span> <span class="o">=</span> <span class="n">input_arg</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>                <span class="n">pandy</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">get_stats</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>                <span class="n">pandy</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>                <span class="n">input_field</span> <span class="o">=</span> <span class="n">which</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">which</span><span class="p">):</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">get_stats</span><span class="p">(</span><span class="n">input_field</span><span class="o">=</span><span class="n">input_field</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">option</span><span class="p">)</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>                    <span class="k">if</span> <span class="n">pandy</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>                        <span class="n">pandy</span> <span class="o">=</span> <span class="n">tmp</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>                        <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span><span class="s1">&#39;weekly&#39;</span><span class="p">,</span><span class="s1">&#39;codelocation&#39;</span><span class="p">,</span><span class="s1">&#39;clustername&#39;</span><span class="p">])</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>                    <span class="n">pandy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">pandy</span><span class="p">,</span> <span class="n">tmp</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span><span class="s1">&#39;where&#39;</span><span class="p">])</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>                <span class="n">input_arg</span> <span class="o">=</span> <span class="n">pandy</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>            <span class="k">if</span> <span class="n">bypop</span> <span class="o">!=</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>                <span class="n">input_arg</span> <span class="o">=</span> <span class="n">normbypop</span><span class="p">(</span><span class="n">pandy</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="n">bypop</span><span class="p">)</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>                <span class="k">if</span> <span class="n">bypop</span><span class="o">==</span><span class="s1">&#39;pop&#39;</span><span class="p">:</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>                    <span class="n">input_field</span> <span class="o">=</span> <span class="n">input_field</span><span class="o">+</span><span class="s1">&#39; per total population&#39;</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>                    <span class="n">input_field</span> <span class="o">=</span> <span class="n">input_field</span><span class="o">+</span><span class="s1">&#39; per &#39;</span><span class="o">+</span> <span class="n">bypop</span> <span class="o">+</span> <span class="s1">&#39; population&#39;</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>                <span class="n">pandy</span> <span class="o">=</span> <span class="n">input_arg</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_field</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>                <span class="n">which</span> <span class="o">=</span> <span class="n">input_field</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>            <span class="c1">#else:</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>            <span class="c1">#    which = input_field</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>            <span class="c1">#if which is None:</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>            <span class="c1">#    which = pandy.columns[2]</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>            <span class="n">pandy</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;standard&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[</span><span class="n">which</span><span class="p">]</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>            <span class="k">if</span> <span class="s1">&#39;input_field&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_field</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>            <span class="c1">#if option:</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>            <span class="c1">#    print(&#39;option has no effect here, please try do it when you construct your input pandas &#39;)</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>        <span class="k">elif</span> <span class="n">input_arg</span> <span class="o">==</span> <span class="kc">None</span> <span class="p">:</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>            <span class="c1">#kwargs.pop(&#39;input_field&#39;)</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>            <span class="n">pandy</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">get_stats</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>            <span class="k">if</span> <span class="n">which</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>                <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;standard&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[</span><span class="n">which</span><span class="p">]</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>                <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;standard&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[</span><span class="n">pandy</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>                <span class="n">which</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pandy</span><span class="o">.</span><span class="n">columns</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>            <span class="n">input_field</span> <span class="o">=</span> <span class="n">what</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>            <span class="k">if</span> <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>                <span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------&#39;</span><span class="p">)</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>                <span class="n">info</span><span class="p">(</span><span class="s1">&#39;All values for &#39;</span><span class="o">+</span> <span class="n">which</span> <span class="o">+</span> <span class="s1">&#39; is nan nor empty&#39;</span><span class="p">)</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>                <span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------&#39;</span><span class="p">)</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>                <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">where</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()]</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>                <span class="n">lwhere</span><span class="o">=</span><span class="n">flat_list</span><span class="p">([[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">where</span><span class="p">])</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>                <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;where&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">lwhere</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>                <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;clustername&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">lwhere</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>                <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;codelocation&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">pandy</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;000&#39;</span><span class="p">]</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>                <span class="n">pandy</span><span class="o">=</span><span class="n">pandy</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>                <span class="n">bypop</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>            <span class="k">if</span> <span class="n">bypop</span> <span class="o">!=</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>                <span class="k">if</span> <span class="n">what</span><span class="p">:</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>                    <span class="n">val</span> <span class="o">=</span> <span class="n">what</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>                    <span class="n">val</span> <span class="o">=</span> <span class="n">_listwhat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>                <span class="n">pandy</span> <span class="o">=</span> <span class="n">normbypop</span><span class="p">(</span><span class="n">pandy</span> <span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">bypop</span><span class="p">)</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>                <span class="k">if</span> <span class="n">bypop</span><span class="o">==</span><span class="s1">&#39;pop&#39;</span><span class="p">:</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>                    <span class="n">input_field</span> <span class="o">=</span> <span class="n">input_field</span><span class="o">+</span><span class="s1">&#39; per total population&#39;</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>                    <span class="n">input_field</span> <span class="o">=</span> <span class="n">input_field</span><span class="o">+</span><span class="s1">&#39; per &#39;</span><span class="o">+</span> <span class="n">bypop</span> <span class="o">+</span> <span class="s1">&#39; population&#39;</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_field</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>            <span class="n">option</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>            <span class="k">raise</span> <span class="n">CoaTypeError</span><span class="p">(</span><span class="s1">&#39;Waiting input as valid pycoa pandas &#39;</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>                               <span class="s1">&#39;dataframe. See help.&#39;</span><span class="p">)</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>        <span class="n">when_beg</span><span class="p">,</span> <span class="n">when_end</span> <span class="o">=</span> <span class="n">extract_dates</span><span class="p">(</span><span class="n">when</span><span class="p">)</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>        <span class="k">if</span> <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>            <span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------&#39;</span><span class="p">)</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>            <span class="n">info</span><span class="p">(</span><span class="s1">&#39;All values for &#39;</span><span class="o">+</span> <span class="n">which</span> <span class="o">+</span> <span class="s1">&#39; is nan nor empty&#39;</span><span class="p">)</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>            <span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------&#39;</span><span class="p">)</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>            <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">where</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()]</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>            <span class="n">lwhere</span><span class="o">=</span><span class="n">flat_list</span><span class="p">([[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">where</span><span class="p">])</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>            <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;where&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">lwhere</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>            <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;clustername&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">lwhere</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>            <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;codelocation&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">pandy</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;000&#39;</span><span class="p">]</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>            <span class="n">pandy</span><span class="o">=</span><span class="n">pandy</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>            <span class="n">bypop</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>        <span class="n">db_first_date</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>        <span class="n">db_last_date</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>        <span class="k">if</span> <span class="n">when_beg</span> <span class="o">&lt;</span> <span class="n">db_first_date</span><span class="p">:</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>            <span class="n">when_beg</span> <span class="o">=</span> <span class="n">db_first_date</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>        <span class="k">if</span> <span class="n">when_end</span> <span class="o">&gt;</span> <span class="n">db_last_date</span><span class="p">:</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>            <span class="n">when_end</span> <span class="o">=</span> <span class="n">db_last_date</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>        <span class="k">if</span> <span class="n">when_end</span> <span class="o">&lt;</span> <span class="n">db_first_date</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>            <span class="k">raise</span> <span class="n">CoaNoData</span><span class="p">(</span><span class="s2">&quot;No available data before &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">db_first_date</span><span class="p">))</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>        <span class="c1"># when cut</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>        <span class="k">if</span> <span class="n">when_beg</span> <span class="o">&gt;</span>  <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="ow">or</span> <span class="n">when_end</span> <span class="o">&gt;</span>  <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>            <span class="k">raise</span> <span class="n">CoaNoData</span><span class="p">(</span><span class="s2">&quot;No available data after &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>        <span class="n">pandy</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[(</span><span class="n">pandy</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="n">when_beg</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pandy</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;=</span> <span class="n">when_end</span><span class="p">)]</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>        <span class="k">if</span> <span class="n">bypop</span> <span class="o">!=</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pandy</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39; per &#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>            <span class="c1">#name = [i for i in list(pandy.columns) if &#39; per &#39; in i]</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>            <span class="k">if</span> <span class="n">bypop</span><span class="o">==</span><span class="s1">&#39;pop&#39;</span><span class="p">:</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>                <span class="n">bypop</span><span class="o">=</span><span class="s1">&#39;total population&#39;</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>                <span class="n">bypop</span><span class="o">+=</span><span class="s1">&#39; population&#39;</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>            <span class="k">if</span> <span class="s1">&#39;tot_&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">what</span> <span class="ow">or</span> <span class="n">what</span><span class="o">==</span><span class="s1">&#39;standard&#39;</span><span class="p">:</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>                <span class="n">renamed</span> <span class="o">=</span> <span class="n">which</span> <span class="o">+</span> <span class="s1">&#39; per &#39;</span><span class="o">+</span> <span class="n">bypop</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>                <span class="n">renamed</span> <span class="o">=</span> <span class="n">which</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">+</span> <span class="n">what</span> <span class="o">+</span><span class="s1">&#39; per &#39;</span><span class="o">+</span> <span class="n">bypop</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>            <span class="n">pandy</span> <span class="o">=</span> <span class="n">pandy</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span><span class="n">renamed</span><span class="p">})</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">renamed</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>            <span class="k">pass</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">input_field</span> <span class="ow">or</span> <span class="n">input_field</span> <span class="o">==</span> <span class="s1">&#39;standard&#39;</span><span class="p">:</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandy</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandy</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>    <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a><span class="c1"># --- get(**kwargs) ----------------------------------------------------</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a><span class="nd">@chartsinput_deco</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return covid19 data in specified format output (default, by list)</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a><span class="sd">    for specified locations (&#39;where&#39; keyword).</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a><span class="sd">    The used database is set by the setbase() function but can be</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a><span class="sd">    changed on the fly (&#39;whom&#39; keyword)</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a><span class="sd">    Keyword arguments</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a><span class="sd">    -----------------</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a><span class="sd">    where  --   a single string of location, or list of (mandatory,</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a><span class="sd">                no default value)</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a><span class="sd">    which  --   what sort of data to deliver ( &#39;death&#39;,&#39;confirmed&#39;,</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a><span class="sd">                &#39;recovered&#39; for &#39;jhu&#39; default database). See listwhich() function</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a><span class="sd">                for full list according to the used database.</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a><span class="sd">    what   --   which data are computed, either in standard mode</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a><span class="sd">                (&#39;standard&#39;, default value), or &#39;daily&#39; (diff with previous day</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a><span class="sd">                and &#39;weekly&#39; (diff with previous week). See</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a><span class="sd">                listwhich() for fullist of available</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a><span class="sd">                Full list of what keyword with the listwhat() function.</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a><span class="sd">    whom   --   Database specification (overload the setbase()</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a><span class="sd">                function). See listwhom() for supported list</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a><span class="sd">    when   --   dates are given under the format dd/mm/yyyy. In the when</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a><span class="sd">                option, one can give one date which will be the end of</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a><span class="sd">                the data slice. Or one can give two dates separated with</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a><span class="sd">                &quot;:&quot;, which will define the time cut for the output data</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a><span class="sd">                btw those two dates.</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a><span class="sd">    output --   output format returned ( pandas (default), array (numpy.array),</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a><span class="sd">                dict or list). See listoutput() function.</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a><span class="sd">    option --   pre-computing option.</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a><span class="sd">                * nonneg means that negative daily balance is pushed back</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a><span class="sd">                to previousdays in order to have a cumulative function which is</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a><span class="sd">                monotonous increasing.</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a><span class="sd">                * nofillnan means that nan value won&#39;t be filled.</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a><span class="sd">                * smooth7 will perform a 7 day window average of data</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a><span class="sd">                * sumall will return integrated over locations given via the</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a><span class="sd">                where keyword. If using double bracket notation, the sumall</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a><span class="sd">                option is applied for each bracketed member of the where arg.</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a><span class="sd">                By default : no option.</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a><span class="sd">                See listoption().</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a><span class="sd">    bypop --    normalize by population (if available for the selected database).</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a><span class="sd">                * by default, &#39;no&#39; normalization</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a><span class="sd">                * can normalize by &#39;100&#39;, &#39;1k&#39;, &#39;100k&#39; or &#39;1M&#39;</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>    <span class="c1"># manage pop norm if asked</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>    <span class="c1">#if bypop != &#39;no&#39;:</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>    <span class="c1">#    if what:</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>    <span class="c1">#        val2norm=what</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>    <span class="c1">#    else:</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>    <span class="c1">#        val2norm=which</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>    <span class="c1">#    pandy = normbypop(pandy,val2norm,bypop)</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>    <span class="c1"># casted_data = None</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>    <span class="n">output</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>    <span class="n">pandy</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>    <span class="n">pandy</span> <span class="o">=</span> <span class="n">pandy</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">)</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>    <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;pandas&#39;</span><span class="p">:</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>        <span class="k">def</span> <span class="nf">color_df</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>            <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">columns</span><span class="o">==</span><span class="s1">&#39;date&#39;</span><span class="p">:</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>                <span class="k">return</span> <span class="s1">&#39;blue&#39;</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>            <span class="k">elif</span> <span class="n">val</span><span class="o">.</span><span class="n">columns</span><span class="o">==</span><span class="s1">&#39;where&#39;</span><span class="p">:</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>                <span class="k">return</span> <span class="s1">&#39;red&#39;</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a>                <span class="k">return</span> <span class="n">black</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>        <span class="c1">#if &#39;option&#39; in kwargs:</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a>        <span class="c1">#    raise CoaKeyError(&quot;Cannot use option with input pandas data. &quot;</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a>        <span class="c1">#                      &quot;Use option within the get() function instead.&quot;)</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>        <span class="c1">#pandy = pandy.drop_duplicates([&#39;date&#39;,&#39;clustername&#39;])</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>        <span class="c1">#pandy = pandy.drop(columns=[&#39;cumul&#39;])</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>        <span class="c1">#pandy[&#39;cumul&#39;] = pandy[which]</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>        <span class="n">casted_data</span> <span class="o">=</span> <span class="n">pandy</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>        <span class="n">col</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">casted_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>        <span class="n">mem</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:,}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">casted_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;Memory usage of all columns: &#39;</span> <span class="o">+</span> <span class="n">mem</span> <span class="o">+</span> <span class="s1">&#39; bytes&#39;</span><span class="p">)</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>    <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;geopandas&#39;</span><span class="p">:</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>        <span class="n">casted_data</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoageo</span><span class="p">(</span><span class="n">pandy</span><span class="p">)</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>    <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;dict&#39;</span><span class="p">:</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>        <span class="n">casted_data</span> <span class="o">=</span> <span class="n">pandy</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;split&#39;</span><span class="p">)</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>    <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span> <span class="ow">or</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;array&#39;</span><span class="p">:</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>        <span class="n">my_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>        <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">pandy</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>            <span class="n">vc</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>            <span class="n">my_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vc</span><span class="p">)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>        <span class="n">casted_data</span> <span class="o">=</span> <span class="n">my_list</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>        <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;array&#39;</span><span class="p">:</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>            <span class="n">casted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pandy</span><span class="p">)</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Unknown output.&#39;</span><span class="p">)</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a>    <span class="k">return</span> <span class="n">casted_data</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a><span class="k">def</span> <span class="nf">saveoutput</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a><span class="sd">        Export pycoas pandas as an output file selected by output argument</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a><span class="sd">        &#39;pandas&#39;: pandas to save</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a><span class="sd">        &#39;saveformat&#39;: excel (default) or csv</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a><span class="sd">        &#39;savename&#39;: None (default pycoaout+ &#39;.xlsx/.csv&#39;)</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>    <span class="k">global</span> <span class="n">_db</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>    <span class="n">kwargs_test</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;pandas&#39;</span><span class="p">,</span><span class="s1">&#39;saveformat&#39;</span><span class="p">,</span><span class="s1">&#39;savename&#39;</span><span class="p">],</span> <span class="s1">&#39;Bad args used in the pycoa.saveoutput function.&#39;</span><span class="p">)</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>    <span class="n">pandy</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pandas&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">())</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>    <span class="n">saveformat</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;saveformat&#39;</span><span class="p">,</span> <span class="s1">&#39;excel&#39;</span><span class="p">)</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>    <span class="n">savename</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savename&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>    <span class="k">if</span> <span class="n">pandy</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Pandas to save is mandatory there is not default !&#39;</span><span class="p">)</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a>        <span class="n">_db</span><span class="o">.</span><span class="n">saveoutput</span><span class="p">(</span><span class="n">pandas</span><span class="o">=</span><span class="n">pandy</span><span class="p">,</span><span class="n">saveformat</span><span class="o">=</span><span class="n">saveformat</span><span class="p">,</span><span class="n">savename</span><span class="o">=</span><span class="n">savename</span><span class="p">)</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a><span class="k">def</span> <span class="nf">merger</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a><span class="sd">    Merge two or more pycoa pandas from get_stats operation</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a><span class="sd">    &#39;coapandas&#39;: list (min 2D) of pandas from stats</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a><span class="sd">    &#39;whichcol&#39;: list variable associate to the coapandas list to be retrieve</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a>    <span class="k">global</span> <span class="n">_db</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>    <span class="n">kwargs_test</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;coapandas&#39;</span><span class="p">],</span> <span class="s1">&#39;Bad args used in the pycoa.merger function.&#39;</span><span class="p">)</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a>    <span class="n">listpandy</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coapandas&#39;</span><span class="p">,[])</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>    <span class="k">return</span> <span class="n">_db</span><span class="o">.</span><span class="n">merger</span><span class="p">(</span><span class="n">coapandas</span> <span class="o">=</span> <span class="n">listpandy</span><span class="p">)</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a><span class="c1"># --- map(**kwargs) ----------------------------------------------------</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a><span class="k">def</span> <span class="nf">decomap</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a><span class="sd">        Create a map according to arguments and options.</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a><span class="sd">        See help(map).</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a><span class="sd">        - 2 types of visu are avalailable so far : bokeh or folium (see listvisu())</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a><span class="sd">        by default visu=&#39;bokeh&#39;</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a><span class="sd">        - In the default case (i.e visu=&#39;bokeh&#39;) available option are :</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a><span class="sd">            - dateslider=True: a date slider is called and displayed on the right part of the map</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a><span class="sd">            - maplabel = text, values are displayed directly on the map</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a><span class="sd">                       = textinter, values as an integer are displayed directly on the map</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a><span class="sd">                       = spark, sparkline are displayed directly on the map</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a><span class="sd">                       = spiral, spiral are displayed directly on the map</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a><span class="sd">                       = label%, label are in %</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a><span class="sd">                       = exploded/dense, when available exploded/dense map geometry (for USA &amp; FRA sor far)</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>        <span class="n">visu</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;visu&#39;</span><span class="p">,</span> <span class="n">listvisu</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>        <span class="nb">input</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">input</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">):</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>          <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">)</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a>        <span class="n">dateslider</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dateslider&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>        <span class="n">maplabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;maplabel&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>        <span class="n">listmaplabel</span><span class="o">=</span><span class="n">_listmaplabel</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>        <span class="k">if</span> <span class="n">maplabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">maplabel</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>                <span class="n">maplabel</span> <span class="o">=</span> <span class="p">[</span><span class="n">maplabel</span><span class="p">]</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a>            <span class="k">if</span>  <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">maplabel</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listmaplabel</span><span class="p">]:</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>                <span class="k">raise</span> <span class="n">CoaTypeError</span><span class="p">(</span><span class="s1">&#39;Waiting a correct maplabel value. See help.&#39;</span><span class="p">)</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>        <span class="n">sparkline</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a>        <span class="k">if</span> <span class="n">dateslider</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a>            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dateslider&#39;</span><span class="p">]</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cursor_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateslider</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a>        <span class="k">if</span> <span class="n">maplabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a>            <span class="k">if</span> <span class="s1">&#39;text&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a>            <span class="k">if</span> <span class="s1">&#39;textinteger&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;textinteger&#39;</span><span class="p">]</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">listmaplabel</span><span class="p">:</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">maplabel</span> <span class="ow">and</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;textinteger&#39;</span><span class="p">]:</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos">740</span></a>                    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos">741</span></a>            <span class="c1">#if all([ True if i in [&#39;text&#39;,&#39;spark&#39;,&#39;label%&#39;,&#39;log&#39;] else False for i in kwargs[&#39;maplabel&#39;] ]) :</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos">742</span></a>            <span class="c1">#    CoaKeyError(&#39;Waiting for a valide label visualisation: text, spark or label%&#39;)</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos">743</span></a>            <span class="nb">input</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">input_field</span><span class="p">]</span><span class="o">=</span><span class="nb">input</span><span class="p">[</span><span class="n">input_field</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#needed in the case where there are nan else js pb</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos">744</span></a>        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos">745</span></a>    <span class="k">return</span> <span class="n">inner</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos">746</span></a>
</span><span id="L-747"><a href="#L-747"><span class="linenos">747</span></a><span class="nd">@chartsinput_deco</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos">748</span></a><span class="nd">@decomap</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos">749</span></a><span class="k">def</span> <span class="nf">figuremap</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos">750</span></a>    <span class="n">visu</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;visu&#39;</span><span class="p">,</span> <span class="n">listvisu</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos">751</span></a>    <span class="n">dateslider</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dateslider&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos">752</span></a>    <span class="n">maplabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;maplabel&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos">753</span></a>    <span class="k">if</span> <span class="n">visu</span> <span class="o">==</span> <span class="s1">&#39;bokeh&#39;</span><span class="p">:</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos">754</span></a>        <span class="k">if</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos">755</span></a>            <span class="k">if</span> <span class="s1">&#39;spark&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span> <span class="ow">or</span> <span class="s1">&#39;spiral&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos">756</span></a>                <span class="k">return</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_pimpmap</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos">757</span></a>            <span class="k">elif</span> <span class="s1">&#39;text&#39;</span> <span class="ow">or</span> <span class="s1">&#39;exploded&#39;</span> <span class="ow">or</span> <span class="s1">&#39;dense&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos">758</span></a>                <span class="k">return</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_map</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos">759</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos">760</span></a>                <span class="n">CoaError</span><span class="p">(</span><span class="s2">&quot;What kind of pimp map you want ?!&quot;</span><span class="p">)</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos">761</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos">762</span></a>            <span class="k">return</span>  <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_map</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos">763</span></a>
</span><span id="L-764"><a href="#L-764"><span class="linenos">764</span></a><span class="nd">@chartsinput_deco</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos">765</span></a><span class="nd">@decomap</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos">766</span></a><span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos">767</span></a>    <span class="n">visu</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;visu&#39;</span><span class="p">,</span> <span class="n">listvisu</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos">768</span></a>    <span class="n">dateslider</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dateslider&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos">769</span></a>    <span class="n">maplabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;maplabel&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos">770</span></a>    <span class="k">if</span> <span class="n">visu</span> <span class="o">==</span> <span class="s1">&#39;bokeh&#39;</span><span class="p">:</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos">771</span></a>        <span class="k">if</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos">772</span></a>            <span class="k">if</span> <span class="s1">&#39;spark&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span> <span class="ow">or</span> <span class="s1">&#39;spiral&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos">773</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_pimpmap</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos">774</span></a>            <span class="k">elif</span> <span class="s1">&#39;text&#39;</span> <span class="ow">or</span> <span class="s1">&#39;exploded&#39;</span> <span class="ow">or</span> <span class="s1">&#39;dense&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos">775</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_map</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos">776</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos">777</span></a>                <span class="n">CoaError</span><span class="p">(</span><span class="s2">&quot;What kind of pimp map you want ?!&quot;</span><span class="p">)</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos">778</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos">779</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_map</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos">780</span></a>        <span class="k">return</span> <span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos">781</span></a>    <span class="k">elif</span> <span class="n">visu</span> <span class="o">==</span> <span class="s1">&#39;folium&#39;</span><span class="p">:</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos">782</span></a>        <span class="k">if</span> <span class="n">dateslider</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos">783</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Not available with folium map, you should considere to use bokeh map visu in this case&#39;</span><span class="p">)</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos">784</span></a>        <span class="k">if</span>  <span class="n">maplabel</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="n">maplabel</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;log&#39;</span><span class="p">]):</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos">785</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Not available with folium map, you should considere to use bokeh map visu in this case&#39;</span><span class="p">)</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos">786</span></a>        <span class="k">return</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_mapfolium</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos">787</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos">788</span></a>        <span class="k">raise</span> <span class="n">CoaTypeError</span><span class="p">(</span><span class="s1">&#39;Waiting for a valid visualisation. So far: </span><span class="se">\&#39;</span><span class="s1">bokeh</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">folium</span><span class="se">\&#39;</span><span class="s1">.See help.&#39;</span><span class="p">)</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos">789</span></a>
</span><span id="L-790"><a href="#L-790"><span class="linenos">790</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos">791</span></a><span class="c1"># --- hist(**kwargs) ---------------------------------------------------</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos">792</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos">793</span></a><span class="k">def</span> <span class="nf">decohist</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos">794</span></a>    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos">795</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos">796</span></a><span class="sd">        Create histogram according to arguments.</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos">797</span></a><span class="sd">        See help(hist).</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos">798</span></a><span class="sd">        Keyword arguments</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos">799</span></a><span class="sd">        -----------------</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos">800</span></a>
</span><span id="L-801"><a href="#L-801"><span class="linenos">801</span></a><span class="sd">        where (mandatory if no input), what, which, whom, when : (see help(get))</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos">802</span></a>
</span><span id="L-803"><a href="#L-803"><span class="linenos">803</span></a><span class="sd">        input       --  input data to plot within the pycoa framework (e.g.</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos">804</span></a><span class="sd">                        after some analysis or filtering). Default is None which</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos">805</span></a><span class="sd">                        means that we use the basic raw data through the get</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos">806</span></a><span class="sd">                        function.</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos">807</span></a><span class="sd">                        When the &#39;input&#39; keyword is set, where, what, which,</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos">808</span></a><span class="sd">                        whom when keywords are ignored.</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos">809</span></a><span class="sd">                        input should be given as valid pycoa pandas dataframe.</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos">810</span></a>
</span><span id="L-811"><a href="#L-811"><span class="linenos">811</span></a><span class="sd">        input_field --  is the name of the field of the input pandas to plot.</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos">812</span></a><span class="sd">                        Default is &#39;deaths/standard&#39;, the default output field of</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos">813</span></a><span class="sd">                        the get() function.</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos">814</span></a>
</span><span id="L-815"><a href="#L-815"><span class="linenos">815</span></a><span class="sd">        width_height : width and height of the picture .</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos">816</span></a><span class="sd">                    If specified should be a list of width and height.</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos">817</span></a><span class="sd">                    For instance width_height=[400,500]</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos">818</span></a>
</span><span id="L-819"><a href="#L-819"><span class="linenos">819</span></a><span class="sd">        typeofhist  --  &#39;bylocation&#39; (default), &#39;byvalue&#39; or pie</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos">820</span></a>
</span><span id="L-821"><a href="#L-821"><span class="linenos">821</span></a><span class="sd">        bins        --  number of bins used, only available for &#39;byvalue&#39; type of</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos">822</span></a><span class="sd">                        histograms.</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos">823</span></a><span class="sd">                        If none provided, a default value will be used.</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos">824</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos">825</span></a>        <span class="nb">input</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos">826</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos">827</span></a>        <span class="n">dateslider</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dateslider&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos">828</span></a>        <span class="n">typeofhist</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;typeofhist&#39;</span><span class="p">,</span><span class="n">listhist</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos">829</span></a>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos">830</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">):</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos">831</span></a>          <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">)</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos">832</span></a>
</span><span id="L-833"><a href="#L-833"><span class="linenos">833</span></a>        <span class="k">if</span> <span class="n">dateslider</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos">834</span></a>            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dateslider&#39;</span><span class="p">]</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos">835</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cursor_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateslider</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos">836</span></a>
</span><span id="L-837"><a href="#L-837"><span class="linenos">837</span></a>        <span class="k">if</span> <span class="n">typeofhist</span> <span class="o">==</span> <span class="s1">&#39;bylocation&#39;</span><span class="p">:</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos">838</span></a>            <span class="k">if</span> <span class="s1">&#39;bins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos">839</span></a>                <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s2">&quot;The bins keyword cannot be set with histograms by location. See help.&quot;</span><span class="p">)</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos">840</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_horizonhisto</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos">841</span></a>        <span class="k">elif</span> <span class="n">typeofhist</span> <span class="o">==</span> <span class="s1">&#39;byvalue&#39;</span><span class="p">:</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos">842</span></a>            <span class="k">if</span> <span class="n">dateslider</span><span class="p">:</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos">843</span></a>                <span class="n">info</span><span class="p">(</span><span class="s1">&#39;dateslider not implemented for typeofhist=</span><span class="se">\&#39;</span><span class="s1">byvalue</span><span class="se">\&#39;</span><span class="s1">.&#39;</span><span class="p">)</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos">844</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_horizonhisto</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos">845</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos">846</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_histo</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos">847</span></a>        <span class="k">elif</span> <span class="n">typeofhist</span> <span class="o">==</span> <span class="s1">&#39;pie&#39;</span><span class="p">:</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos">848</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_pie</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos">849</span></a>
</span><span id="L-850"><a href="#L-850"><span class="linenos">850</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos">851</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Unknown typeofhist value. Available value : listhist().&#39;</span><span class="p">)</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos">852</span></a>        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos">853</span></a>    <span class="k">return</span> <span class="n">inner</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos">854</span></a>
</span><span id="L-855"><a href="#L-855"><span class="linenos">855</span></a><span class="nd">@chartsinput_deco</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos">856</span></a><span class="nd">@decohist</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos">857</span></a><span class="k">def</span> <span class="nf">figurehist</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos">858</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39; Return fig Bohek object &#39;&#39;&#39;</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos">859</span></a>    <span class="k">return</span> <span class="n">fig</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos">860</span></a>
</span><span id="L-861"><a href="#L-861"><span class="linenos">861</span></a><span class="nd">@chartsinput_deco</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos">862</span></a><span class="nd">@decohist</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos">863</span></a><span class="k">def</span> <span class="nf">hist</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos">864</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39; show hist &#39;&#39;&#39;</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos">865</span></a>    <span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos">866</span></a>
</span><span id="L-867"><a href="#L-867"><span class="linenos">867</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos">868</span></a><span class="c1"># --- plot(**kwargs) ---------------------------------------------------</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos">869</span></a><span class="c1"># ----------------------------------------------------------------------</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos">870</span></a><span class="k">def</span> <span class="nf">decoplot</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos">871</span></a>    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos">872</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos">873</span></a><span class="sd">        Create a date plot according to arguments. See help(plot).</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos">874</span></a><span class="sd">        Keyword arguments</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos">875</span></a><span class="sd">        -----------------</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos">876</span></a>
</span><span id="L-877"><a href="#L-877"><span class="linenos">877</span></a><span class="sd">        where (mandatory), what, which, whom, when : (see help(get))</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos">878</span></a>
</span><span id="L-879"><a href="#L-879"><span class="linenos">879</span></a><span class="sd">        input       --  input data to plot within the pycoa framework (e.g.</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos">880</span></a><span class="sd">                        after some analysis or filtering). Default is None which</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos">881</span></a><span class="sd">                        means that we use the basic raw data through the get</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos">882</span></a><span class="sd">                        function.</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos">883</span></a><span class="sd">                        When the &#39;input&#39; keyword is set, where, what, which,</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos">884</span></a><span class="sd">                        whom when keywords are ignored.</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos">885</span></a><span class="sd">                        input should be given as valid pycoa pandas dataframe.</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos">886</span></a>
</span><span id="L-887"><a href="#L-887"><span class="linenos">887</span></a><span class="sd">        input_field --  is the name of the field of the input pandas to plot.</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos">888</span></a><span class="sd">                        Default is &#39;deaths/standard&#39;, the default output field of</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos">889</span></a><span class="sd">                        the get() function.</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos">890</span></a>
</span><span id="L-891"><a href="#L-891"><span class="linenos">891</span></a><span class="sd">        width_height : width and height of the picture .</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos">892</span></a><span class="sd">                    If specified should be a list of width and height. For instance width_height=[400,500]</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos">893</span></a>
</span><span id="L-894"><a href="#L-894"><span class="linenos">894</span></a><span class="sd">        title       --  to force the title of the plot</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos">895</span></a>
</span><span id="L-896"><a href="#L-896"><span class="linenos">896</span></a><span class="sd">        textcopyright - to force the copyright lower left of the graph</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos">897</span></a>
</span><span id="L-898"><a href="#L-898"><span class="linenos">898</span></a><span class="sd">        typeofplot  -- &#39;date&#39; (default), &#39;menulocation&#39; or &#39;versus&#39;</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos">899</span></a><span class="sd">                       &#39;date&#39;:date plot</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos">900</span></a><span class="sd">                       &#39;spiral&#39;: spiral plot if several location only the first one</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos">901</span></a><span class="sd">                       &#39;menulocation&#39;: date plot with two scroll menu locations.</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos">902</span></a><span class="sd">                                        Usefull to study the behaviour of a variable for two different countries.</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos">903</span></a><span class="sd">                       &#39;versus&#39;: plot variable against an other one.</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos">904</span></a><span class="sd">                                 For this type of plot one should used &#39;input&#39; and &#39;input_field&#39; (not fully tested).</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos">905</span></a><span class="sd">                                 Moreover dim(input_field) must be 2.</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos">906</span></a><span class="sd">                        &#39;spiral&#39; : plot variable as a spiral angular plot, angle being the date</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos">907</span></a><span class="sd">                        &#39;yearly&#39; : same as date but modulo 1 year</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos">908</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos">909</span></a>        <span class="nb">input</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos">910</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos">911</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">input</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos">912</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos">913</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos">914</span></a>        <span class="n">typeofplot</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;typeofplot&#39;</span><span class="p">,</span><span class="n">listplot</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos">915</span></a>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos">916</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">):</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos">917</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">)</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos">918</span></a>
</span><span id="L-919"><a href="#L-919"><span class="linenos">919</span></a>        <span class="k">if</span> <span class="s1">&#39;typeofplot&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos">920</span></a>            <span class="n">typeofplot</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;typeofplot&#39;</span><span class="p">)</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos">921</span></a>        <span class="k">if</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos">922</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos">923</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;spiral&#39;</span><span class="p">:</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos">924</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_spiral_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos">925</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;versus&#39;</span><span class="p">:</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos">926</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_field</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_field</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos">927</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos">928</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos">929</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;typeofplot is versus but dim(input_field)!=2, versus has not effect ...&#39;</span><span class="p">)</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos">930</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos">931</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;menulocation&#39;</span><span class="p">:</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos">932</span></a>            <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nation&#39;</span> <span class="ow">and</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;World&#39;</span><span class="p">:</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos">933</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;typeofplot is menulocation with a national DB granularity, use date plot instead ...&#39;</span><span class="p">)</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos">934</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos">935</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos">936</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_field</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_field</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos">937</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;typeofplot is menulocation but dim(input_field)&gt;1, menulocation has not effect ...&#39;</span><span class="p">)</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos">938</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_scrollingmenu</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos">939</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;yearly&#39;</span><span class="p">:</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos">940</span></a>            <span class="k">if</span> <span class="nb">input</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="nb">input</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">):</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos">941</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yearly will not be used since the time covered is less than 1 year&quot;</span><span class="p">)</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos">942</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos">943</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos">944</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_yearly_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos">945</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos">946</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Unknown typeofplot value. Should be date, versus, menulocation or spiral.&#39;</span><span class="p">)</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos">947</span></a>        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos">948</span></a>    <span class="k">return</span> <span class="n">inner</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos">949</span></a>
</span><span id="L-950"><a href="#L-950"><span class="linenos">950</span></a><span class="nd">@chartsinput_deco</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos">951</span></a><span class="nd">@decoplot</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos">952</span></a><span class="k">def</span> <span class="nf">figureplot</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos">953</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39; Return fig Bohek object &#39;&#39;&#39;</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos">954</span></a>    <span class="k">return</span> <span class="n">fig</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos">955</span></a>
</span><span id="L-956"><a href="#L-956"><span class="linenos">956</span></a><span class="nd">@chartsinput_deco</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos">957</span></a><span class="nd">@decoplot</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos">958</span></a><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos">959</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39; show plot &#39;&#39;&#39;</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos">960</span></a>    <span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="getversion">
                            <input id="getversion-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getversion</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="getversion-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#getversion"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="getversion-95"><a href="#getversion-95"><span class="linenos">95</span></a><span class="k">def</span> <span class="nf">getversion</span><span class="p">():</span>
</span><span id="getversion-96"><a href="#getversion-96"><span class="linenos">96</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the current running version of pycoa.</span>
</span><span id="getversion-97"><a href="#getversion-97"><span class="linenos">97</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="getversion-98"><a href="#getversion-98"><span class="linenos">98</span></a>    <span class="k">return</span> <span class="n">coa</span><span class="o">.</span><span class="n">_version</span><span class="o">.</span><span class="n">__version__</span>
</span></pre></div>


            <div class="docstring"><p>Return the current running version of pycoa.</p>
</div>


                </section>
                <section id="listoutput">
                            <input id="listoutput-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listoutput</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="listoutput-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#listoutput"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="listoutput-102"><a href="#listoutput-102"><span class="linenos">102</span></a><span class="k">def</span> <span class="nf">listoutput</span><span class="p">():</span>
</span><span id="listoutput-103"><a href="#listoutput-103"><span class="linenos">103</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently available output types for the</span>
</span><span id="listoutput-104"><a href="#listoutput-104"><span class="linenos">104</span></a><span class="sd">    get() function. The first one is the default output given if</span>
</span><span id="listoutput-105"><a href="#listoutput-105"><span class="linenos">105</span></a><span class="sd">    not specified.</span>
</span><span id="listoutput-106"><a href="#listoutput-106"><span class="linenos">106</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="listoutput-107"><a href="#listoutput-107"><span class="linenos">107</span></a>    <span class="k">return</span> <span class="n">_listoutput</span>
</span></pre></div>


            <div class="docstring"><p>Return the list of currently available output types for the
get() function. The first one is the default output given if
not specified.</p>
</div>


                </section>
                <section id="listvisu">
                            <input id="listvisu-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listvisu</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="listvisu-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#listvisu"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="listvisu-111"><a href="#listvisu-111"><span class="linenos">111</span></a><span class="k">def</span> <span class="nf">listvisu</span><span class="p">():</span>
</span><span id="listvisu-112"><a href="#listvisu-112"><span class="linenos">112</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently available visualization for the</span>
</span><span id="listvisu-113"><a href="#listvisu-113"><span class="linenos">113</span></a><span class="sd">    map() function. The first one is the default output given if</span>
</span><span id="listvisu-114"><a href="#listvisu-114"><span class="linenos">114</span></a><span class="sd">    not specified.</span>
</span><span id="listvisu-115"><a href="#listvisu-115"><span class="linenos">115</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="listvisu-116"><a href="#listvisu-116"><span class="linenos">116</span></a>    <span class="k">return</span> <span class="n">_listvisu</span>
</span></pre></div>


            <div class="docstring"><p>Return the list of currently available visualization for the
map() function. The first one is the default output given if
not specified.</p>
</div>


                </section>
                <section id="listwhom">
                            <input id="listwhom-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listwhom</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">detailed</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="listwhom-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#listwhom"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="listwhom-120"><a href="#listwhom-120"><span class="linenos">120</span></a><span class="k">def</span> <span class="nf">listwhom</span><span class="p">(</span><span class="n">detailed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="listwhom-121"><a href="#listwhom-121"><span class="linenos">121</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently avalailable databases for covid19</span>
</span><span id="listwhom-122"><a href="#listwhom-122"><span class="linenos">122</span></a><span class="sd">     data in PyCoA.</span>
</span><span id="listwhom-123"><a href="#listwhom-123"><span class="linenos">123</span></a><span class="sd">     The first one is the default one.</span>
</span><span id="listwhom-124"><a href="#listwhom-124"><span class="linenos">124</span></a>
</span><span id="listwhom-125"><a href="#listwhom-125"><span class="linenos">125</span></a><span class="sd">     If detailed=True, gives information location of each given database.</span>
</span><span id="listwhom-126"><a href="#listwhom-126"><span class="linenos">126</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="listwhom-127"><a href="#listwhom-127"><span class="linenos">127</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">_db_list_dict</span><span class="p">)</span>
</span><span id="listwhom-128"><a href="#listwhom-128"><span class="linenos">128</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="listwhom-129"><a href="#listwhom-129"><span class="linenos">129</span></a>    <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span>
</span><span id="listwhom-130"><a href="#listwhom-130"><span class="linenos">130</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Database&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;WW/iso3&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;Granularité&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="s1">&#39;WW/Name&#39;</span><span class="p">})</span>
</span><span id="listwhom-131"><a href="#listwhom-131"><span class="linenos">131</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Database&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="listwhom-132"><a href="#listwhom-132"><span class="linenos">132</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="listwhom-133"><a href="#listwhom-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">detailed</span><span class="p">):</span>
</span><span id="listwhom-134"><a href="#listwhom-134"><span class="linenos">134</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">([{</span><span class="s1">&#39;selector&#39;</span> <span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;props&#39;</span> <span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;border&#39;</span><span class="p">,</span><span class="s1">&#39;3px solid green&#39;</span><span class="p">)]}]))</span>
</span><span id="listwhom-135"><a href="#listwhom-135"><span class="linenos">135</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pandas has been pimped, use &#39;.data&#39; to get a pandas dataframe&quot;</span><span class="p">)</span>
</span><span id="listwhom-136"><a href="#listwhom-136"><span class="linenos">136</span></a>            <span class="k">return</span> <span class="n">df</span>
</span><span id="listwhom-137"><a href="#listwhom-137"><span class="linenos">137</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="listwhom-138"><a href="#listwhom-138"><span class="linenos">138</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Database&#39;</span><span class="p">])</span>
</span><span id="listwhom-139"><a href="#listwhom-139"><span class="linenos">139</span></a>    <span class="k">except</span><span class="p">:</span>
</span><span id="listwhom-140"><a href="#listwhom-140"><span class="linenos">140</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Waiting for a boolean !&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the list of currently avalailable databases for covid19
data in PyCoA.
The first one is the default one.</p>

<p>If detailed=True, gives information location of each given database.</p>
</div>


                </section>
                <section id="listwhat">
                            <input id="listwhat-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listwhat</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="listwhat-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#listwhat"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="listwhat-143"><a href="#listwhat-143"><span class="linenos">143</span></a><span class="k">def</span> <span class="nf">listwhat</span><span class="p">():</span>
</span><span id="listwhat-144"><a href="#listwhat-144"><span class="linenos">144</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently avalailable type of series available.</span>
</span><span id="listwhat-145"><a href="#listwhat-145"><span class="linenos">145</span></a><span class="sd">     The first one is the default one.</span>
</span><span id="listwhat-146"><a href="#listwhat-146"><span class="linenos">146</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="listwhat-147"><a href="#listwhat-147"><span class="linenos">147</span></a>    <span class="k">return</span> <span class="n">_listwhat</span>
</span></pre></div>


            <div class="docstring"><p>Return the list of currently avalailable type of series available.
The first one is the default one.</p>
</div>


                </section>
                <section id="listhist">
                            <input id="listhist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listhist</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="listhist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#listhist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="listhist-151"><a href="#listhist-151"><span class="linenos">151</span></a><span class="k">def</span> <span class="nf">listhist</span><span class="p">():</span>
</span><span id="listhist-152"><a href="#listhist-152"><span class="linenos">152</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently avalailable type of hist available.</span>
</span><span id="listhist-153"><a href="#listhist-153"><span class="linenos">153</span></a><span class="sd">     The first one is the default one.</span>
</span><span id="listhist-154"><a href="#listhist-154"><span class="linenos">154</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="listhist-155"><a href="#listhist-155"><span class="linenos">155</span></a>    <span class="k">return</span> <span class="n">_listhist</span>
</span></pre></div>


            <div class="docstring"><p>Return the list of currently avalailable type of hist available.
The first one is the default one.</p>
</div>


                </section>
                <section id="listplot">
                            <input id="listplot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listplot</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="listplot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#listplot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="listplot-159"><a href="#listplot-159"><span class="linenos">159</span></a><span class="k">def</span> <span class="nf">listplot</span><span class="p">():</span>
</span><span id="listplot-160"><a href="#listplot-160"><span class="linenos">160</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently avalailable type of plots available.</span>
</span><span id="listplot-161"><a href="#listplot-161"><span class="linenos">161</span></a><span class="sd">     The first one is the default one.</span>
</span><span id="listplot-162"><a href="#listplot-162"><span class="linenos">162</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="listplot-163"><a href="#listplot-163"><span class="linenos">163</span></a>    <span class="k">return</span> <span class="n">_listplot</span>
</span></pre></div>


            <div class="docstring"><p>Return the list of currently avalailable type of plots available.
The first one is the default one.</p>
</div>


                </section>
                <section id="listoption">
                            <input id="listoption-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listoption</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="listoption-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#listoption"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="listoption-168"><a href="#listoption-168"><span class="linenos">168</span></a><span class="k">def</span> <span class="nf">listoption</span><span class="p">():</span>
</span><span id="listoption-169"><a href="#listoption-169"><span class="linenos">169</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently avalailable option apply to data.</span>
</span><span id="listoption-170"><a href="#listoption-170"><span class="linenos">170</span></a><span class="sd">     Default is no option.</span>
</span><span id="listoption-171"><a href="#listoption-171"><span class="linenos">171</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="listoption-172"><a href="#listoption-172"><span class="linenos">172</span></a>    <span class="k">return</span> <span class="n">_listoption</span>
</span></pre></div>


            <div class="docstring"><p>Return the list of currently avalailable option apply to data.
Default is no option.</p>
</div>


                </section>
                <section id="listtile">
                            <input id="listtile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listtile</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="listtile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#listtile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="listtile-176"><a href="#listtile-176"><span class="linenos">176</span></a><span class="k">def</span> <span class="nf">listtile</span><span class="p">():</span>
</span><span id="listtile-177"><a href="#listtile-177"><span class="linenos">177</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of currently avalailable tile option for map()</span>
</span><span id="listtile-178"><a href="#listtile-178"><span class="linenos">178</span></a><span class="sd">     Default is the first one.</span>
</span><span id="listtile-179"><a href="#listtile-179"><span class="linenos">179</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="listtile-180"><a href="#listtile-180"><span class="linenos">180</span></a>    <span class="k">return</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">tiles_list</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Return the list of currently avalailable tile option for map()
Default is the first one.</p>
</div>


                </section>
                <section id="listwhich">
                            <input id="listwhich-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listwhich</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="listwhich-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#listwhich"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="listwhich-184"><a href="#listwhich-184"><span class="linenos">184</span></a><span class="k">def</span> <span class="nf">listwhich</span><span class="p">():</span>
</span><span id="listwhich-185"><a href="#listwhich-185"><span class="linenos">185</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get which are the available fields for the current base.</span>
</span><span id="listwhich-186"><a href="#listwhich-186"><span class="linenos">186</span></a><span class="sd">    Output is a list of string.</span>
</span><span id="listwhich-187"><a href="#listwhich-187"><span class="linenos">187</span></a><span class="sd">    By default, the listwhich()[0] is the default which field in other</span>
</span><span id="listwhich-188"><a href="#listwhich-188"><span class="linenos">188</span></a><span class="sd">    functions.</span>
</span><span id="listwhich-189"><a href="#listwhich-189"><span class="linenos">189</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="listwhich-190"><a href="#listwhich-190"><span class="linenos">190</span></a>    <span class="k">if</span>  <span class="s1">&#39;_db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
</span><span id="listwhich-191"><a href="#listwhich-191"><span class="linenos">191</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;setwhom MUST be defined first !&#39;</span><span class="p">)</span>
</span><span id="listwhich-192"><a href="#listwhich-192"><span class="linenos">192</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="listwhich-193"><a href="#listwhich-193"><span class="linenos">193</span></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">_db</span><span class="o">.</span><span class="n">get_parserdb</span><span class="p">()</span><span class="o">.</span><span class="n">get_available_keywords</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Get which are the available fields for the current base.
Output is a list of string.
By default, the listwhich()[0] is the default which field in other
functions.</p>
</div>


                </section>
                <section id="listwhere">
                            <input id="listwhere-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listwhere</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">clustered</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="listwhere-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#listwhere"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="listwhere-197"><a href="#listwhere-197"><span class="linenos">197</span></a><span class="k">def</span> <span class="nf">listwhere</span><span class="p">(</span><span class="n">clustered</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="listwhere-198"><a href="#listwhere-198"><span class="linenos">198</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list of available regions/subregions managed by the current database</span>
</span><span id="listwhere-199"><a href="#listwhere-199"><span class="linenos">199</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="listwhere-200"><a href="#listwhere-200"><span class="linenos">200</span></a>    <span class="k">if</span>  <span class="s1">&#39;_db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
</span><span id="listwhere-201"><a href="#listwhere-201"><span class="linenos">201</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;setwhom MUST be defined first !&#39;</span><span class="p">)</span>
</span><span id="listwhere-202"><a href="#listwhere-202"><span class="linenos">202</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="listwhere-203"><a href="#listwhere-203"><span class="linenos">203</span></a>        <span class="k">def</span> <span class="nf">clust</span><span class="p">():</span>
</span><span id="listwhere-204"><a href="#listwhere-204"><span class="linenos">204</span></a>            <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nation&#39;</span> <span class="ow">and</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;World&#39;</span><span class="p">,</span><span class="s1">&#39;Europe&#39;</span><span class="p">]:</span>
</span><span id="listwhere-205"><a href="#listwhere-205"><span class="linenos">205</span></a>                <span class="k">return</span>  <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">to_standard</span><span class="p">(</span><span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="listwhere-206"><a href="#listwhere-206"><span class="linenos">206</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="listwhere-207"><a href="#listwhere-207"><span class="linenos">207</span></a>                <span class="n">r</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">get_region_list</span><span class="p">()</span>
</span><span id="listwhere-208"><a href="#listwhere-208"><span class="linenos">208</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="listwhere-209"><a href="#listwhere-209"><span class="linenos">209</span></a>                    <span class="n">r</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;name_region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</span><span id="listwhere-210"><a href="#listwhere-210"><span class="linenos">210</span></a>                <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
</span><span id="listwhere-211"><a href="#listwhere-211"><span class="linenos">211</span></a>                <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Europe&#39;</span><span class="p">:</span>
</span><span id="listwhere-212"><a href="#listwhere-212"><span class="linenos">212</span></a>                    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;European Union&#39;</span><span class="p">)</span>
</span><span id="listwhere-213"><a href="#listwhere-213"><span class="linenos">213</span></a>                <span class="k">return</span> <span class="n">r</span>
</span><span id="listwhere-214"><a href="#listwhere-214"><span class="linenos">214</span></a>        <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nation&#39;</span> <span class="ow">and</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;World&#39;</span><span class="p">,</span><span class="s1">&#39;Europe&#39;</span><span class="p">]:</span>
</span><span id="listwhere-215"><a href="#listwhere-215"><span class="linenos">215</span></a>            <span class="k">return</span> <span class="p">[</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="p">]</span>
</span><span id="listwhere-216"><a href="#listwhere-216"><span class="linenos">216</span></a>        <span class="k">if</span> <span class="n">clustered</span><span class="p">:</span>
</span><span id="listwhere-217"><a href="#listwhere-217"><span class="linenos">217</span></a>            <span class="k">return</span> <span class="n">clust</span><span class="p">()</span>
</span><span id="listwhere-218"><a href="#listwhere-218"><span class="linenos">218</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="listwhere-219"><a href="#listwhere-219"><span class="linenos">219</span></a>            <span class="k">if</span> <span class="n">_db</span><span class="o">.</span><span class="n">db_world</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="listwhere-220"><a href="#listwhere-220"><span class="linenos">220</span></a>                <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nation&#39;</span> <span class="ow">and</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;World&#39;</span><span class="p">,</span><span class="s1">&#39;Europe&#39;</span><span class="p">]:</span>
</span><span id="listwhere-221"><a href="#listwhere-221"><span class="linenos">221</span></a>                    <span class="n">r</span> <span class="o">=</span>  <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">to_standard</span><span class="p">(</span><span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="listwhere-222"><a href="#listwhere-222"><span class="linenos">222</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="listwhere-223"><a href="#listwhere-223"><span class="linenos">223</span></a>                    <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;World&#39;</span><span class="p">:</span>
</span><span id="listwhere-224"><a href="#listwhere-224"><span class="linenos">224</span></a>                        <span class="n">r</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">get_GeoRegion</span><span class="p">()</span><span class="o">.</span><span class="n">get_countries_from_region</span><span class="p">(</span><span class="s1">&#39;world&#39;</span><span class="p">)</span>
</span><span id="listwhere-225"><a href="#listwhere-225"><span class="linenos">225</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="listwhere-226"><a href="#listwhere-226"><span class="linenos">226</span></a>                        <span class="n">r</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">get_GeoRegion</span><span class="p">()</span><span class="o">.</span><span class="n">get_countries_from_region</span><span class="p">(</span><span class="s1">&#39;europe&#39;</span><span class="p">)</span>
</span><span id="listwhere-227"><a href="#listwhere-227"><span class="linenos">227</span></a>                    <span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">to_standard</span><span class="p">(</span><span class="n">c</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">r</span><span class="p">]</span>
</span><span id="listwhere-228"><a href="#listwhere-228"><span class="linenos">228</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="listwhere-229"><a href="#listwhere-229"><span class="linenos">229</span></a>                <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;subregion&#39;</span><span class="p">:</span>
</span><span id="listwhere-230"><a href="#listwhere-230"><span class="linenos">230</span></a>                    <span class="n">pan</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">get_subregion_list</span><span class="p">()</span>
</span><span id="listwhere-231"><a href="#listwhere-231"><span class="linenos">231</span></a>                    <span class="n">r</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pan</span><span class="o">.</span><span class="n">name_subregion</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</span><span id="listwhere-232"><a href="#listwhere-232"><span class="linenos">232</span></a>                <span class="k">elif</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;region&#39;</span><span class="p">:</span>
</span><span id="listwhere-233"><a href="#listwhere-233"><span class="linenos">233</span></a>                    <span class="n">r</span> <span class="o">=</span> <span class="n">clust</span><span class="p">()</span>
</span><span id="listwhere-234"><a href="#listwhere-234"><span class="linenos">234</span></a>                    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
</span><span id="listwhere-235"><a href="#listwhere-235"><span class="linenos">235</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="listwhere-236"><a href="#listwhere-236"><span class="linenos">236</span></a>                    <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;What is the granularity of your DB ?&#39;</span><span class="p">)</span>
</span><span id="listwhere-237"><a href="#listwhere-237"><span class="linenos">237</span></a>            <span class="k">return</span> <span class="n">r</span>
</span></pre></div>


            <div class="docstring"><p>Get the list of available regions/subregions managed by the current database</p>
</div>


                </section>
                <section id="listbypop">
                            <input id="listbypop-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listbypop</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="listbypop-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#listbypop"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="listbypop-241"><a href="#listbypop-241"><span class="linenos">241</span></a><span class="k">def</span> <span class="nf">listbypop</span><span class="p">():</span>
</span><span id="listbypop-242"><a href="#listbypop-242"><span class="linenos">242</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list of available population normalization</span>
</span><span id="listbypop-243"><a href="#listbypop-243"><span class="linenos">243</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="listbypop-244"><a href="#listbypop-244"><span class="linenos">244</span></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">_dict_bypop</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Get the list of available population normalization</p>
</div>


                </section>
                <section id="listmaplabel">
                            <input id="listmaplabel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listmaplabel</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="listmaplabel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#listmaplabel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="listmaplabel-248"><a href="#listmaplabel-248"><span class="linenos">248</span></a><span class="k">def</span> <span class="nf">listmaplabel</span><span class="p">():</span>
</span><span id="listmaplabel-249"><a href="#listmaplabel-249"><span class="linenos">249</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list of available population normalization</span>
</span><span id="listmaplabel-250"><a href="#listmaplabel-250"><span class="linenos">250</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="listmaplabel-251"><a href="#listmaplabel-251"><span class="linenos">251</span></a>    <span class="k">return</span> <span class="n">_listmaplabel</span>
</span></pre></div>


            <div class="docstring"><p>Get the list of available population normalization</p>
</div>


                </section>
                <section id="setwhom">
                            <input id="setwhom-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setwhom</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">base</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="setwhom-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#setwhom"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="setwhom-255"><a href="#setwhom-255"><span class="linenos">255</span></a><span class="k">def</span> <span class="nf">setwhom</span><span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="setwhom-256"><a href="#setwhom-256"><span class="linenos">256</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the covid19 database used, given as a string.</span>
</span><span id="setwhom-257"><a href="#setwhom-257"><span class="linenos">257</span></a><span class="sd">    Please see pycoa.listbase() for the available current list.</span>
</span><span id="setwhom-258"><a href="#setwhom-258"><span class="linenos">258</span></a>
</span><span id="setwhom-259"><a href="#setwhom-259"><span class="linenos">259</span></a><span class="sd">    By default, the listbase()[0] is the default base used in other</span>
</span><span id="setwhom-260"><a href="#setwhom-260"><span class="linenos">260</span></a><span class="sd">    functions.</span>
</span><span id="setwhom-261"><a href="#setwhom-261"><span class="linenos">261</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="setwhom-262"><a href="#setwhom-262"><span class="linenos">262</span></a>    <span class="n">kwargs_test</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;reload&#39;</span><span class="p">],</span> <span class="s1">&#39;Bad args used in the pycoa.saveoutput function.&#39;</span><span class="p">)</span>
</span><span id="setwhom-263"><a href="#setwhom-263"><span class="linenos">263</span></a>    <span class="n">refresh</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reload&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="setwhom-264"><a href="#setwhom-264"><span class="linenos">264</span></a>    <span class="k">if</span> <span class="n">refresh</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="setwhom-265"><a href="#setwhom-265"><span class="linenos">265</span></a>        <span class="k">raise</span> <span class="n">CoaError</span><span class="p">(</span><span class="s1">&#39;reload must be a boolean ... &#39;</span><span class="p">)</span>
</span><span id="setwhom-266"><a href="#setwhom-266"><span class="linenos">266</span></a>    <span class="k">if</span> <span class="n">base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listwhom</span><span class="p">():</span>
</span><span id="setwhom-267"><a href="#setwhom-267"><span class="linenos">267</span></a>        <span class="k">raise</span> <span class="n">CoaDbError</span><span class="p">(</span><span class="n">base</span> <span class="o">+</span> <span class="s1">&#39; is not a supported database. &#39;</span>
</span><span id="setwhom-268"><a href="#setwhom-268"><span class="linenos">268</span></a>                                <span class="s1">&#39;See pycoa.listbase() for the full list.&#39;</span><span class="p">)</span>
</span><span id="setwhom-269"><a href="#setwhom-269"><span class="linenos">269</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="setwhom-270"><a href="#setwhom-270"><span class="linenos">270</span></a>        <span class="k">if</span> <span class="s1">&#39;_db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
</span><span id="setwhom-271"><a href="#setwhom-271"><span class="linenos">271</span></a>            <span class="k">global</span> <span class="n">_db</span><span class="p">,</span> <span class="n">_cocoplot</span><span class="p">,</span> <span class="n">_whom</span>
</span><span id="setwhom-272"><a href="#setwhom-272"><span class="linenos">272</span></a>        <span class="n">_db</span><span class="p">,</span> <span class="n">_cocoplot</span> <span class="o">=</span> <span class="n">coco</span><span class="o">.</span><span class="n">DataBase</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="n">refresh</span><span class="p">)</span>
</span><span id="setwhom-273"><a href="#setwhom-273"><span class="linenos">273</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">refresh</span><span class="p">:</span>
</span><span id="setwhom-274"><a href="#setwhom-274"><span class="linenos">274</span></a>            <span class="n">_db</span><span class="o">.</span><span class="n">get_parserdb</span><span class="p">()</span><span class="o">.</span><span class="n">get_echoinfo</span><span class="p">()</span>
</span><span id="setwhom-275"><a href="#setwhom-275"><span class="linenos">275</span></a>        <span class="n">_whom</span> <span class="o">=</span> <span class="n">base</span>
</span></pre></div>


            <div class="docstring"><p>Set the covid19 database used, given as a string.
Please see pycoa.listbase() for the available current list.</p>

<p>By default, the listbase()[0] is the default base used in other
functions.</p>
</div>


                </section>
                <section id="getwhom">
                            <input id="getwhom-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getwhom</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">return_error</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="getwhom-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#getwhom"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="getwhom-279"><a href="#getwhom-279"><span class="linenos">279</span></a><span class="k">def</span> <span class="nf">getwhom</span><span class="p">(</span><span class="n">return_error</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="getwhom-280"><a href="#getwhom-280"><span class="linenos">280</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the current base which is used</span>
</span><span id="getwhom-281"><a href="#getwhom-281"><span class="linenos">281</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="getwhom-282"><a href="#getwhom-282"><span class="linenos">282</span></a>    <span class="k">if</span>  <span class="s1">&#39;_db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
</span><span id="getwhom-283"><a href="#getwhom-283"><span class="linenos">283</span></a>        <span class="c1">#if return_error:</span>
</span><span id="getwhom-284"><a href="#getwhom-284"><span class="linenos">284</span></a>        <span class="c1">#    raise CoaKeyError(&#39;setwhom MUST be defined first !&#39;)</span>
</span><span id="getwhom-285"><a href="#getwhom-285"><span class="linenos">285</span></a>        <span class="c1">#else:</span>
</span><span id="getwhom-286"><a href="#getwhom-286"><span class="linenos">286</span></a>            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</span><span id="getwhom-287"><a href="#getwhom-287"><span class="linenos">287</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="getwhom-288"><a href="#getwhom-288"><span class="linenos">288</span></a>        <span class="k">return</span> <span class="n">_whom</span>
</span></pre></div>


            <div class="docstring"><p>Return the current base which is used</p>
</div>


                </section>
                <section id="getkeywordinfo">
                            <input id="getkeywordinfo-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getkeywordinfo</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">which</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="getkeywordinfo-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#getkeywordinfo"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="getkeywordinfo-293"><a href="#getkeywordinfo-293"><span class="linenos">293</span></a><span class="k">def</span> <span class="nf">getkeywordinfo</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="getkeywordinfo-294"><a href="#getkeywordinfo-294"><span class="linenos">294</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="getkeywordinfo-295"><a href="#getkeywordinfo-295"><span class="linenos">295</span></a><span class="sd">        Return keyword_definition for the db selected</span>
</span><span id="getkeywordinfo-296"><a href="#getkeywordinfo-296"><span class="linenos">296</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="getkeywordinfo-297"><a href="#getkeywordinfo-297"><span class="linenos">297</span></a>    <span class="k">if</span>  <span class="s1">&#39;_db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
</span><span id="getkeywordinfo-298"><a href="#getkeywordinfo-298"><span class="linenos">298</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;setwhom MUST be defined first !&#39;</span><span class="p">)</span>
</span><span id="getkeywordinfo-299"><a href="#getkeywordinfo-299"><span class="linenos">299</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="getkeywordinfo-300"><a href="#getkeywordinfo-300"><span class="linenos">300</span></a>        <span class="k">if</span> <span class="n">which</span><span class="p">:</span>
</span><span id="getkeywordinfo-301"><a href="#getkeywordinfo-301"><span class="linenos">301</span></a>            <span class="k">if</span> <span class="n">which</span> <span class="ow">in</span> <span class="n">listwhich</span><span class="p">():</span>
</span><span id="getkeywordinfo-302"><a href="#getkeywordinfo-302"><span class="linenos">302</span></a>                <span class="nb">print</span><span class="p">(</span><span class="n">_db</span><span class="o">.</span><span class="n">get_parserdb</span><span class="p">()</span><span class="o">.</span><span class="n">get_keyword_definition</span><span class="p">(</span><span class="n">which</span><span class="p">))</span>
</span><span id="getkeywordinfo-303"><a href="#getkeywordinfo-303"><span class="linenos">303</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Parsed from this url:&#39;</span><span class="p">,</span><span class="n">_db</span><span class="o">.</span><span class="n">get_parserdb</span><span class="p">()</span><span class="o">.</span><span class="n">get_keyword_url</span><span class="p">(</span><span class="n">which</span><span class="p">))</span>
</span><span id="getkeywordinfo-304"><a href="#getkeywordinfo-304"><span class="linenos">304</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="getkeywordinfo-305"><a href="#getkeywordinfo-305"><span class="linenos">305</span></a>                <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;This value do not exist please check.&#39;</span><span class="o">+</span><span class="s1">&#39;Available variable so far in this db &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">listwhich</span><span class="p">()))</span>
</span><span id="getkeywordinfo-306"><a href="#getkeywordinfo-306"><span class="linenos">306</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="getkeywordinfo-307"><a href="#getkeywordinfo-307"><span class="linenos">307</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">get_parserdb</span><span class="p">()</span><span class="o">.</span><span class="n">get_dbdescription</span><span class="p">()</span>
</span><span id="getkeywordinfo-308"><a href="#getkeywordinfo-308"><span class="linenos">308</span></a>            <span class="k">return</span> <span class="n">df</span>
</span></pre></div>


            <div class="docstring"><p>Return keyword_definition for the db selected</p>
</div>


                </section>
                <section id="getrawdb">
                            <input id="getrawdb-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getrawdb</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="getrawdb-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#getrawdb"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="getrawdb-309"><a href="#getrawdb-309"><span class="linenos">309</span></a><span class="k">def</span> <span class="nf">getrawdb</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="getrawdb-310"><a href="#getrawdb-310"><span class="linenos">310</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="getrawdb-311"><a href="#getrawdb-311"><span class="linenos">311</span></a><span class="sd">        Return the main pandas i.e with all the which values loaded from the database selected</span>
</span><span id="getrawdb-312"><a href="#getrawdb-312"><span class="linenos">312</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="getrawdb-313"><a href="#getrawdb-313"><span class="linenos">313</span></a>    <span class="n">col</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">_db</span><span class="o">.</span><span class="n">get_fulldb</span><span class="p">()</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="getrawdb-314"><a href="#getrawdb-314"><span class="linenos">314</span></a>    <span class="n">mem</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:,}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_db</span><span class="o">.</span><span class="n">get_fulldb</span><span class="p">()[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="getrawdb-315"><a href="#getrawdb-315"><span class="linenos">315</span></a>    <span class="n">info</span><span class="p">(</span><span class="s1">&#39;Memory usage of all columns: &#39;</span> <span class="o">+</span> <span class="n">mem</span> <span class="o">+</span> <span class="s1">&#39; bytes&#39;</span><span class="p">)</span>
</span><span id="getrawdb-316"><a href="#getrawdb-316"><span class="linenos">316</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">get_fulldb</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="getrawdb-317"><a href="#getrawdb-317"><span class="linenos">317</span></a>    <span class="k">return</span> <span class="n">df</span>
</span></pre></div>


            <div class="docstring"><p>Return the main pandas i.e with all the which values loaded from the database selected</p>
</div>


                </section>
                <section id="normbypop">
                            <input id="normbypop-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">normbypop</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pandy</span>, </span><span class="param"><span class="n">val2norm</span>, </span><span class="param"><span class="n">bypop</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="normbypop-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#normbypop"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="normbypop-321"><a href="#normbypop-321"><span class="linenos">321</span></a><span class="k">def</span> <span class="nf">normbypop</span><span class="p">(</span><span class="n">pandy</span><span class="p">,</span> <span class="n">val2norm</span><span class="p">,</span><span class="n">bypop</span><span class="p">):</span>
</span><span id="normbypop-322"><a href="#normbypop-322"><span class="linenos">322</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="normbypop-323"><a href="#normbypop-323"><span class="linenos">323</span></a><span class="sd">        Return a pandas with a normalisation column add by population</span>
</span><span id="normbypop-324"><a href="#normbypop-324"><span class="linenos">324</span></a><span class="sd">        * can normalize by &#39;100&#39;, &#39;1k&#39;, &#39;100k&#39; or &#39;1M&#39;</span>
</span><span id="normbypop-325"><a href="#normbypop-325"><span class="linenos">325</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="normbypop-326"><a href="#normbypop-326"><span class="linenos">326</span></a>    <span class="k">global</span> <span class="n">_gi</span>
</span><span id="normbypop-327"><a href="#normbypop-327"><span class="linenos">327</span></a>    <span class="k">if</span> <span class="n">pandy</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="normbypop-328"><a href="#normbypop-328"><span class="linenos">328</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Seems to be an empty field&#39;</span><span class="p">)</span>
</span><span id="normbypop-329"><a href="#normbypop-329"><span class="linenos">329</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;codelocation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">list</span><span class="p">):</span>
</span><span id="normbypop-330"><a href="#normbypop-330"><span class="linenos">330</span></a>        <span class="n">pandy</span> <span class="o">=</span> <span class="n">pandy</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)</span>
</span><span id="normbypop-331"><a href="#normbypop-331"><span class="linenos">331</span></a>
</span><span id="normbypop-332"><a href="#normbypop-332"><span class="linenos">332</span></a>    <span class="k">if</span> <span class="n">_db</span><span class="o">.</span><span class="n">db_world</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="normbypop-333"><a href="#normbypop-333"><span class="linenos">333</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_gi</span><span class="p">,</span><span class="n">coa</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">GeoInfo</span><span class="p">):</span>
</span><span id="normbypop-334"><a href="#normbypop-334"><span class="linenos">334</span></a>            <span class="n">_gi</span> <span class="o">=</span> <span class="n">coge</span><span class="o">.</span><span class="n">GeoInfo</span><span class="p">()</span>
</span><span id="normbypop-335"><a href="#normbypop-335"><span class="linenos">335</span></a>        <span class="n">pop_field</span><span class="o">=</span><span class="s1">&#39;population&#39;</span>
</span><span id="normbypop-336"><a href="#normbypop-336"><span class="linenos">336</span></a>        <span class="n">pandy</span> <span class="o">=</span> <span class="n">_gi</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">pandy</span><span class="p">,</span><span class="n">field</span><span class="o">=</span><span class="n">pop_field</span><span class="p">,</span><span class="n">geofield</span><span class="o">=</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)</span>
</span><span id="normbypop-337"><a href="#normbypop-337"><span class="linenos">337</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="normbypop-338"><a href="#normbypop-338"><span class="linenos">338</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_gi</span><span class="p">,</span><span class="n">coa</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">GeoCountry</span><span class="p">):</span>
</span><span id="normbypop-339"><a href="#normbypop-339"><span class="linenos">339</span></a>            <span class="n">_gi</span><span class="o">=</span><span class="kc">None</span>
</span><span id="normbypop-340"><a href="#normbypop-340"><span class="linenos">340</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="normbypop-341"><a href="#normbypop-341"><span class="linenos">341</span></a>            <span class="k">if</span> <span class="n">_gi</span><span class="o">.</span><span class="n">get_country</span><span class="p">()</span> <span class="o">!=</span> <span class="n">_db</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">get_country</span><span class="p">():</span>
</span><span id="normbypop-342"><a href="#normbypop-342"><span class="linenos">342</span></a>                <span class="n">_gi</span><span class="o">=</span><span class="kc">None</span>
</span><span id="normbypop-343"><a href="#normbypop-343"><span class="linenos">343</span></a>
</span><span id="normbypop-344"><a href="#normbypop-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="n">_gi</span> <span class="o">==</span> <span class="kc">None</span> <span class="p">:</span>
</span><span id="normbypop-345"><a href="#normbypop-345"><span class="linenos">345</span></a>            <span class="n">_gi</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">geo</span>
</span><span id="normbypop-346"><a href="#normbypop-346"><span class="linenos">346</span></a>        <span class="n">pop_field</span><span class="o">=</span><span class="s1">&#39;population_subregion&#39;</span>
</span><span id="normbypop-347"><a href="#normbypop-347"><span class="linenos">347</span></a>        <span class="k">if</span> <span class="n">pop_field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_gi</span><span class="o">.</span><span class="n">get_list_properties</span><span class="p">():</span>
</span><span id="normbypop-348"><a href="#normbypop-348"><span class="linenos">348</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;The population information not available for this country. No normalization possible&#39;</span><span class="p">)</span>
</span><span id="normbypop-349"><a href="#normbypop-349"><span class="linenos">349</span></a>
</span><span id="normbypop-350"><a href="#normbypop-350"><span class="linenos">350</span></a>        <span class="n">pandy</span><span class="o">=</span><span class="n">_gi</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">pandy</span><span class="p">,</span><span class="n">field</span><span class="o">=</span><span class="n">pop_field</span><span class="p">,</span><span class="n">input_key</span><span class="o">=</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)</span>
</span><span id="normbypop-351"><a href="#normbypop-351"><span class="linenos">351</span></a>
</span><span id="normbypop-352"><a href="#normbypop-352"><span class="linenos">352</span></a>    <span class="n">clust</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;clustername&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span><span id="normbypop-353"><a href="#normbypop-353"><span class="linenos">353</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="normbypop-354"><a href="#normbypop-354"><span class="linenos">354</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">clust</span><span class="p">:</span>
</span><span id="normbypop-355"><a href="#normbypop-355"><span class="linenos">355</span></a>        <span class="n">pandyi</span> <span class="o">=</span> <span class="n">pandy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;clustername&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span> <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="normbypop-356"><a href="#normbypop-356"><span class="linenos">356</span></a>        <span class="n">pandyi</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">pop_field</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandyi</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)[</span><span class="n">pop_field</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="normbypop-357"><a href="#normbypop-357"><span class="linenos">357</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pandyi</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)[</span><span class="s1">&#39;codelocation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="normbypop-358"><a href="#normbypop-358"><span class="linenos">358</span></a>            <span class="n">cody</span> <span class="o">=</span> <span class="n">pandyi</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)[</span><span class="s1">&#39;codelocation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">pandyi</span><span class="p">)</span>
</span><span id="normbypop-359"><a href="#normbypop-359"><span class="linenos">359</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="normbypop-360"><a href="#normbypop-360"><span class="linenos">360</span></a>            <span class="n">cody</span> <span class="o">=</span> <span class="p">[</span><span class="n">pandyi</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;codelocation&#39;</span><span class="p">)[</span><span class="s1">&#39;codelocation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">pandyi</span><span class="p">)</span>
</span><span id="normbypop-361"><a href="#normbypop-361"><span class="linenos">361</span></a>        <span class="n">pandyi</span> <span class="o">=</span> <span class="n">pandyi</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">codelocation</span><span class="o">=</span><span class="n">cody</span><span class="p">)</span>
</span><span id="normbypop-362"><a href="#normbypop-362"><span class="linenos">362</span></a>        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="normbypop-363"><a href="#normbypop-363"><span class="linenos">363</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pandyi</span>
</span><span id="normbypop-364"><a href="#normbypop-364"><span class="linenos">364</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="normbypop-365"><a href="#normbypop-365"><span class="linenos">365</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span><span class="n">pandyi</span><span class="p">])</span>
</span><span id="normbypop-366"><a href="#normbypop-366"><span class="linenos">366</span></a>
</span><span id="normbypop-367"><a href="#normbypop-367"><span class="linenos">367</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s1">&#39;date&#39;</span><span class="p">,</span><span class="s1">&#39;clustername&#39;</span><span class="p">])</span>
</span><span id="normbypop-368"><a href="#normbypop-368"><span class="linenos">368</span></a>    <span class="n">pandy</span> <span class="o">=</span> <span class="n">df</span>
</span><span id="normbypop-369"><a href="#normbypop-369"><span class="linenos">369</span></a>
</span><span id="normbypop-370"><a href="#normbypop-370"><span class="linenos">370</span></a>    <span class="n">pandy</span><span class="o">=</span><span class="n">pandy</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="normbypop-371"><a href="#normbypop-371"><span class="linenos">371</span></a>    <span class="n">pandy</span><span class="p">[</span><span class="n">pop_field</span><span class="p">]</span><span class="o">=</span><span class="n">pandy</span><span class="p">[</span><span class="n">pop_field</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</span><span id="normbypop-372"><a href="#normbypop-372"><span class="linenos">372</span></a>    <span class="k">if</span> <span class="n">bypop</span> <span class="o">==</span> <span class="s1">&#39;pop&#39;</span><span class="p">:</span>
</span><span id="normbypop-373"><a href="#normbypop-373"><span class="linenos">373</span></a>        <span class="n">pandy</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">val2norm</span><span class="o">+</span><span class="s1">&#39; per total population&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">pandy</span><span class="p">[</span><span class="n">val2norm</span><span class="p">]</span><span class="o">/</span><span class="n">pandy</span><span class="p">[</span><span class="n">pop_field</span><span class="p">]</span><span class="o">*</span><span class="n">_dict_bypop</span><span class="p">[</span><span class="n">bypop</span><span class="p">]</span>
</span><span id="normbypop-374"><a href="#normbypop-374"><span class="linenos">374</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="normbypop-375"><a href="#normbypop-375"><span class="linenos">375</span></a>        <span class="n">pandy</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">val2norm</span><span class="o">+</span><span class="s1">&#39; per &#39;</span><span class="o">+</span><span class="n">bypop</span> <span class="o">+</span> <span class="s1">&#39; population&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">pandy</span><span class="p">[</span><span class="n">val2norm</span><span class="p">]</span><span class="o">/</span><span class="n">pandy</span><span class="p">[</span><span class="n">pop_field</span><span class="p">]</span><span class="o">*</span><span class="n">_dict_bypop</span><span class="p">[</span><span class="n">bypop</span><span class="p">]</span>
</span><span id="normbypop-376"><a href="#normbypop-376"><span class="linenos">376</span></a>    <span class="k">return</span> <span class="n">pandy</span>
</span></pre></div>


            <div class="docstring"><p>Return a pandas with a normalisation column add by population</p>

<ul>
<li>can normalize by '100', '1k', '100k' or '1M'</li>
</ul>
</div>


                </section>
                <section id="chartsinput_deco">
                            <input id="chartsinput_deco-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">chartsinput_deco</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">f</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="chartsinput_deco-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#chartsinput_deco"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="chartsinput_deco-383"><a href="#chartsinput_deco-383"><span class="linenos">383</span></a><span class="k">def</span> <span class="nf">chartsinput_deco</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
</span><span id="chartsinput_deco-384"><a href="#chartsinput_deco-384"><span class="linenos">384</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="chartsinput_deco-385"><a href="#chartsinput_deco-385"><span class="linenos">385</span></a><span class="sd">        Main decorator it mainly deals with arg testings</span>
</span><span id="chartsinput_deco-386"><a href="#chartsinput_deco-386"><span class="linenos">386</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="chartsinput_deco-387"><a href="#chartsinput_deco-387"><span class="linenos">387</span></a>    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="chartsinput_deco-388"><a href="#chartsinput_deco-388"><span class="linenos">388</span></a>    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="chartsinput_deco-389"><a href="#chartsinput_deco-389"><span class="linenos">389</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="chartsinput_deco-390"><a href="#chartsinput_deco-390"><span class="linenos">390</span></a><span class="sd">            wrapper dealing with arg testing</span>
</span><span id="chartsinput_deco-391"><a href="#chartsinput_deco-391"><span class="linenos">391</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="chartsinput_deco-392"><a href="#chartsinput_deco-392"><span class="linenos">392</span></a>        <span class="n">kwargs_test</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="chartsinput_deco-393"><a href="#chartsinput_deco-393"><span class="linenos">393</span></a>                    <span class="p">[</span><span class="s1">&#39;where&#39;</span><span class="p">,</span> <span class="s1">&#39;what&#39;</span><span class="p">,</span> <span class="s1">&#39;which&#39;</span><span class="p">,</span> <span class="s1">&#39;whom&#39;</span><span class="p">,</span><span class="s1">&#39;reload&#39;</span><span class="p">,</span><span class="s1">&#39;when&#39;</span><span class="p">,</span> <span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="s1">&#39;input_field&#39;</span><span class="p">,</span><span class="s1">&#39;output&#39;</span><span class="p">,</span>\
</span><span id="chartsinput_deco-394"><a href="#chartsinput_deco-394"><span class="linenos">394</span></a>                    <span class="s1">&#39;title&#39;</span><span class="p">,</span><span class="s1">&#39;typeofplot&#39;</span><span class="p">,</span><span class="s1">&#39;typeofhist&#39;</span><span class="p">,</span><span class="s1">&#39;bins&#39;</span><span class="p">,</span><span class="s1">&#39;visu&#39;</span><span class="p">,</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span><span class="s1">&#39;dateslider&#39;</span><span class="p">,</span><span class="s1">&#39;maplabel&#39;</span><span class="p">,</span><span class="s1">&#39;option&#39;</span><span class="p">,</span>
</span><span id="chartsinput_deco-395"><a href="#chartsinput_deco-395"><span class="linenos">395</span></a>                    <span class="s1">&#39;mode&#39;</span><span class="p">,</span><span class="s1">&#39;guideline&#39;</span><span class="p">,</span><span class="s1">&#39;bypop&#39;</span><span class="p">,</span> <span class="s1">&#39;plot_width&#39;</span><span class="p">,</span><span class="s1">&#39;plot_height&#39;</span><span class="p">,</span><span class="s1">&#39;textcopyright&#39;</span><span class="p">,</span><span class="s1">&#39;cursor_date&#39;</span><span class="p">],</span>
</span><span id="chartsinput_deco-396"><a href="#chartsinput_deco-396"><span class="linenos">396</span></a>                    <span class="s1">&#39;Bad args used in the pycoa function.&#39;</span><span class="p">)</span>
</span><span id="chartsinput_deco-397"><a href="#chartsinput_deco-397"><span class="linenos">397</span></a>
</span><span id="chartsinput_deco-398"><a href="#chartsinput_deco-398"><span class="linenos">398</span></a>    <span class="c1"># no dateslider currently</span>
</span><span id="chartsinput_deco-399"><a href="#chartsinput_deco-399"><span class="linenos">399</span></a>        <span class="k">if</span> <span class="s1">&#39;_db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
</span><span id="chartsinput_deco-400"><a href="#chartsinput_deco-400"><span class="linenos">400</span></a>            <span class="k">global</span> <span class="n">_db</span><span class="p">,</span> <span class="n">_cocoplot</span><span class="p">,</span> <span class="n">_whom</span>
</span><span id="chartsinput_deco-401"><a href="#chartsinput_deco-401"><span class="linenos">401</span></a>            <span class="n">_db</span><span class="p">,</span> <span class="n">_cocoplot</span> <span class="o">=</span> <span class="n">coco</span><span class="o">.</span><span class="n">DataBase</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">_whom</span><span class="p">)</span>
</span><span id="chartsinput_deco-402"><a href="#chartsinput_deco-402"><span class="linenos">402</span></a>            <span class="c1">#raise CoaKeyError(&#39;No database has been selected. You MUST define one using \&quot;setwhom()\&quot; &#39;)</span>
</span><span id="chartsinput_deco-403"><a href="#chartsinput_deco-403"><span class="linenos">403</span></a>
</span><span id="chartsinput_deco-404"><a href="#chartsinput_deco-404"><span class="linenos">404</span></a>        <span class="n">where</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;where&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="chartsinput_deco-405"><a href="#chartsinput_deco-405"><span class="linenos">405</span></a>        <span class="n">which</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;which&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="chartsinput_deco-406"><a href="#chartsinput_deco-406"><span class="linenos">406</span></a>        <span class="n">what</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;what&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="chartsinput_deco-407"><a href="#chartsinput_deco-407"><span class="linenos">407</span></a>
</span><span id="chartsinput_deco-408"><a href="#chartsinput_deco-408"><span class="linenos">408</span></a>        <span class="n">whom</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;whom&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="chartsinput_deco-409"><a href="#chartsinput_deco-409"><span class="linenos">409</span></a>        <span class="n">option</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="chartsinput_deco-410"><a href="#chartsinput_deco-410"><span class="linenos">410</span></a>        <span class="n">when</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;when&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="chartsinput_deco-411"><a href="#chartsinput_deco-411"><span class="linenos">411</span></a>        <span class="n">input_arg</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="chartsinput_deco-412"><a href="#chartsinput_deco-412"><span class="linenos">412</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
</span><span id="chartsinput_deco-413"><a href="#chartsinput_deco-413"><span class="linenos">413</span></a>
</span><span id="chartsinput_deco-414"><a href="#chartsinput_deco-414"><span class="linenos">414</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">option</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">what</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">input_field</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span>
</span><span id="chartsinput_deco-415"><a href="#chartsinput_deco-415"><span class="linenos">415</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;option/what not compatible when input_fied/which is a list&#39;</span><span class="p">)</span>
</span><span id="chartsinput_deco-416"><a href="#chartsinput_deco-416"><span class="linenos">416</span></a>
</span><span id="chartsinput_deco-417"><a href="#chartsinput_deco-417"><span class="linenos">417</span></a>        <span class="k">if</span> <span class="s1">&#39;input_field&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="chartsinput_deco-418"><a href="#chartsinput_deco-418"><span class="linenos">418</span></a>            <span class="n">which</span> <span class="o">=</span> <span class="n">input_field</span>
</span><span id="chartsinput_deco-419"><a href="#chartsinput_deco-419"><span class="linenos">419</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="chartsinput_deco-420"><a href="#chartsinput_deco-420"><span class="linenos">420</span></a>            <span class="n">which</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]</span>
</span><span id="chartsinput_deco-421"><a href="#chartsinput_deco-421"><span class="linenos">421</span></a>
</span><span id="chartsinput_deco-422"><a href="#chartsinput_deco-422"><span class="linenos">422</span></a>        <span class="k">if</span> <span class="n">what</span><span class="p">:</span>
</span><span id="chartsinput_deco-423"><a href="#chartsinput_deco-423"><span class="linenos">423</span></a>            <span class="k">if</span> <span class="n">what</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listwhat</span><span class="p">():</span>
</span><span id="chartsinput_deco-424"><a href="#chartsinput_deco-424"><span class="linenos">424</span></a>                <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;What option &#39;</span> <span class="o">+</span> <span class="n">what</span> <span class="o">+</span> <span class="s1">&#39; not supported. &#39;</span>
</span><span id="chartsinput_deco-425"><a href="#chartsinput_deco-425"><span class="linenos">425</span></a>                                                          <span class="s1">&#39;See listwhat() for full list.&#39;</span><span class="p">)</span>
</span><span id="chartsinput_deco-426"><a href="#chartsinput_deco-426"><span class="linenos">426</span></a>            <span class="k">if</span> <span class="s1">&#39;what&#39;</span><span class="o">==</span><span class="s1">&#39;sandard&#39;</span><span class="p">:</span>
</span><span id="chartsinput_deco-427"><a href="#chartsinput_deco-427"><span class="linenos">427</span></a>                <span class="n">what</span> <span class="o">=</span> <span class="n">which</span>
</span><span id="chartsinput_deco-428"><a href="#chartsinput_deco-428"><span class="linenos">428</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="chartsinput_deco-429"><a href="#chartsinput_deco-429"><span class="linenos">429</span></a>            <span class="n">what</span> <span class="o">=</span> <span class="n">_listwhat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="chartsinput_deco-430"><a href="#chartsinput_deco-430"><span class="linenos">430</span></a>
</span><span id="chartsinput_deco-431"><a href="#chartsinput_deco-431"><span class="linenos">431</span></a>        <span class="n">option</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="chartsinput_deco-432"><a href="#chartsinput_deco-432"><span class="linenos">432</span></a>        <span class="n">bypop</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">,</span><span class="s1">&#39;no&#39;</span><span class="p">)</span>
</span><span id="chartsinput_deco-433"><a href="#chartsinput_deco-433"><span class="linenos">433</span></a>
</span><span id="chartsinput_deco-434"><a href="#chartsinput_deco-434"><span class="linenos">434</span></a>        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="n">listoutput</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="chartsinput_deco-435"><a href="#chartsinput_deco-435"><span class="linenos">435</span></a>
</span><span id="chartsinput_deco-436"><a href="#chartsinput_deco-436"><span class="linenos">436</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listoutput</span><span class="p">():</span>
</span><span id="chartsinput_deco-437"><a href="#chartsinput_deco-437"><span class="linenos">437</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Output option &#39;</span> <span class="o">+</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; not supported. See help().&#39;</span><span class="p">)</span>
</span><span id="chartsinput_deco-438"><a href="#chartsinput_deco-438"><span class="linenos">438</span></a>        <span class="k">if</span> <span class="n">whom</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="chartsinput_deco-439"><a href="#chartsinput_deco-439"><span class="linenos">439</span></a>            <span class="n">whom</span> <span class="o">=</span> <span class="n">_whom</span>
</span><span id="chartsinput_deco-440"><a href="#chartsinput_deco-440"><span class="linenos">440</span></a>        <span class="k">if</span> <span class="n">whom</span> <span class="o">!=</span> <span class="n">_whom</span><span class="p">:</span>
</span><span id="chartsinput_deco-441"><a href="#chartsinput_deco-441"><span class="linenos">441</span></a>            <span class="n">setwhom</span><span class="p">(</span><span class="n">whom</span><span class="p">)</span>
</span><span id="chartsinput_deco-442"><a href="#chartsinput_deco-442"><span class="linenos">442</span></a>
</span><span id="chartsinput_deco-443"><a href="#chartsinput_deco-443"><span class="linenos">443</span></a>        <span class="k">if</span> <span class="n">bypop</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listbypop</span><span class="p">():</span>
</span><span id="chartsinput_deco-444"><a href="#chartsinput_deco-444"><span class="linenos">444</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;The bypop arg should be selected in &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">listbypop</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; only.&#39;</span><span class="p">)</span>
</span><span id="chartsinput_deco-445"><a href="#chartsinput_deco-445"><span class="linenos">445</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_arg</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="chartsinput_deco-446"><a href="#chartsinput_deco-446"><span class="linenos">446</span></a>            <span class="k">if</span> <span class="n">input_arg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">input_arg</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="chartsinput_deco-447"><a href="#chartsinput_deco-447"><span class="linenos">447</span></a>                <span class="n">pandy</span> <span class="o">=</span> <span class="n">input_arg</span>
</span><span id="chartsinput_deco-448"><a href="#chartsinput_deco-448"><span class="linenos">448</span></a>                <span class="n">pandy</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">get_stats</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="chartsinput_deco-449"><a href="#chartsinput_deco-449"><span class="linenos">449</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="chartsinput_deco-450"><a href="#chartsinput_deco-450"><span class="linenos">450</span></a>                <span class="n">pandy</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="chartsinput_deco-451"><a href="#chartsinput_deco-451"><span class="linenos">451</span></a>                <span class="n">input_field</span> <span class="o">=</span> <span class="n">which</span>
</span><span id="chartsinput_deco-452"><a href="#chartsinput_deco-452"><span class="linenos">452</span></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">which</span><span class="p">):</span>
</span><span id="chartsinput_deco-453"><a href="#chartsinput_deco-453"><span class="linenos">453</span></a>                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">get_stats</span><span class="p">(</span><span class="n">input_field</span><span class="o">=</span><span class="n">input_field</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">option</span><span class="p">)</span>
</span><span id="chartsinput_deco-454"><a href="#chartsinput_deco-454"><span class="linenos">454</span></a>                    <span class="k">if</span> <span class="n">pandy</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="chartsinput_deco-455"><a href="#chartsinput_deco-455"><span class="linenos">455</span></a>                        <span class="n">pandy</span> <span class="o">=</span> <span class="n">tmp</span>
</span><span id="chartsinput_deco-456"><a href="#chartsinput_deco-456"><span class="linenos">456</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="chartsinput_deco-457"><a href="#chartsinput_deco-457"><span class="linenos">457</span></a>                        <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span><span class="s1">&#39;weekly&#39;</span><span class="p">,</span><span class="s1">&#39;codelocation&#39;</span><span class="p">,</span><span class="s1">&#39;clustername&#39;</span><span class="p">])</span>
</span><span id="chartsinput_deco-458"><a href="#chartsinput_deco-458"><span class="linenos">458</span></a>                    <span class="n">pandy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">pandy</span><span class="p">,</span> <span class="n">tmp</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span><span class="s1">&#39;where&#39;</span><span class="p">])</span>
</span><span id="chartsinput_deco-459"><a href="#chartsinput_deco-459"><span class="linenos">459</span></a>                <span class="n">input_arg</span> <span class="o">=</span> <span class="n">pandy</span>
</span><span id="chartsinput_deco-460"><a href="#chartsinput_deco-460"><span class="linenos">460</span></a>            <span class="k">if</span> <span class="n">bypop</span> <span class="o">!=</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
</span><span id="chartsinput_deco-461"><a href="#chartsinput_deco-461"><span class="linenos">461</span></a>                <span class="n">input_arg</span> <span class="o">=</span> <span class="n">normbypop</span><span class="p">(</span><span class="n">pandy</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="n">bypop</span><span class="p">)</span>
</span><span id="chartsinput_deco-462"><a href="#chartsinput_deco-462"><span class="linenos">462</span></a>                <span class="k">if</span> <span class="n">bypop</span><span class="o">==</span><span class="s1">&#39;pop&#39;</span><span class="p">:</span>
</span><span id="chartsinput_deco-463"><a href="#chartsinput_deco-463"><span class="linenos">463</span></a>                    <span class="n">input_field</span> <span class="o">=</span> <span class="n">input_field</span><span class="o">+</span><span class="s1">&#39; per total population&#39;</span>
</span><span id="chartsinput_deco-464"><a href="#chartsinput_deco-464"><span class="linenos">464</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="chartsinput_deco-465"><a href="#chartsinput_deco-465"><span class="linenos">465</span></a>                    <span class="n">input_field</span> <span class="o">=</span> <span class="n">input_field</span><span class="o">+</span><span class="s1">&#39; per &#39;</span><span class="o">+</span> <span class="n">bypop</span> <span class="o">+</span> <span class="s1">&#39; population&#39;</span>
</span><span id="chartsinput_deco-466"><a href="#chartsinput_deco-466"><span class="linenos">466</span></a>                <span class="n">pandy</span> <span class="o">=</span> <span class="n">input_arg</span>
</span><span id="chartsinput_deco-467"><a href="#chartsinput_deco-467"><span class="linenos">467</span></a>
</span><span id="chartsinput_deco-468"><a href="#chartsinput_deco-468"><span class="linenos">468</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_field</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
</span><span id="chartsinput_deco-469"><a href="#chartsinput_deco-469"><span class="linenos">469</span></a>                <span class="n">which</span> <span class="o">=</span> <span class="n">input_field</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="chartsinput_deco-470"><a href="#chartsinput_deco-470"><span class="linenos">470</span></a>            <span class="c1">#else:</span>
</span><span id="chartsinput_deco-471"><a href="#chartsinput_deco-471"><span class="linenos">471</span></a>            <span class="c1">#    which = input_field</span>
</span><span id="chartsinput_deco-472"><a href="#chartsinput_deco-472"><span class="linenos">472</span></a>            <span class="c1">#if which is None:</span>
</span><span id="chartsinput_deco-473"><a href="#chartsinput_deco-473"><span class="linenos">473</span></a>            <span class="c1">#    which = pandy.columns[2]</span>
</span><span id="chartsinput_deco-474"><a href="#chartsinput_deco-474"><span class="linenos">474</span></a>
</span><span id="chartsinput_deco-475"><a href="#chartsinput_deco-475"><span class="linenos">475</span></a>            <span class="n">pandy</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;standard&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[</span><span class="n">which</span><span class="p">]</span>
</span><span id="chartsinput_deco-476"><a href="#chartsinput_deco-476"><span class="linenos">476</span></a>            <span class="k">if</span> <span class="s1">&#39;input_field&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="chartsinput_deco-477"><a href="#chartsinput_deco-477"><span class="linenos">477</span></a>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_field</span>
</span><span id="chartsinput_deco-478"><a href="#chartsinput_deco-478"><span class="linenos">478</span></a>            <span class="c1">#if option:</span>
</span><span id="chartsinput_deco-479"><a href="#chartsinput_deco-479"><span class="linenos">479</span></a>            <span class="c1">#    print(&#39;option has no effect here, please try do it when you construct your input pandas &#39;)</span>
</span><span id="chartsinput_deco-480"><a href="#chartsinput_deco-480"><span class="linenos">480</span></a>        <span class="k">elif</span> <span class="n">input_arg</span> <span class="o">==</span> <span class="kc">None</span> <span class="p">:</span>
</span><span id="chartsinput_deco-481"><a href="#chartsinput_deco-481"><span class="linenos">481</span></a>            <span class="c1">#kwargs.pop(&#39;input_field&#39;)</span>
</span><span id="chartsinput_deco-482"><a href="#chartsinput_deco-482"><span class="linenos">482</span></a>            <span class="n">pandy</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="n">get_stats</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="chartsinput_deco-483"><a href="#chartsinput_deco-483"><span class="linenos">483</span></a>            <span class="k">if</span> <span class="n">which</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="chartsinput_deco-484"><a href="#chartsinput_deco-484"><span class="linenos">484</span></a>                <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;standard&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[</span><span class="n">which</span><span class="p">]</span>
</span><span id="chartsinput_deco-485"><a href="#chartsinput_deco-485"><span class="linenos">485</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="chartsinput_deco-486"><a href="#chartsinput_deco-486"><span class="linenos">486</span></a>                <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;standard&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[</span><span class="n">pandy</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
</span><span id="chartsinput_deco-487"><a href="#chartsinput_deco-487"><span class="linenos">487</span></a>                <span class="n">which</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pandy</span><span class="o">.</span><span class="n">columns</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="chartsinput_deco-488"><a href="#chartsinput_deco-488"><span class="linenos">488</span></a>            <span class="n">input_field</span> <span class="o">=</span> <span class="n">what</span>
</span><span id="chartsinput_deco-489"><a href="#chartsinput_deco-489"><span class="linenos">489</span></a>
</span><span id="chartsinput_deco-490"><a href="#chartsinput_deco-490"><span class="linenos">490</span></a>            <span class="k">if</span> <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="chartsinput_deco-491"><a href="#chartsinput_deco-491"><span class="linenos">491</span></a>                <span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------&#39;</span><span class="p">)</span>
</span><span id="chartsinput_deco-492"><a href="#chartsinput_deco-492"><span class="linenos">492</span></a>                <span class="n">info</span><span class="p">(</span><span class="s1">&#39;All values for &#39;</span><span class="o">+</span> <span class="n">which</span> <span class="o">+</span> <span class="s1">&#39; is nan nor empty&#39;</span><span class="p">)</span>
</span><span id="chartsinput_deco-493"><a href="#chartsinput_deco-493"><span class="linenos">493</span></a>                <span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------&#39;</span><span class="p">)</span>
</span><span id="chartsinput_deco-494"><a href="#chartsinput_deco-494"><span class="linenos">494</span></a>                <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">where</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()]</span>
</span><span id="chartsinput_deco-495"><a href="#chartsinput_deco-495"><span class="linenos">495</span></a>                <span class="n">lwhere</span><span class="o">=</span><span class="n">flat_list</span><span class="p">([[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">where</span><span class="p">])</span>
</span><span id="chartsinput_deco-496"><a href="#chartsinput_deco-496"><span class="linenos">496</span></a>                <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;where&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">lwhere</span>
</span><span id="chartsinput_deco-497"><a href="#chartsinput_deco-497"><span class="linenos">497</span></a>                <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;clustername&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">lwhere</span>
</span><span id="chartsinput_deco-498"><a href="#chartsinput_deco-498"><span class="linenos">498</span></a>                <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;codelocation&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">pandy</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;000&#39;</span><span class="p">]</span>
</span><span id="chartsinput_deco-499"><a href="#chartsinput_deco-499"><span class="linenos">499</span></a>                <span class="n">pandy</span><span class="o">=</span><span class="n">pandy</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="chartsinput_deco-500"><a href="#chartsinput_deco-500"><span class="linenos">500</span></a>                <span class="n">bypop</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
</span><span id="chartsinput_deco-501"><a href="#chartsinput_deco-501"><span class="linenos">501</span></a>            <span class="k">if</span> <span class="n">bypop</span> <span class="o">!=</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
</span><span id="chartsinput_deco-502"><a href="#chartsinput_deco-502"><span class="linenos">502</span></a>                <span class="k">if</span> <span class="n">what</span><span class="p">:</span>
</span><span id="chartsinput_deco-503"><a href="#chartsinput_deco-503"><span class="linenos">503</span></a>                    <span class="n">val</span> <span class="o">=</span> <span class="n">what</span>
</span><span id="chartsinput_deco-504"><a href="#chartsinput_deco-504"><span class="linenos">504</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="chartsinput_deco-505"><a href="#chartsinput_deco-505"><span class="linenos">505</span></a>                    <span class="n">val</span> <span class="o">=</span> <span class="n">_listwhat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="chartsinput_deco-506"><a href="#chartsinput_deco-506"><span class="linenos">506</span></a>                <span class="n">pandy</span> <span class="o">=</span> <span class="n">normbypop</span><span class="p">(</span><span class="n">pandy</span> <span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">bypop</span><span class="p">)</span>
</span><span id="chartsinput_deco-507"><a href="#chartsinput_deco-507"><span class="linenos">507</span></a>                <span class="k">if</span> <span class="n">bypop</span><span class="o">==</span><span class="s1">&#39;pop&#39;</span><span class="p">:</span>
</span><span id="chartsinput_deco-508"><a href="#chartsinput_deco-508"><span class="linenos">508</span></a>                    <span class="n">input_field</span> <span class="o">=</span> <span class="n">input_field</span><span class="o">+</span><span class="s1">&#39; per total population&#39;</span>
</span><span id="chartsinput_deco-509"><a href="#chartsinput_deco-509"><span class="linenos">509</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="chartsinput_deco-510"><a href="#chartsinput_deco-510"><span class="linenos">510</span></a>                    <span class="n">input_field</span> <span class="o">=</span> <span class="n">input_field</span><span class="o">+</span><span class="s1">&#39; per &#39;</span><span class="o">+</span> <span class="n">bypop</span> <span class="o">+</span> <span class="s1">&#39; population&#39;</span>
</span><span id="chartsinput_deco-511"><a href="#chartsinput_deco-511"><span class="linenos">511</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_field</span>
</span><span id="chartsinput_deco-512"><a href="#chartsinput_deco-512"><span class="linenos">512</span></a>            <span class="n">option</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="chartsinput_deco-513"><a href="#chartsinput_deco-513"><span class="linenos">513</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="chartsinput_deco-514"><a href="#chartsinput_deco-514"><span class="linenos">514</span></a>            <span class="k">raise</span> <span class="n">CoaTypeError</span><span class="p">(</span><span class="s1">&#39;Waiting input as valid pycoa pandas &#39;</span>
</span><span id="chartsinput_deco-515"><a href="#chartsinput_deco-515"><span class="linenos">515</span></a>                               <span class="s1">&#39;dataframe. See help.&#39;</span><span class="p">)</span>
</span><span id="chartsinput_deco-516"><a href="#chartsinput_deco-516"><span class="linenos">516</span></a>        <span class="n">when_beg</span><span class="p">,</span> <span class="n">when_end</span> <span class="o">=</span> <span class="n">extract_dates</span><span class="p">(</span><span class="n">when</span><span class="p">)</span>
</span><span id="chartsinput_deco-517"><a href="#chartsinput_deco-517"><span class="linenos">517</span></a>
</span><span id="chartsinput_deco-518"><a href="#chartsinput_deco-518"><span class="linenos">518</span></a>        <span class="k">if</span> <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="chartsinput_deco-519"><a href="#chartsinput_deco-519"><span class="linenos">519</span></a>            <span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------&#39;</span><span class="p">)</span>
</span><span id="chartsinput_deco-520"><a href="#chartsinput_deco-520"><span class="linenos">520</span></a>            <span class="n">info</span><span class="p">(</span><span class="s1">&#39;All values for &#39;</span><span class="o">+</span> <span class="n">which</span> <span class="o">+</span> <span class="s1">&#39; is nan nor empty&#39;</span><span class="p">)</span>
</span><span id="chartsinput_deco-521"><a href="#chartsinput_deco-521"><span class="linenos">521</span></a>            <span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------&#39;</span><span class="p">)</span>
</span><span id="chartsinput_deco-522"><a href="#chartsinput_deco-522"><span class="linenos">522</span></a>            <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">where</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()]</span>
</span><span id="chartsinput_deco-523"><a href="#chartsinput_deco-523"><span class="linenos">523</span></a>            <span class="n">lwhere</span><span class="o">=</span><span class="n">flat_list</span><span class="p">([[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">where</span><span class="p">])</span>
</span><span id="chartsinput_deco-524"><a href="#chartsinput_deco-524"><span class="linenos">524</span></a>            <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;where&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">lwhere</span>
</span><span id="chartsinput_deco-525"><a href="#chartsinput_deco-525"><span class="linenos">525</span></a>            <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;clustername&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">lwhere</span>
</span><span id="chartsinput_deco-526"><a href="#chartsinput_deco-526"><span class="linenos">526</span></a>            <span class="n">pandy</span><span class="p">[</span><span class="s1">&#39;codelocation&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">pandy</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;000&#39;</span><span class="p">]</span>
</span><span id="chartsinput_deco-527"><a href="#chartsinput_deco-527"><span class="linenos">527</span></a>            <span class="n">pandy</span><span class="o">=</span><span class="n">pandy</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="chartsinput_deco-528"><a href="#chartsinput_deco-528"><span class="linenos">528</span></a>            <span class="n">bypop</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
</span><span id="chartsinput_deco-529"><a href="#chartsinput_deco-529"><span class="linenos">529</span></a>
</span><span id="chartsinput_deco-530"><a href="#chartsinput_deco-530"><span class="linenos">530</span></a>        <span class="n">db_first_date</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="chartsinput_deco-531"><a href="#chartsinput_deco-531"><span class="linenos">531</span></a>        <span class="n">db_last_date</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="chartsinput_deco-532"><a href="#chartsinput_deco-532"><span class="linenos">532</span></a>
</span><span id="chartsinput_deco-533"><a href="#chartsinput_deco-533"><span class="linenos">533</span></a>        <span class="k">if</span> <span class="n">when_beg</span> <span class="o">&lt;</span> <span class="n">db_first_date</span><span class="p">:</span>
</span><span id="chartsinput_deco-534"><a href="#chartsinput_deco-534"><span class="linenos">534</span></a>            <span class="n">when_beg</span> <span class="o">=</span> <span class="n">db_first_date</span>
</span><span id="chartsinput_deco-535"><a href="#chartsinput_deco-535"><span class="linenos">535</span></a>
</span><span id="chartsinput_deco-536"><a href="#chartsinput_deco-536"><span class="linenos">536</span></a>        <span class="k">if</span> <span class="n">when_end</span> <span class="o">&gt;</span> <span class="n">db_last_date</span><span class="p">:</span>
</span><span id="chartsinput_deco-537"><a href="#chartsinput_deco-537"><span class="linenos">537</span></a>            <span class="n">when_end</span> <span class="o">=</span> <span class="n">db_last_date</span>
</span><span id="chartsinput_deco-538"><a href="#chartsinput_deco-538"><span class="linenos">538</span></a>
</span><span id="chartsinput_deco-539"><a href="#chartsinput_deco-539"><span class="linenos">539</span></a>        <span class="k">if</span> <span class="n">when_end</span> <span class="o">&lt;</span> <span class="n">db_first_date</span><span class="p">:</span>
</span><span id="chartsinput_deco-540"><a href="#chartsinput_deco-540"><span class="linenos">540</span></a>            <span class="k">raise</span> <span class="n">CoaNoData</span><span class="p">(</span><span class="s2">&quot;No available data before &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">db_first_date</span><span class="p">))</span>
</span><span id="chartsinput_deco-541"><a href="#chartsinput_deco-541"><span class="linenos">541</span></a>        <span class="c1"># when cut</span>
</span><span id="chartsinput_deco-542"><a href="#chartsinput_deco-542"><span class="linenos">542</span></a>        <span class="k">if</span> <span class="n">when_beg</span> <span class="o">&gt;</span>  <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="ow">or</span> <span class="n">when_end</span> <span class="o">&gt;</span>  <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
</span><span id="chartsinput_deco-543"><a href="#chartsinput_deco-543"><span class="linenos">543</span></a>            <span class="k">raise</span> <span class="n">CoaNoData</span><span class="p">(</span><span class="s2">&quot;No available data after &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">pandy</span><span class="p">[[</span><span class="n">which</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
</span><span id="chartsinput_deco-544"><a href="#chartsinput_deco-544"><span class="linenos">544</span></a>        <span class="n">pandy</span> <span class="o">=</span> <span class="n">pandy</span><span class="p">[(</span><span class="n">pandy</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="n">when_beg</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pandy</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;=</span> <span class="n">when_end</span><span class="p">)]</span>
</span><span id="chartsinput_deco-545"><a href="#chartsinput_deco-545"><span class="linenos">545</span></a>        <span class="k">if</span> <span class="n">bypop</span> <span class="o">!=</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
</span><span id="chartsinput_deco-546"><a href="#chartsinput_deco-546"><span class="linenos">546</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pandy</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39; per &#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
</span><span id="chartsinput_deco-547"><a href="#chartsinput_deco-547"><span class="linenos">547</span></a>            <span class="c1">#name = [i for i in list(pandy.columns) if &#39; per &#39; in i]</span>
</span><span id="chartsinput_deco-548"><a href="#chartsinput_deco-548"><span class="linenos">548</span></a>            <span class="k">if</span> <span class="n">bypop</span><span class="o">==</span><span class="s1">&#39;pop&#39;</span><span class="p">:</span>
</span><span id="chartsinput_deco-549"><a href="#chartsinput_deco-549"><span class="linenos">549</span></a>                <span class="n">bypop</span><span class="o">=</span><span class="s1">&#39;total population&#39;</span>
</span><span id="chartsinput_deco-550"><a href="#chartsinput_deco-550"><span class="linenos">550</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="chartsinput_deco-551"><a href="#chartsinput_deco-551"><span class="linenos">551</span></a>                <span class="n">bypop</span><span class="o">+=</span><span class="s1">&#39; population&#39;</span>
</span><span id="chartsinput_deco-552"><a href="#chartsinput_deco-552"><span class="linenos">552</span></a>            <span class="k">if</span> <span class="s1">&#39;tot_&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">what</span> <span class="ow">or</span> <span class="n">what</span><span class="o">==</span><span class="s1">&#39;standard&#39;</span><span class="p">:</span>
</span><span id="chartsinput_deco-553"><a href="#chartsinput_deco-553"><span class="linenos">553</span></a>                <span class="n">renamed</span> <span class="o">=</span> <span class="n">which</span> <span class="o">+</span> <span class="s1">&#39; per &#39;</span><span class="o">+</span> <span class="n">bypop</span>
</span><span id="chartsinput_deco-554"><a href="#chartsinput_deco-554"><span class="linenos">554</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="chartsinput_deco-555"><a href="#chartsinput_deco-555"><span class="linenos">555</span></a>                <span class="n">renamed</span> <span class="o">=</span> <span class="n">which</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">+</span> <span class="n">what</span> <span class="o">+</span><span class="s1">&#39; per &#39;</span><span class="o">+</span> <span class="n">bypop</span>
</span><span id="chartsinput_deco-556"><a href="#chartsinput_deco-556"><span class="linenos">556</span></a>            <span class="n">pandy</span> <span class="o">=</span> <span class="n">pandy</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span><span class="n">renamed</span><span class="p">})</span>
</span><span id="chartsinput_deco-557"><a href="#chartsinput_deco-557"><span class="linenos">557</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">renamed</span>
</span><span id="chartsinput_deco-558"><a href="#chartsinput_deco-558"><span class="linenos">558</span></a>            <span class="k">pass</span>
</span><span id="chartsinput_deco-559"><a href="#chartsinput_deco-559"><span class="linenos">559</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="chartsinput_deco-560"><a href="#chartsinput_deco-560"><span class="linenos">560</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">input_field</span> <span class="ow">or</span> <span class="n">input_field</span> <span class="o">==</span> <span class="s1">&#39;standard&#39;</span><span class="p">:</span>
</span><span id="chartsinput_deco-561"><a href="#chartsinput_deco-561"><span class="linenos">561</span></a>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandy</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="chartsinput_deco-562"><a href="#chartsinput_deco-562"><span class="linenos">562</span></a>        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;input&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandy</span>
</span><span id="chartsinput_deco-563"><a href="#chartsinput_deco-563"><span class="linenos">563</span></a>        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="chartsinput_deco-564"><a href="#chartsinput_deco-564"><span class="linenos">564</span></a>    <span class="k">return</span> <span class="n">wrapper</span>
</span></pre></div>


            <div class="docstring"><p>Main decorator it mainly deals with arg testings</p>
</div>


                </section>
                <section id="get">
                            <input id="get-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@chartsinput_deco</div>

        <span class="def">def</span>
        <span class="name">get</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get-568"><a href="#get-568"><span class="linenos">568</span></a><span class="nd">@chartsinput_deco</span>
</span><span id="get-569"><a href="#get-569"><span class="linenos">569</span></a><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="get-570"><a href="#get-570"><span class="linenos">570</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return covid19 data in specified format output (default, by list)</span>
</span><span id="get-571"><a href="#get-571"><span class="linenos">571</span></a><span class="sd">    for specified locations (&#39;where&#39; keyword).</span>
</span><span id="get-572"><a href="#get-572"><span class="linenos">572</span></a><span class="sd">    The used database is set by the setbase() function but can be</span>
</span><span id="get-573"><a href="#get-573"><span class="linenos">573</span></a><span class="sd">    changed on the fly (&#39;whom&#39; keyword)</span>
</span><span id="get-574"><a href="#get-574"><span class="linenos">574</span></a><span class="sd">    Keyword arguments</span>
</span><span id="get-575"><a href="#get-575"><span class="linenos">575</span></a><span class="sd">    -----------------</span>
</span><span id="get-576"><a href="#get-576"><span class="linenos">576</span></a>
</span><span id="get-577"><a href="#get-577"><span class="linenos">577</span></a><span class="sd">    where  --   a single string of location, or list of (mandatory,</span>
</span><span id="get-578"><a href="#get-578"><span class="linenos">578</span></a><span class="sd">                no default value)</span>
</span><span id="get-579"><a href="#get-579"><span class="linenos">579</span></a><span class="sd">    which  --   what sort of data to deliver ( &#39;death&#39;,&#39;confirmed&#39;,</span>
</span><span id="get-580"><a href="#get-580"><span class="linenos">580</span></a><span class="sd">                &#39;recovered&#39; for &#39;jhu&#39; default database). See listwhich() function</span>
</span><span id="get-581"><a href="#get-581"><span class="linenos">581</span></a><span class="sd">                for full list according to the used database.</span>
</span><span id="get-582"><a href="#get-582"><span class="linenos">582</span></a>
</span><span id="get-583"><a href="#get-583"><span class="linenos">583</span></a><span class="sd">    what   --   which data are computed, either in standard mode</span>
</span><span id="get-584"><a href="#get-584"><span class="linenos">584</span></a><span class="sd">                (&#39;standard&#39;, default value), or &#39;daily&#39; (diff with previous day</span>
</span><span id="get-585"><a href="#get-585"><span class="linenos">585</span></a><span class="sd">                and &#39;weekly&#39; (diff with previous week). See</span>
</span><span id="get-586"><a href="#get-586"><span class="linenos">586</span></a><span class="sd">                listwhich() for fullist of available</span>
</span><span id="get-587"><a href="#get-587"><span class="linenos">587</span></a><span class="sd">                Full list of what keyword with the listwhat() function.</span>
</span><span id="get-588"><a href="#get-588"><span class="linenos">588</span></a>
</span><span id="get-589"><a href="#get-589"><span class="linenos">589</span></a><span class="sd">    whom   --   Database specification (overload the setbase()</span>
</span><span id="get-590"><a href="#get-590"><span class="linenos">590</span></a><span class="sd">                function). See listwhom() for supported list</span>
</span><span id="get-591"><a href="#get-591"><span class="linenos">591</span></a>
</span><span id="get-592"><a href="#get-592"><span class="linenos">592</span></a><span class="sd">    when   --   dates are given under the format dd/mm/yyyy. In the when</span>
</span><span id="get-593"><a href="#get-593"><span class="linenos">593</span></a><span class="sd">                option, one can give one date which will be the end of</span>
</span><span id="get-594"><a href="#get-594"><span class="linenos">594</span></a><span class="sd">                the data slice. Or one can give two dates separated with</span>
</span><span id="get-595"><a href="#get-595"><span class="linenos">595</span></a><span class="sd">                &quot;:&quot;, which will define the time cut for the output data</span>
</span><span id="get-596"><a href="#get-596"><span class="linenos">596</span></a><span class="sd">                btw those two dates.</span>
</span><span id="get-597"><a href="#get-597"><span class="linenos">597</span></a>
</span><span id="get-598"><a href="#get-598"><span class="linenos">598</span></a><span class="sd">    output --   output format returned ( pandas (default), array (numpy.array),</span>
</span><span id="get-599"><a href="#get-599"><span class="linenos">599</span></a><span class="sd">                dict or list). See listoutput() function.</span>
</span><span id="get-600"><a href="#get-600"><span class="linenos">600</span></a>
</span><span id="get-601"><a href="#get-601"><span class="linenos">601</span></a><span class="sd">    option --   pre-computing option.</span>
</span><span id="get-602"><a href="#get-602"><span class="linenos">602</span></a><span class="sd">                * nonneg means that negative daily balance is pushed back</span>
</span><span id="get-603"><a href="#get-603"><span class="linenos">603</span></a><span class="sd">                to previousdays in order to have a cumulative function which is</span>
</span><span id="get-604"><a href="#get-604"><span class="linenos">604</span></a><span class="sd">                monotonous increasing.</span>
</span><span id="get-605"><a href="#get-605"><span class="linenos">605</span></a><span class="sd">                * nofillnan means that nan value won&#39;t be filled.</span>
</span><span id="get-606"><a href="#get-606"><span class="linenos">606</span></a><span class="sd">                * smooth7 will perform a 7 day window average of data</span>
</span><span id="get-607"><a href="#get-607"><span class="linenos">607</span></a><span class="sd">                * sumall will return integrated over locations given via the</span>
</span><span id="get-608"><a href="#get-608"><span class="linenos">608</span></a><span class="sd">                where keyword. If using double bracket notation, the sumall</span>
</span><span id="get-609"><a href="#get-609"><span class="linenos">609</span></a><span class="sd">                option is applied for each bracketed member of the where arg.</span>
</span><span id="get-610"><a href="#get-610"><span class="linenos">610</span></a>
</span><span id="get-611"><a href="#get-611"><span class="linenos">611</span></a><span class="sd">                By default : no option.</span>
</span><span id="get-612"><a href="#get-612"><span class="linenos">612</span></a><span class="sd">                See listoption().</span>
</span><span id="get-613"><a href="#get-613"><span class="linenos">613</span></a><span class="sd">    bypop --    normalize by population (if available for the selected database).</span>
</span><span id="get-614"><a href="#get-614"><span class="linenos">614</span></a><span class="sd">                * by default, &#39;no&#39; normalization</span>
</span><span id="get-615"><a href="#get-615"><span class="linenos">615</span></a><span class="sd">                * can normalize by &#39;100&#39;, &#39;1k&#39;, &#39;100k&#39; or &#39;1M&#39;</span>
</span><span id="get-616"><a href="#get-616"><span class="linenos">616</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get-617"><a href="#get-617"><span class="linenos">617</span></a>
</span><span id="get-618"><a href="#get-618"><span class="linenos">618</span></a>    <span class="c1"># manage pop norm if asked</span>
</span><span id="get-619"><a href="#get-619"><span class="linenos">619</span></a>    <span class="c1">#if bypop != &#39;no&#39;:</span>
</span><span id="get-620"><a href="#get-620"><span class="linenos">620</span></a>    <span class="c1">#    if what:</span>
</span><span id="get-621"><a href="#get-621"><span class="linenos">621</span></a>    <span class="c1">#        val2norm=what</span>
</span><span id="get-622"><a href="#get-622"><span class="linenos">622</span></a>    <span class="c1">#    else:</span>
</span><span id="get-623"><a href="#get-623"><span class="linenos">623</span></a>    <span class="c1">#        val2norm=which</span>
</span><span id="get-624"><a href="#get-624"><span class="linenos">624</span></a>    <span class="c1">#    pandy = normbypop(pandy,val2norm,bypop)</span>
</span><span id="get-625"><a href="#get-625"><span class="linenos">625</span></a>    <span class="c1"># casted_data = None</span>
</span><span id="get-626"><a href="#get-626"><span class="linenos">626</span></a>    <span class="n">output</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="get-627"><a href="#get-627"><span class="linenos">627</span></a>    <span class="n">pandy</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="get-628"><a href="#get-628"><span class="linenos">628</span></a>    <span class="n">pandy</span> <span class="o">=</span> <span class="n">pandy</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">)</span>
</span><span id="get-629"><a href="#get-629"><span class="linenos">629</span></a>    <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;pandas&#39;</span><span class="p">:</span>
</span><span id="get-630"><a href="#get-630"><span class="linenos">630</span></a>        <span class="k">def</span> <span class="nf">color_df</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
</span><span id="get-631"><a href="#get-631"><span class="linenos">631</span></a>            <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">columns</span><span class="o">==</span><span class="s1">&#39;date&#39;</span><span class="p">:</span>
</span><span id="get-632"><a href="#get-632"><span class="linenos">632</span></a>                <span class="k">return</span> <span class="s1">&#39;blue&#39;</span>
</span><span id="get-633"><a href="#get-633"><span class="linenos">633</span></a>            <span class="k">elif</span> <span class="n">val</span><span class="o">.</span><span class="n">columns</span><span class="o">==</span><span class="s1">&#39;where&#39;</span><span class="p">:</span>
</span><span id="get-634"><a href="#get-634"><span class="linenos">634</span></a>                <span class="k">return</span> <span class="s1">&#39;red&#39;</span>
</span><span id="get-635"><a href="#get-635"><span class="linenos">635</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="get-636"><a href="#get-636"><span class="linenos">636</span></a>                <span class="k">return</span> <span class="n">black</span>
</span><span id="get-637"><a href="#get-637"><span class="linenos">637</span></a>        <span class="c1">#if &#39;option&#39; in kwargs:</span>
</span><span id="get-638"><a href="#get-638"><span class="linenos">638</span></a>        <span class="c1">#    raise CoaKeyError(&quot;Cannot use option with input pandas data. &quot;</span>
</span><span id="get-639"><a href="#get-639"><span class="linenos">639</span></a>        <span class="c1">#                      &quot;Use option within the get() function instead.&quot;)</span>
</span><span id="get-640"><a href="#get-640"><span class="linenos">640</span></a>        <span class="c1">#pandy = pandy.drop_duplicates([&#39;date&#39;,&#39;clustername&#39;])</span>
</span><span id="get-641"><a href="#get-641"><span class="linenos">641</span></a>        <span class="c1">#pandy = pandy.drop(columns=[&#39;cumul&#39;])</span>
</span><span id="get-642"><a href="#get-642"><span class="linenos">642</span></a>        <span class="c1">#pandy[&#39;cumul&#39;] = pandy[which]</span>
</span><span id="get-643"><a href="#get-643"><span class="linenos">643</span></a>        <span class="n">casted_data</span> <span class="o">=</span> <span class="n">pandy</span>
</span><span id="get-644"><a href="#get-644"><span class="linenos">644</span></a>        <span class="n">col</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">casted_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="get-645"><a href="#get-645"><span class="linenos">645</span></a>        <span class="n">mem</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:,}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">casted_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="get-646"><a href="#get-646"><span class="linenos">646</span></a>        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;Memory usage of all columns: &#39;</span> <span class="o">+</span> <span class="n">mem</span> <span class="o">+</span> <span class="s1">&#39; bytes&#39;</span><span class="p">)</span>
</span><span id="get-647"><a href="#get-647"><span class="linenos">647</span></a>
</span><span id="get-648"><a href="#get-648"><span class="linenos">648</span></a>    <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;geopandas&#39;</span><span class="p">:</span>
</span><span id="get-649"><a href="#get-649"><span class="linenos">649</span></a>        <span class="n">casted_data</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoageo</span><span class="p">(</span><span class="n">pandy</span><span class="p">)</span>
</span><span id="get-650"><a href="#get-650"><span class="linenos">650</span></a>    <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;dict&#39;</span><span class="p">:</span>
</span><span id="get-651"><a href="#get-651"><span class="linenos">651</span></a>        <span class="n">casted_data</span> <span class="o">=</span> <span class="n">pandy</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;split&#39;</span><span class="p">)</span>
</span><span id="get-652"><a href="#get-652"><span class="linenos">652</span></a>    <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span> <span class="ow">or</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;array&#39;</span><span class="p">:</span>
</span><span id="get-653"><a href="#get-653"><span class="linenos">653</span></a>        <span class="n">my_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get-654"><a href="#get-654"><span class="linenos">654</span></a>        <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">pandy</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="get-655"><a href="#get-655"><span class="linenos">655</span></a>            <span class="n">vc</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
</span><span id="get-656"><a href="#get-656"><span class="linenos">656</span></a>            <span class="n">my_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vc</span><span class="p">)</span>
</span><span id="get-657"><a href="#get-657"><span class="linenos">657</span></a>        <span class="n">casted_data</span> <span class="o">=</span> <span class="n">my_list</span>
</span><span id="get-658"><a href="#get-658"><span class="linenos">658</span></a>        <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;array&#39;</span><span class="p">:</span>
</span><span id="get-659"><a href="#get-659"><span class="linenos">659</span></a>            <span class="n">casted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pandy</span><span class="p">)</span>
</span><span id="get-660"><a href="#get-660"><span class="linenos">660</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="get-661"><a href="#get-661"><span class="linenos">661</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Unknown output.&#39;</span><span class="p">)</span>
</span><span id="get-662"><a href="#get-662"><span class="linenos">662</span></a>    <span class="k">return</span> <span class="n">casted_data</span>
</span></pre></div>


            <div class="docstring"><p>Return covid19 data in specified format output (default, by list)
for specified locations ('where' keyword).
The used database is set by the setbase() function but can be
changed on the fly ('whom' keyword)</p>

<h2 id="keyword-arguments">Keyword arguments</h2>

<p>where  --   a single string of location, or list of (mandatory,
            no default value)
which  --   what sort of data to deliver ( 'death','confirmed',
            'recovered' for 'jhu' default database). See listwhich() function
            for full list according to the used database.</p>

<p>what   --   which data are computed, either in standard mode
            ('standard', default value), or 'daily' (diff with previous day
            and 'weekly' (diff with previous week). See
            listwhich() for fullist of available
            Full list of what keyword with the listwhat() function.</p>

<p>whom   --   Database specification (overload the setbase()
            function). See listwhom() for supported list</p>

<p>when   --   dates are given under the format dd/mm/yyyy. In the when
            option, one can give one date which will be the end of
            the data slice. Or one can give two dates separated with
            ":", which will define the time cut for the output data
            btw those two dates.</p>

<p>output --   output format returned ( pandas (default), array (numpy.array),
            dict or list). See listoutput() function.</p>

<p>option --   pre-computing option.
            * nonneg means that negative daily balance is pushed back
            to previousdays in order to have a cumulative function which is
            monotonous increasing.
            * nofillnan means that nan value won't be filled.
            * smooth7 will perform a 7 day window average of data
            * sumall will return integrated over locations given via the
            where keyword. If using double bracket notation, the sumall
            option is applied for each bracketed member of the where arg.</p>

<pre><code>        By default : no option.
        See listoption().
</code></pre>

<p>bypop --    normalize by population (if available for the selected database).
            * by default, 'no' normalization
            * can normalize by '100', '1k', '100k' or '1M'</p>
</div>


                </section>
                <section id="saveoutput">
                            <input id="saveoutput-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">saveoutput</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="saveoutput-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#saveoutput"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="saveoutput-664"><a href="#saveoutput-664"><span class="linenos">664</span></a><span class="k">def</span> <span class="nf">saveoutput</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="saveoutput-665"><a href="#saveoutput-665"><span class="linenos">665</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="saveoutput-666"><a href="#saveoutput-666"><span class="linenos">666</span></a><span class="sd">        Export pycoas pandas as an output file selected by output argument</span>
</span><span id="saveoutput-667"><a href="#saveoutput-667"><span class="linenos">667</span></a><span class="sd">        &#39;pandas&#39;: pandas to save</span>
</span><span id="saveoutput-668"><a href="#saveoutput-668"><span class="linenos">668</span></a><span class="sd">        &#39;saveformat&#39;: excel (default) or csv</span>
</span><span id="saveoutput-669"><a href="#saveoutput-669"><span class="linenos">669</span></a><span class="sd">        &#39;savename&#39;: None (default pycoaout+ &#39;.xlsx/.csv&#39;)</span>
</span><span id="saveoutput-670"><a href="#saveoutput-670"><span class="linenos">670</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="saveoutput-671"><a href="#saveoutput-671"><span class="linenos">671</span></a>    <span class="k">global</span> <span class="n">_db</span>
</span><span id="saveoutput-672"><a href="#saveoutput-672"><span class="linenos">672</span></a>    <span class="n">kwargs_test</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;pandas&#39;</span><span class="p">,</span><span class="s1">&#39;saveformat&#39;</span><span class="p">,</span><span class="s1">&#39;savename&#39;</span><span class="p">],</span> <span class="s1">&#39;Bad args used in the pycoa.saveoutput function.&#39;</span><span class="p">)</span>
</span><span id="saveoutput-673"><a href="#saveoutput-673"><span class="linenos">673</span></a>    <span class="n">pandy</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pandas&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">())</span>
</span><span id="saveoutput-674"><a href="#saveoutput-674"><span class="linenos">674</span></a>    <span class="n">saveformat</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;saveformat&#39;</span><span class="p">,</span> <span class="s1">&#39;excel&#39;</span><span class="p">)</span>
</span><span id="saveoutput-675"><a href="#saveoutput-675"><span class="linenos">675</span></a>    <span class="n">savename</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savename&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="saveoutput-676"><a href="#saveoutput-676"><span class="linenos">676</span></a>    <span class="k">if</span> <span class="n">pandy</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="saveoutput-677"><a href="#saveoutput-677"><span class="linenos">677</span></a>        <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Pandas to save is mandatory there is not default !&#39;</span><span class="p">)</span>
</span><span id="saveoutput-678"><a href="#saveoutput-678"><span class="linenos">678</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="saveoutput-679"><a href="#saveoutput-679"><span class="linenos">679</span></a>        <span class="n">_db</span><span class="o">.</span><span class="n">saveoutput</span><span class="p">(</span><span class="n">pandas</span><span class="o">=</span><span class="n">pandy</span><span class="p">,</span><span class="n">saveformat</span><span class="o">=</span><span class="n">saveformat</span><span class="p">,</span><span class="n">savename</span><span class="o">=</span><span class="n">savename</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Export pycoas pandas as an output file selected by output argument
'pandas': pandas to save
'saveformat': excel (default) or csv
'savename': None (default pycoaout+ '.xlsx/.csv')</p>
</div>


                </section>
                <section id="merger">
                            <input id="merger-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">merger</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="merger-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#merger"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="merger-681"><a href="#merger-681"><span class="linenos">681</span></a><span class="k">def</span> <span class="nf">merger</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="merger-682"><a href="#merger-682"><span class="linenos">682</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="merger-683"><a href="#merger-683"><span class="linenos">683</span></a><span class="sd">    Merge two or more pycoa pandas from get_stats operation</span>
</span><span id="merger-684"><a href="#merger-684"><span class="linenos">684</span></a><span class="sd">    &#39;coapandas&#39;: list (min 2D) of pandas from stats</span>
</span><span id="merger-685"><a href="#merger-685"><span class="linenos">685</span></a><span class="sd">    &#39;whichcol&#39;: list variable associate to the coapandas list to be retrieve</span>
</span><span id="merger-686"><a href="#merger-686"><span class="linenos">686</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="merger-687"><a href="#merger-687"><span class="linenos">687</span></a>    <span class="k">global</span> <span class="n">_db</span>
</span><span id="merger-688"><a href="#merger-688"><span class="linenos">688</span></a>    <span class="n">kwargs_test</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;coapandas&#39;</span><span class="p">],</span> <span class="s1">&#39;Bad args used in the pycoa.merger function.&#39;</span><span class="p">)</span>
</span><span id="merger-689"><a href="#merger-689"><span class="linenos">689</span></a>    <span class="n">listpandy</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coapandas&#39;</span><span class="p">,[])</span>
</span><span id="merger-690"><a href="#merger-690"><span class="linenos">690</span></a>    <span class="k">return</span> <span class="n">_db</span><span class="o">.</span><span class="n">merger</span><span class="p">(</span><span class="n">coapandas</span> <span class="o">=</span> <span class="n">listpandy</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Merge two or more pycoa pandas from get_stats operation
'coapandas': list (min 2D) of pandas from stats
'whichcol': list variable associate to the coapandas list to be retrieve</p>
</div>


                </section>
                <section id="decomap">
                            <input id="decomap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">decomap</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">func</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="decomap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#decomap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="decomap-695"><a href="#decomap-695"><span class="linenos">695</span></a><span class="k">def</span> <span class="nf">decomap</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="decomap-696"><a href="#decomap-696"><span class="linenos">696</span></a>    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="decomap-697"><a href="#decomap-697"><span class="linenos">697</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="decomap-698"><a href="#decomap-698"><span class="linenos">698</span></a><span class="sd">        Create a map according to arguments and options.</span>
</span><span id="decomap-699"><a href="#decomap-699"><span class="linenos">699</span></a><span class="sd">        See help(map).</span>
</span><span id="decomap-700"><a href="#decomap-700"><span class="linenos">700</span></a><span class="sd">        - 2 types of visu are avalailable so far : bokeh or folium (see listvisu())</span>
</span><span id="decomap-701"><a href="#decomap-701"><span class="linenos">701</span></a><span class="sd">        by default visu=&#39;bokeh&#39;</span>
</span><span id="decomap-702"><a href="#decomap-702"><span class="linenos">702</span></a><span class="sd">        - In the default case (i.e visu=&#39;bokeh&#39;) available option are :</span>
</span><span id="decomap-703"><a href="#decomap-703"><span class="linenos">703</span></a><span class="sd">            - dateslider=True: a date slider is called and displayed on the right part of the map</span>
</span><span id="decomap-704"><a href="#decomap-704"><span class="linenos">704</span></a><span class="sd">            - maplabel = text, values are displayed directly on the map</span>
</span><span id="decomap-705"><a href="#decomap-705"><span class="linenos">705</span></a><span class="sd">                       = textinter, values as an integer are displayed directly on the map</span>
</span><span id="decomap-706"><a href="#decomap-706"><span class="linenos">706</span></a><span class="sd">                       = spark, sparkline are displayed directly on the map</span>
</span><span id="decomap-707"><a href="#decomap-707"><span class="linenos">707</span></a><span class="sd">                       = spiral, spiral are displayed directly on the map</span>
</span><span id="decomap-708"><a href="#decomap-708"><span class="linenos">708</span></a><span class="sd">                       = label%, label are in %</span>
</span><span id="decomap-709"><a href="#decomap-709"><span class="linenos">709</span></a><span class="sd">                       = exploded/dense, when available exploded/dense map geometry (for USA &amp; FRA sor far)</span>
</span><span id="decomap-710"><a href="#decomap-710"><span class="linenos">710</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="decomap-711"><a href="#decomap-711"><span class="linenos">711</span></a>        <span class="n">visu</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;visu&#39;</span><span class="p">,</span> <span class="n">listvisu</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="decomap-712"><a href="#decomap-712"><span class="linenos">712</span></a>        <span class="nb">input</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="decomap-713"><a href="#decomap-713"><span class="linenos">713</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="decomap-714"><a href="#decomap-714"><span class="linenos">714</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">input</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="decomap-715"><a href="#decomap-715"><span class="linenos">715</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="decomap-716"><a href="#decomap-716"><span class="linenos">716</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="decomap-717"><a href="#decomap-717"><span class="linenos">717</span></a>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="decomap-718"><a href="#decomap-718"><span class="linenos">718</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">):</span>
</span><span id="decomap-719"><a href="#decomap-719"><span class="linenos">719</span></a>          <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">)</span>
</span><span id="decomap-720"><a href="#decomap-720"><span class="linenos">720</span></a>
</span><span id="decomap-721"><a href="#decomap-721"><span class="linenos">721</span></a>        <span class="n">dateslider</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dateslider&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="decomap-722"><a href="#decomap-722"><span class="linenos">722</span></a>        <span class="n">maplabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;maplabel&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="decomap-723"><a href="#decomap-723"><span class="linenos">723</span></a>        <span class="n">listmaplabel</span><span class="o">=</span><span class="n">_listmaplabel</span>
</span><span id="decomap-724"><a href="#decomap-724"><span class="linenos">724</span></a>        <span class="k">if</span> <span class="n">maplabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="decomap-725"><a href="#decomap-725"><span class="linenos">725</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">maplabel</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
</span><span id="decomap-726"><a href="#decomap-726"><span class="linenos">726</span></a>                <span class="n">maplabel</span> <span class="o">=</span> <span class="p">[</span><span class="n">maplabel</span><span class="p">]</span>
</span><span id="decomap-727"><a href="#decomap-727"><span class="linenos">727</span></a>            <span class="k">if</span>  <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">maplabel</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listmaplabel</span><span class="p">]:</span>
</span><span id="decomap-728"><a href="#decomap-728"><span class="linenos">728</span></a>                <span class="k">raise</span> <span class="n">CoaTypeError</span><span class="p">(</span><span class="s1">&#39;Waiting a correct maplabel value. See help.&#39;</span><span class="p">)</span>
</span><span id="decomap-729"><a href="#decomap-729"><span class="linenos">729</span></a>        <span class="n">sparkline</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="decomap-730"><a href="#decomap-730"><span class="linenos">730</span></a>        <span class="k">if</span> <span class="n">dateslider</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="decomap-731"><a href="#decomap-731"><span class="linenos">731</span></a>            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dateslider&#39;</span><span class="p">]</span>
</span><span id="decomap-732"><a href="#decomap-732"><span class="linenos">732</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cursor_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateslider</span>
</span><span id="decomap-733"><a href="#decomap-733"><span class="linenos">733</span></a>        <span class="k">if</span> <span class="n">maplabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="decomap-734"><a href="#decomap-734"><span class="linenos">734</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="decomap-735"><a href="#decomap-735"><span class="linenos">735</span></a>            <span class="k">if</span> <span class="s1">&#39;text&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="decomap-736"><a href="#decomap-736"><span class="linenos">736</span></a>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
</span><span id="decomap-737"><a href="#decomap-737"><span class="linenos">737</span></a>            <span class="k">if</span> <span class="s1">&#39;textinteger&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="decomap-738"><a href="#decomap-738"><span class="linenos">738</span></a>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;textinteger&#39;</span><span class="p">]</span>
</span><span id="decomap-739"><a href="#decomap-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">listmaplabel</span><span class="p">:</span>
</span><span id="decomap-740"><a href="#decomap-740"><span class="linenos">740</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">maplabel</span> <span class="ow">and</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;textinteger&#39;</span><span class="p">]:</span>
</span><span id="decomap-741"><a href="#decomap-741"><span class="linenos">741</span></a>                    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="decomap-742"><a href="#decomap-742"><span class="linenos">742</span></a>            <span class="c1">#if all([ True if i in [&#39;text&#39;,&#39;spark&#39;,&#39;label%&#39;,&#39;log&#39;] else False for i in kwargs[&#39;maplabel&#39;] ]) :</span>
</span><span id="decomap-743"><a href="#decomap-743"><span class="linenos">743</span></a>            <span class="c1">#    CoaKeyError(&#39;Waiting for a valide label visualisation: text, spark or label%&#39;)</span>
</span><span id="decomap-744"><a href="#decomap-744"><span class="linenos">744</span></a>            <span class="nb">input</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">input_field</span><span class="p">]</span><span class="o">=</span><span class="nb">input</span><span class="p">[</span><span class="n">input_field</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#needed in the case where there are nan else js pb</span>
</span><span id="decomap-745"><a href="#decomap-745"><span class="linenos">745</span></a>        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="decomap-746"><a href="#decomap-746"><span class="linenos">746</span></a>    <span class="k">return</span> <span class="n">inner</span>
</span></pre></div>


    

                </section>
                <section id="figuremap">
                            <input id="figuremap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">figuremap</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="figuremap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#figuremap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="figuremap-696"><a href="#figuremap-696"><span class="linenos">696</span></a>    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="figuremap-697"><a href="#figuremap-697"><span class="linenos">697</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="figuremap-698"><a href="#figuremap-698"><span class="linenos">698</span></a><span class="sd">        Create a map according to arguments and options.</span>
</span><span id="figuremap-699"><a href="#figuremap-699"><span class="linenos">699</span></a><span class="sd">        See help(map).</span>
</span><span id="figuremap-700"><a href="#figuremap-700"><span class="linenos">700</span></a><span class="sd">        - 2 types of visu are avalailable so far : bokeh or folium (see listvisu())</span>
</span><span id="figuremap-701"><a href="#figuremap-701"><span class="linenos">701</span></a><span class="sd">        by default visu=&#39;bokeh&#39;</span>
</span><span id="figuremap-702"><a href="#figuremap-702"><span class="linenos">702</span></a><span class="sd">        - In the default case (i.e visu=&#39;bokeh&#39;) available option are :</span>
</span><span id="figuremap-703"><a href="#figuremap-703"><span class="linenos">703</span></a><span class="sd">            - dateslider=True: a date slider is called and displayed on the right part of the map</span>
</span><span id="figuremap-704"><a href="#figuremap-704"><span class="linenos">704</span></a><span class="sd">            - maplabel = text, values are displayed directly on the map</span>
</span><span id="figuremap-705"><a href="#figuremap-705"><span class="linenos">705</span></a><span class="sd">                       = textinter, values as an integer are displayed directly on the map</span>
</span><span id="figuremap-706"><a href="#figuremap-706"><span class="linenos">706</span></a><span class="sd">                       = spark, sparkline are displayed directly on the map</span>
</span><span id="figuremap-707"><a href="#figuremap-707"><span class="linenos">707</span></a><span class="sd">                       = spiral, spiral are displayed directly on the map</span>
</span><span id="figuremap-708"><a href="#figuremap-708"><span class="linenos">708</span></a><span class="sd">                       = label%, label are in %</span>
</span><span id="figuremap-709"><a href="#figuremap-709"><span class="linenos">709</span></a><span class="sd">                       = exploded/dense, when available exploded/dense map geometry (for USA &amp; FRA sor far)</span>
</span><span id="figuremap-710"><a href="#figuremap-710"><span class="linenos">710</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="figuremap-711"><a href="#figuremap-711"><span class="linenos">711</span></a>        <span class="n">visu</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;visu&#39;</span><span class="p">,</span> <span class="n">listvisu</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="figuremap-712"><a href="#figuremap-712"><span class="linenos">712</span></a>        <span class="nb">input</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="figuremap-713"><a href="#figuremap-713"><span class="linenos">713</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="figuremap-714"><a href="#figuremap-714"><span class="linenos">714</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">input</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="figuremap-715"><a href="#figuremap-715"><span class="linenos">715</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="figuremap-716"><a href="#figuremap-716"><span class="linenos">716</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="figuremap-717"><a href="#figuremap-717"><span class="linenos">717</span></a>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="figuremap-718"><a href="#figuremap-718"><span class="linenos">718</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">):</span>
</span><span id="figuremap-719"><a href="#figuremap-719"><span class="linenos">719</span></a>          <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">)</span>
</span><span id="figuremap-720"><a href="#figuremap-720"><span class="linenos">720</span></a>
</span><span id="figuremap-721"><a href="#figuremap-721"><span class="linenos">721</span></a>        <span class="n">dateslider</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dateslider&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="figuremap-722"><a href="#figuremap-722"><span class="linenos">722</span></a>        <span class="n">maplabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;maplabel&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="figuremap-723"><a href="#figuremap-723"><span class="linenos">723</span></a>        <span class="n">listmaplabel</span><span class="o">=</span><span class="n">_listmaplabel</span>
</span><span id="figuremap-724"><a href="#figuremap-724"><span class="linenos">724</span></a>        <span class="k">if</span> <span class="n">maplabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="figuremap-725"><a href="#figuremap-725"><span class="linenos">725</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">maplabel</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
</span><span id="figuremap-726"><a href="#figuremap-726"><span class="linenos">726</span></a>                <span class="n">maplabel</span> <span class="o">=</span> <span class="p">[</span><span class="n">maplabel</span><span class="p">]</span>
</span><span id="figuremap-727"><a href="#figuremap-727"><span class="linenos">727</span></a>            <span class="k">if</span>  <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">maplabel</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listmaplabel</span><span class="p">]:</span>
</span><span id="figuremap-728"><a href="#figuremap-728"><span class="linenos">728</span></a>                <span class="k">raise</span> <span class="n">CoaTypeError</span><span class="p">(</span><span class="s1">&#39;Waiting a correct maplabel value. See help.&#39;</span><span class="p">)</span>
</span><span id="figuremap-729"><a href="#figuremap-729"><span class="linenos">729</span></a>        <span class="n">sparkline</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="figuremap-730"><a href="#figuremap-730"><span class="linenos">730</span></a>        <span class="k">if</span> <span class="n">dateslider</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="figuremap-731"><a href="#figuremap-731"><span class="linenos">731</span></a>            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dateslider&#39;</span><span class="p">]</span>
</span><span id="figuremap-732"><a href="#figuremap-732"><span class="linenos">732</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cursor_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateslider</span>
</span><span id="figuremap-733"><a href="#figuremap-733"><span class="linenos">733</span></a>        <span class="k">if</span> <span class="n">maplabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="figuremap-734"><a href="#figuremap-734"><span class="linenos">734</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="figuremap-735"><a href="#figuremap-735"><span class="linenos">735</span></a>            <span class="k">if</span> <span class="s1">&#39;text&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="figuremap-736"><a href="#figuremap-736"><span class="linenos">736</span></a>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
</span><span id="figuremap-737"><a href="#figuremap-737"><span class="linenos">737</span></a>            <span class="k">if</span> <span class="s1">&#39;textinteger&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="figuremap-738"><a href="#figuremap-738"><span class="linenos">738</span></a>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;textinteger&#39;</span><span class="p">]</span>
</span><span id="figuremap-739"><a href="#figuremap-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">listmaplabel</span><span class="p">:</span>
</span><span id="figuremap-740"><a href="#figuremap-740"><span class="linenos">740</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">maplabel</span> <span class="ow">and</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;textinteger&#39;</span><span class="p">]:</span>
</span><span id="figuremap-741"><a href="#figuremap-741"><span class="linenos">741</span></a>                    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="figuremap-742"><a href="#figuremap-742"><span class="linenos">742</span></a>            <span class="c1">#if all([ True if i in [&#39;text&#39;,&#39;spark&#39;,&#39;label%&#39;,&#39;log&#39;] else False for i in kwargs[&#39;maplabel&#39;] ]) :</span>
</span><span id="figuremap-743"><a href="#figuremap-743"><span class="linenos">743</span></a>            <span class="c1">#    CoaKeyError(&#39;Waiting for a valide label visualisation: text, spark or label%&#39;)</span>
</span><span id="figuremap-744"><a href="#figuremap-744"><span class="linenos">744</span></a>            <span class="nb">input</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">input_field</span><span class="p">]</span><span class="o">=</span><span class="nb">input</span><span class="p">[</span><span class="n">input_field</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#needed in the case where there are nan else js pb</span>
</span><span id="figuremap-745"><a href="#figuremap-745"><span class="linenos">745</span></a>        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a map according to arguments and options.
See help(map).</p>

<ul>
<li>2 types of visu are avalailable so far : bokeh or folium (see listvisu())
by default visu='bokeh'</li>
<li>In the default case (i.e visu='bokeh') available option are :
<ul>
<li>dateslider=True: a date slider is called and displayed on the right part of the map</li>
<li>maplabel = text, values are displayed directly on the map
= textinter, values as an integer are displayed directly on the map
= spark, sparkline are displayed directly on the map
= spiral, spiral are displayed directly on the map
= label%, label are in %
= exploded/dense, when available exploded/dense map geometry (for USA &amp; FRA sor far)</li>
</ul></li>
</ul>
</div>


                </section>
                <section id="map">
                            <input id="map-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">map</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="map-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#map"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="map-696"><a href="#map-696"><span class="linenos">696</span></a>    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="map-697"><a href="#map-697"><span class="linenos">697</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="map-698"><a href="#map-698"><span class="linenos">698</span></a><span class="sd">        Create a map according to arguments and options.</span>
</span><span id="map-699"><a href="#map-699"><span class="linenos">699</span></a><span class="sd">        See help(map).</span>
</span><span id="map-700"><a href="#map-700"><span class="linenos">700</span></a><span class="sd">        - 2 types of visu are avalailable so far : bokeh or folium (see listvisu())</span>
</span><span id="map-701"><a href="#map-701"><span class="linenos">701</span></a><span class="sd">        by default visu=&#39;bokeh&#39;</span>
</span><span id="map-702"><a href="#map-702"><span class="linenos">702</span></a><span class="sd">        - In the default case (i.e visu=&#39;bokeh&#39;) available option are :</span>
</span><span id="map-703"><a href="#map-703"><span class="linenos">703</span></a><span class="sd">            - dateslider=True: a date slider is called and displayed on the right part of the map</span>
</span><span id="map-704"><a href="#map-704"><span class="linenos">704</span></a><span class="sd">            - maplabel = text, values are displayed directly on the map</span>
</span><span id="map-705"><a href="#map-705"><span class="linenos">705</span></a><span class="sd">                       = textinter, values as an integer are displayed directly on the map</span>
</span><span id="map-706"><a href="#map-706"><span class="linenos">706</span></a><span class="sd">                       = spark, sparkline are displayed directly on the map</span>
</span><span id="map-707"><a href="#map-707"><span class="linenos">707</span></a><span class="sd">                       = spiral, spiral are displayed directly on the map</span>
</span><span id="map-708"><a href="#map-708"><span class="linenos">708</span></a><span class="sd">                       = label%, label are in %</span>
</span><span id="map-709"><a href="#map-709"><span class="linenos">709</span></a><span class="sd">                       = exploded/dense, when available exploded/dense map geometry (for USA &amp; FRA sor far)</span>
</span><span id="map-710"><a href="#map-710"><span class="linenos">710</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="map-711"><a href="#map-711"><span class="linenos">711</span></a>        <span class="n">visu</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;visu&#39;</span><span class="p">,</span> <span class="n">listvisu</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="map-712"><a href="#map-712"><span class="linenos">712</span></a>        <span class="nb">input</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="map-713"><a href="#map-713"><span class="linenos">713</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="map-714"><a href="#map-714"><span class="linenos">714</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">input</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="map-715"><a href="#map-715"><span class="linenos">715</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="map-716"><a href="#map-716"><span class="linenos">716</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="map-717"><a href="#map-717"><span class="linenos">717</span></a>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="map-718"><a href="#map-718"><span class="linenos">718</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">):</span>
</span><span id="map-719"><a href="#map-719"><span class="linenos">719</span></a>          <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">)</span>
</span><span id="map-720"><a href="#map-720"><span class="linenos">720</span></a>
</span><span id="map-721"><a href="#map-721"><span class="linenos">721</span></a>        <span class="n">dateslider</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dateslider&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="map-722"><a href="#map-722"><span class="linenos">722</span></a>        <span class="n">maplabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;maplabel&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="map-723"><a href="#map-723"><span class="linenos">723</span></a>        <span class="n">listmaplabel</span><span class="o">=</span><span class="n">_listmaplabel</span>
</span><span id="map-724"><a href="#map-724"><span class="linenos">724</span></a>        <span class="k">if</span> <span class="n">maplabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="map-725"><a href="#map-725"><span class="linenos">725</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">maplabel</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
</span><span id="map-726"><a href="#map-726"><span class="linenos">726</span></a>                <span class="n">maplabel</span> <span class="o">=</span> <span class="p">[</span><span class="n">maplabel</span><span class="p">]</span>
</span><span id="map-727"><a href="#map-727"><span class="linenos">727</span></a>            <span class="k">if</span>  <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">maplabel</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listmaplabel</span><span class="p">]:</span>
</span><span id="map-728"><a href="#map-728"><span class="linenos">728</span></a>                <span class="k">raise</span> <span class="n">CoaTypeError</span><span class="p">(</span><span class="s1">&#39;Waiting a correct maplabel value. See help.&#39;</span><span class="p">)</span>
</span><span id="map-729"><a href="#map-729"><span class="linenos">729</span></a>        <span class="n">sparkline</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="map-730"><a href="#map-730"><span class="linenos">730</span></a>        <span class="k">if</span> <span class="n">dateslider</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="map-731"><a href="#map-731"><span class="linenos">731</span></a>            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dateslider&#39;</span><span class="p">]</span>
</span><span id="map-732"><a href="#map-732"><span class="linenos">732</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cursor_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateslider</span>
</span><span id="map-733"><a href="#map-733"><span class="linenos">733</span></a>        <span class="k">if</span> <span class="n">maplabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="map-734"><a href="#map-734"><span class="linenos">734</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="map-735"><a href="#map-735"><span class="linenos">735</span></a>            <span class="k">if</span> <span class="s1">&#39;text&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="map-736"><a href="#map-736"><span class="linenos">736</span></a>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
</span><span id="map-737"><a href="#map-737"><span class="linenos">737</span></a>            <span class="k">if</span> <span class="s1">&#39;textinteger&#39;</span> <span class="ow">in</span> <span class="n">maplabel</span><span class="p">:</span>
</span><span id="map-738"><a href="#map-738"><span class="linenos">738</span></a>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;textinteger&#39;</span><span class="p">]</span>
</span><span id="map-739"><a href="#map-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">listmaplabel</span><span class="p">:</span>
</span><span id="map-740"><a href="#map-740"><span class="linenos">740</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">maplabel</span> <span class="ow">and</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;textinteger&#39;</span><span class="p">]:</span>
</span><span id="map-741"><a href="#map-741"><span class="linenos">741</span></a>                    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;maplabel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="map-742"><a href="#map-742"><span class="linenos">742</span></a>            <span class="c1">#if all([ True if i in [&#39;text&#39;,&#39;spark&#39;,&#39;label%&#39;,&#39;log&#39;] else False for i in kwargs[&#39;maplabel&#39;] ]) :</span>
</span><span id="map-743"><a href="#map-743"><span class="linenos">743</span></a>            <span class="c1">#    CoaKeyError(&#39;Waiting for a valide label visualisation: text, spark or label%&#39;)</span>
</span><span id="map-744"><a href="#map-744"><span class="linenos">744</span></a>            <span class="nb">input</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">input_field</span><span class="p">]</span><span class="o">=</span><span class="nb">input</span><span class="p">[</span><span class="n">input_field</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#needed in the case where there are nan else js pb</span>
</span><span id="map-745"><a href="#map-745"><span class="linenos">745</span></a>        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a map according to arguments and options.
See help(map).</p>

<ul>
<li>2 types of visu are avalailable so far : bokeh or folium (see listvisu())
by default visu='bokeh'</li>
<li>In the default case (i.e visu='bokeh') available option are :
<ul>
<li>dateslider=True: a date slider is called and displayed on the right part of the map</li>
<li>maplabel = text, values are displayed directly on the map
= textinter, values as an integer are displayed directly on the map
= spark, sparkline are displayed directly on the map
= spiral, spiral are displayed directly on the map
= label%, label are in %
= exploded/dense, when available exploded/dense map geometry (for USA &amp; FRA sor far)</li>
</ul></li>
</ul>
</div>


                </section>
                <section id="decohist">
                            <input id="decohist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">decohist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">func</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="decohist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#decohist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="decohist-794"><a href="#decohist-794"><span class="linenos">794</span></a><span class="k">def</span> <span class="nf">decohist</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="decohist-795"><a href="#decohist-795"><span class="linenos">795</span></a>    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="decohist-796"><a href="#decohist-796"><span class="linenos">796</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="decohist-797"><a href="#decohist-797"><span class="linenos">797</span></a><span class="sd">        Create histogram according to arguments.</span>
</span><span id="decohist-798"><a href="#decohist-798"><span class="linenos">798</span></a><span class="sd">        See help(hist).</span>
</span><span id="decohist-799"><a href="#decohist-799"><span class="linenos">799</span></a><span class="sd">        Keyword arguments</span>
</span><span id="decohist-800"><a href="#decohist-800"><span class="linenos">800</span></a><span class="sd">        -----------------</span>
</span><span id="decohist-801"><a href="#decohist-801"><span class="linenos">801</span></a>
</span><span id="decohist-802"><a href="#decohist-802"><span class="linenos">802</span></a><span class="sd">        where (mandatory if no input), what, which, whom, when : (see help(get))</span>
</span><span id="decohist-803"><a href="#decohist-803"><span class="linenos">803</span></a>
</span><span id="decohist-804"><a href="#decohist-804"><span class="linenos">804</span></a><span class="sd">        input       --  input data to plot within the pycoa framework (e.g.</span>
</span><span id="decohist-805"><a href="#decohist-805"><span class="linenos">805</span></a><span class="sd">                        after some analysis or filtering). Default is None which</span>
</span><span id="decohist-806"><a href="#decohist-806"><span class="linenos">806</span></a><span class="sd">                        means that we use the basic raw data through the get</span>
</span><span id="decohist-807"><a href="#decohist-807"><span class="linenos">807</span></a><span class="sd">                        function.</span>
</span><span id="decohist-808"><a href="#decohist-808"><span class="linenos">808</span></a><span class="sd">                        When the &#39;input&#39; keyword is set, where, what, which,</span>
</span><span id="decohist-809"><a href="#decohist-809"><span class="linenos">809</span></a><span class="sd">                        whom when keywords are ignored.</span>
</span><span id="decohist-810"><a href="#decohist-810"><span class="linenos">810</span></a><span class="sd">                        input should be given as valid pycoa pandas dataframe.</span>
</span><span id="decohist-811"><a href="#decohist-811"><span class="linenos">811</span></a>
</span><span id="decohist-812"><a href="#decohist-812"><span class="linenos">812</span></a><span class="sd">        input_field --  is the name of the field of the input pandas to plot.</span>
</span><span id="decohist-813"><a href="#decohist-813"><span class="linenos">813</span></a><span class="sd">                        Default is &#39;deaths/standard&#39;, the default output field of</span>
</span><span id="decohist-814"><a href="#decohist-814"><span class="linenos">814</span></a><span class="sd">                        the get() function.</span>
</span><span id="decohist-815"><a href="#decohist-815"><span class="linenos">815</span></a>
</span><span id="decohist-816"><a href="#decohist-816"><span class="linenos">816</span></a><span class="sd">        width_height : width and height of the picture .</span>
</span><span id="decohist-817"><a href="#decohist-817"><span class="linenos">817</span></a><span class="sd">                    If specified should be a list of width and height.</span>
</span><span id="decohist-818"><a href="#decohist-818"><span class="linenos">818</span></a><span class="sd">                    For instance width_height=[400,500]</span>
</span><span id="decohist-819"><a href="#decohist-819"><span class="linenos">819</span></a>
</span><span id="decohist-820"><a href="#decohist-820"><span class="linenos">820</span></a><span class="sd">        typeofhist  --  &#39;bylocation&#39; (default), &#39;byvalue&#39; or pie</span>
</span><span id="decohist-821"><a href="#decohist-821"><span class="linenos">821</span></a>
</span><span id="decohist-822"><a href="#decohist-822"><span class="linenos">822</span></a><span class="sd">        bins        --  number of bins used, only available for &#39;byvalue&#39; type of</span>
</span><span id="decohist-823"><a href="#decohist-823"><span class="linenos">823</span></a><span class="sd">                        histograms.</span>
</span><span id="decohist-824"><a href="#decohist-824"><span class="linenos">824</span></a><span class="sd">                        If none provided, a default value will be used.</span>
</span><span id="decohist-825"><a href="#decohist-825"><span class="linenos">825</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="decohist-826"><a href="#decohist-826"><span class="linenos">826</span></a>        <span class="nb">input</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="decohist-827"><a href="#decohist-827"><span class="linenos">827</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="decohist-828"><a href="#decohist-828"><span class="linenos">828</span></a>        <span class="n">dateslider</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dateslider&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="decohist-829"><a href="#decohist-829"><span class="linenos">829</span></a>        <span class="n">typeofhist</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;typeofhist&#39;</span><span class="p">,</span><span class="n">listhist</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="decohist-830"><a href="#decohist-830"><span class="linenos">830</span></a>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="decohist-831"><a href="#decohist-831"><span class="linenos">831</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">):</span>
</span><span id="decohist-832"><a href="#decohist-832"><span class="linenos">832</span></a>          <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">)</span>
</span><span id="decohist-833"><a href="#decohist-833"><span class="linenos">833</span></a>
</span><span id="decohist-834"><a href="#decohist-834"><span class="linenos">834</span></a>        <span class="k">if</span> <span class="n">dateslider</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="decohist-835"><a href="#decohist-835"><span class="linenos">835</span></a>            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dateslider&#39;</span><span class="p">]</span>
</span><span id="decohist-836"><a href="#decohist-836"><span class="linenos">836</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cursor_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateslider</span>
</span><span id="decohist-837"><a href="#decohist-837"><span class="linenos">837</span></a>
</span><span id="decohist-838"><a href="#decohist-838"><span class="linenos">838</span></a>        <span class="k">if</span> <span class="n">typeofhist</span> <span class="o">==</span> <span class="s1">&#39;bylocation&#39;</span><span class="p">:</span>
</span><span id="decohist-839"><a href="#decohist-839"><span class="linenos">839</span></a>            <span class="k">if</span> <span class="s1">&#39;bins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="decohist-840"><a href="#decohist-840"><span class="linenos">840</span></a>                <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s2">&quot;The bins keyword cannot be set with histograms by location. See help.&quot;</span><span class="p">)</span>
</span><span id="decohist-841"><a href="#decohist-841"><span class="linenos">841</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_horizonhisto</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="decohist-842"><a href="#decohist-842"><span class="linenos">842</span></a>        <span class="k">elif</span> <span class="n">typeofhist</span> <span class="o">==</span> <span class="s1">&#39;byvalue&#39;</span><span class="p">:</span>
</span><span id="decohist-843"><a href="#decohist-843"><span class="linenos">843</span></a>            <span class="k">if</span> <span class="n">dateslider</span><span class="p">:</span>
</span><span id="decohist-844"><a href="#decohist-844"><span class="linenos">844</span></a>                <span class="n">info</span><span class="p">(</span><span class="s1">&#39;dateslider not implemented for typeofhist=</span><span class="se">\&#39;</span><span class="s1">byvalue</span><span class="se">\&#39;</span><span class="s1">.&#39;</span><span class="p">)</span>
</span><span id="decohist-845"><a href="#decohist-845"><span class="linenos">845</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_horizonhisto</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="decohist-846"><a href="#decohist-846"><span class="linenos">846</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="decohist-847"><a href="#decohist-847"><span class="linenos">847</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_histo</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="decohist-848"><a href="#decohist-848"><span class="linenos">848</span></a>        <span class="k">elif</span> <span class="n">typeofhist</span> <span class="o">==</span> <span class="s1">&#39;pie&#39;</span><span class="p">:</span>
</span><span id="decohist-849"><a href="#decohist-849"><span class="linenos">849</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_pie</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="decohist-850"><a href="#decohist-850"><span class="linenos">850</span></a>
</span><span id="decohist-851"><a href="#decohist-851"><span class="linenos">851</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="decohist-852"><a href="#decohist-852"><span class="linenos">852</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Unknown typeofhist value. Available value : listhist().&#39;</span><span class="p">)</span>
</span><span id="decohist-853"><a href="#decohist-853"><span class="linenos">853</span></a>        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span><span id="decohist-854"><a href="#decohist-854"><span class="linenos">854</span></a>    <span class="k">return</span> <span class="n">inner</span>
</span></pre></div>


    

                </section>
                <section id="figurehist">
                            <input id="figurehist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">figurehist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="figurehist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#figurehist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="figurehist-795"><a href="#figurehist-795"><span class="linenos">795</span></a>    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="figurehist-796"><a href="#figurehist-796"><span class="linenos">796</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="figurehist-797"><a href="#figurehist-797"><span class="linenos">797</span></a><span class="sd">        Create histogram according to arguments.</span>
</span><span id="figurehist-798"><a href="#figurehist-798"><span class="linenos">798</span></a><span class="sd">        See help(hist).</span>
</span><span id="figurehist-799"><a href="#figurehist-799"><span class="linenos">799</span></a><span class="sd">        Keyword arguments</span>
</span><span id="figurehist-800"><a href="#figurehist-800"><span class="linenos">800</span></a><span class="sd">        -----------------</span>
</span><span id="figurehist-801"><a href="#figurehist-801"><span class="linenos">801</span></a>
</span><span id="figurehist-802"><a href="#figurehist-802"><span class="linenos">802</span></a><span class="sd">        where (mandatory if no input), what, which, whom, when : (see help(get))</span>
</span><span id="figurehist-803"><a href="#figurehist-803"><span class="linenos">803</span></a>
</span><span id="figurehist-804"><a href="#figurehist-804"><span class="linenos">804</span></a><span class="sd">        input       --  input data to plot within the pycoa framework (e.g.</span>
</span><span id="figurehist-805"><a href="#figurehist-805"><span class="linenos">805</span></a><span class="sd">                        after some analysis or filtering). Default is None which</span>
</span><span id="figurehist-806"><a href="#figurehist-806"><span class="linenos">806</span></a><span class="sd">                        means that we use the basic raw data through the get</span>
</span><span id="figurehist-807"><a href="#figurehist-807"><span class="linenos">807</span></a><span class="sd">                        function.</span>
</span><span id="figurehist-808"><a href="#figurehist-808"><span class="linenos">808</span></a><span class="sd">                        When the &#39;input&#39; keyword is set, where, what, which,</span>
</span><span id="figurehist-809"><a href="#figurehist-809"><span class="linenos">809</span></a><span class="sd">                        whom when keywords are ignored.</span>
</span><span id="figurehist-810"><a href="#figurehist-810"><span class="linenos">810</span></a><span class="sd">                        input should be given as valid pycoa pandas dataframe.</span>
</span><span id="figurehist-811"><a href="#figurehist-811"><span class="linenos">811</span></a>
</span><span id="figurehist-812"><a href="#figurehist-812"><span class="linenos">812</span></a><span class="sd">        input_field --  is the name of the field of the input pandas to plot.</span>
</span><span id="figurehist-813"><a href="#figurehist-813"><span class="linenos">813</span></a><span class="sd">                        Default is &#39;deaths/standard&#39;, the default output field of</span>
</span><span id="figurehist-814"><a href="#figurehist-814"><span class="linenos">814</span></a><span class="sd">                        the get() function.</span>
</span><span id="figurehist-815"><a href="#figurehist-815"><span class="linenos">815</span></a>
</span><span id="figurehist-816"><a href="#figurehist-816"><span class="linenos">816</span></a><span class="sd">        width_height : width and height of the picture .</span>
</span><span id="figurehist-817"><a href="#figurehist-817"><span class="linenos">817</span></a><span class="sd">                    If specified should be a list of width and height.</span>
</span><span id="figurehist-818"><a href="#figurehist-818"><span class="linenos">818</span></a><span class="sd">                    For instance width_height=[400,500]</span>
</span><span id="figurehist-819"><a href="#figurehist-819"><span class="linenos">819</span></a>
</span><span id="figurehist-820"><a href="#figurehist-820"><span class="linenos">820</span></a><span class="sd">        typeofhist  --  &#39;bylocation&#39; (default), &#39;byvalue&#39; or pie</span>
</span><span id="figurehist-821"><a href="#figurehist-821"><span class="linenos">821</span></a>
</span><span id="figurehist-822"><a href="#figurehist-822"><span class="linenos">822</span></a><span class="sd">        bins        --  number of bins used, only available for &#39;byvalue&#39; type of</span>
</span><span id="figurehist-823"><a href="#figurehist-823"><span class="linenos">823</span></a><span class="sd">                        histograms.</span>
</span><span id="figurehist-824"><a href="#figurehist-824"><span class="linenos">824</span></a><span class="sd">                        If none provided, a default value will be used.</span>
</span><span id="figurehist-825"><a href="#figurehist-825"><span class="linenos">825</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="figurehist-826"><a href="#figurehist-826"><span class="linenos">826</span></a>        <span class="nb">input</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="figurehist-827"><a href="#figurehist-827"><span class="linenos">827</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="figurehist-828"><a href="#figurehist-828"><span class="linenos">828</span></a>        <span class="n">dateslider</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dateslider&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="figurehist-829"><a href="#figurehist-829"><span class="linenos">829</span></a>        <span class="n">typeofhist</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;typeofhist&#39;</span><span class="p">,</span><span class="n">listhist</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="figurehist-830"><a href="#figurehist-830"><span class="linenos">830</span></a>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="figurehist-831"><a href="#figurehist-831"><span class="linenos">831</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">):</span>
</span><span id="figurehist-832"><a href="#figurehist-832"><span class="linenos">832</span></a>          <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">)</span>
</span><span id="figurehist-833"><a href="#figurehist-833"><span class="linenos">833</span></a>
</span><span id="figurehist-834"><a href="#figurehist-834"><span class="linenos">834</span></a>        <span class="k">if</span> <span class="n">dateslider</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="figurehist-835"><a href="#figurehist-835"><span class="linenos">835</span></a>            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dateslider&#39;</span><span class="p">]</span>
</span><span id="figurehist-836"><a href="#figurehist-836"><span class="linenos">836</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cursor_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateslider</span>
</span><span id="figurehist-837"><a href="#figurehist-837"><span class="linenos">837</span></a>
</span><span id="figurehist-838"><a href="#figurehist-838"><span class="linenos">838</span></a>        <span class="k">if</span> <span class="n">typeofhist</span> <span class="o">==</span> <span class="s1">&#39;bylocation&#39;</span><span class="p">:</span>
</span><span id="figurehist-839"><a href="#figurehist-839"><span class="linenos">839</span></a>            <span class="k">if</span> <span class="s1">&#39;bins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="figurehist-840"><a href="#figurehist-840"><span class="linenos">840</span></a>                <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s2">&quot;The bins keyword cannot be set with histograms by location. See help.&quot;</span><span class="p">)</span>
</span><span id="figurehist-841"><a href="#figurehist-841"><span class="linenos">841</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_horizonhisto</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="figurehist-842"><a href="#figurehist-842"><span class="linenos">842</span></a>        <span class="k">elif</span> <span class="n">typeofhist</span> <span class="o">==</span> <span class="s1">&#39;byvalue&#39;</span><span class="p">:</span>
</span><span id="figurehist-843"><a href="#figurehist-843"><span class="linenos">843</span></a>            <span class="k">if</span> <span class="n">dateslider</span><span class="p">:</span>
</span><span id="figurehist-844"><a href="#figurehist-844"><span class="linenos">844</span></a>                <span class="n">info</span><span class="p">(</span><span class="s1">&#39;dateslider not implemented for typeofhist=</span><span class="se">\&#39;</span><span class="s1">byvalue</span><span class="se">\&#39;</span><span class="s1">.&#39;</span><span class="p">)</span>
</span><span id="figurehist-845"><a href="#figurehist-845"><span class="linenos">845</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_horizonhisto</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="figurehist-846"><a href="#figurehist-846"><span class="linenos">846</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="figurehist-847"><a href="#figurehist-847"><span class="linenos">847</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_histo</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="figurehist-848"><a href="#figurehist-848"><span class="linenos">848</span></a>        <span class="k">elif</span> <span class="n">typeofhist</span> <span class="o">==</span> <span class="s1">&#39;pie&#39;</span><span class="p">:</span>
</span><span id="figurehist-849"><a href="#figurehist-849"><span class="linenos">849</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_pie</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="figurehist-850"><a href="#figurehist-850"><span class="linenos">850</span></a>
</span><span id="figurehist-851"><a href="#figurehist-851"><span class="linenos">851</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="figurehist-852"><a href="#figurehist-852"><span class="linenos">852</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Unknown typeofhist value. Available value : listhist().&#39;</span><span class="p">)</span>
</span><span id="figurehist-853"><a href="#figurehist-853"><span class="linenos">853</span></a>        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create histogram according to arguments.
See help(hist).</p>

<h2 id="keyword-arguments">Keyword arguments</h2>

<p>where (mandatory if no input), what, which, whom, when : (see help(get))</p>

<p>input       --  input data to plot within the pycoa framework (e.g.
                after some analysis or filtering). Default is None which
                means that we use the basic raw data through the get
                function.
                When the 'input' keyword is set, where, what, which,
                whom when keywords are ignored.
                input should be given as valid pycoa pandas dataframe.</p>

<p>input_field --  is the name of the field of the input pandas to plot.
                Default is 'deaths/standard', the default output field of
                the get() function.</p>

<p>width_height : width and height of the picture .
            If specified should be a list of width and height.
            For instance width_height=[400,500]</p>

<p>typeofhist  --  'bylocation' (default), 'byvalue' or pie</p>

<p>bins        --  number of bins used, only available for 'byvalue' type of
                histograms.
                If none provided, a default value will be used.</p>
</div>


                </section>
                <section id="hist">
                            <input id="hist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">hist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="hist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hist-795"><a href="#hist-795"><span class="linenos">795</span></a>    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="hist-796"><a href="#hist-796"><span class="linenos">796</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hist-797"><a href="#hist-797"><span class="linenos">797</span></a><span class="sd">        Create histogram according to arguments.</span>
</span><span id="hist-798"><a href="#hist-798"><span class="linenos">798</span></a><span class="sd">        See help(hist).</span>
</span><span id="hist-799"><a href="#hist-799"><span class="linenos">799</span></a><span class="sd">        Keyword arguments</span>
</span><span id="hist-800"><a href="#hist-800"><span class="linenos">800</span></a><span class="sd">        -----------------</span>
</span><span id="hist-801"><a href="#hist-801"><span class="linenos">801</span></a>
</span><span id="hist-802"><a href="#hist-802"><span class="linenos">802</span></a><span class="sd">        where (mandatory if no input), what, which, whom, when : (see help(get))</span>
</span><span id="hist-803"><a href="#hist-803"><span class="linenos">803</span></a>
</span><span id="hist-804"><a href="#hist-804"><span class="linenos">804</span></a><span class="sd">        input       --  input data to plot within the pycoa framework (e.g.</span>
</span><span id="hist-805"><a href="#hist-805"><span class="linenos">805</span></a><span class="sd">                        after some analysis or filtering). Default is None which</span>
</span><span id="hist-806"><a href="#hist-806"><span class="linenos">806</span></a><span class="sd">                        means that we use the basic raw data through the get</span>
</span><span id="hist-807"><a href="#hist-807"><span class="linenos">807</span></a><span class="sd">                        function.</span>
</span><span id="hist-808"><a href="#hist-808"><span class="linenos">808</span></a><span class="sd">                        When the &#39;input&#39; keyword is set, where, what, which,</span>
</span><span id="hist-809"><a href="#hist-809"><span class="linenos">809</span></a><span class="sd">                        whom when keywords are ignored.</span>
</span><span id="hist-810"><a href="#hist-810"><span class="linenos">810</span></a><span class="sd">                        input should be given as valid pycoa pandas dataframe.</span>
</span><span id="hist-811"><a href="#hist-811"><span class="linenos">811</span></a>
</span><span id="hist-812"><a href="#hist-812"><span class="linenos">812</span></a><span class="sd">        input_field --  is the name of the field of the input pandas to plot.</span>
</span><span id="hist-813"><a href="#hist-813"><span class="linenos">813</span></a><span class="sd">                        Default is &#39;deaths/standard&#39;, the default output field of</span>
</span><span id="hist-814"><a href="#hist-814"><span class="linenos">814</span></a><span class="sd">                        the get() function.</span>
</span><span id="hist-815"><a href="#hist-815"><span class="linenos">815</span></a>
</span><span id="hist-816"><a href="#hist-816"><span class="linenos">816</span></a><span class="sd">        width_height : width and height of the picture .</span>
</span><span id="hist-817"><a href="#hist-817"><span class="linenos">817</span></a><span class="sd">                    If specified should be a list of width and height.</span>
</span><span id="hist-818"><a href="#hist-818"><span class="linenos">818</span></a><span class="sd">                    For instance width_height=[400,500]</span>
</span><span id="hist-819"><a href="#hist-819"><span class="linenos">819</span></a>
</span><span id="hist-820"><a href="#hist-820"><span class="linenos">820</span></a><span class="sd">        typeofhist  --  &#39;bylocation&#39; (default), &#39;byvalue&#39; or pie</span>
</span><span id="hist-821"><a href="#hist-821"><span class="linenos">821</span></a>
</span><span id="hist-822"><a href="#hist-822"><span class="linenos">822</span></a><span class="sd">        bins        --  number of bins used, only available for &#39;byvalue&#39; type of</span>
</span><span id="hist-823"><a href="#hist-823"><span class="linenos">823</span></a><span class="sd">                        histograms.</span>
</span><span id="hist-824"><a href="#hist-824"><span class="linenos">824</span></a><span class="sd">                        If none provided, a default value will be used.</span>
</span><span id="hist-825"><a href="#hist-825"><span class="linenos">825</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hist-826"><a href="#hist-826"><span class="linenos">826</span></a>        <span class="nb">input</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="hist-827"><a href="#hist-827"><span class="linenos">827</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="hist-828"><a href="#hist-828"><span class="linenos">828</span></a>        <span class="n">dateslider</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dateslider&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="hist-829"><a href="#hist-829"><span class="linenos">829</span></a>        <span class="n">typeofhist</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;typeofhist&#39;</span><span class="p">,</span><span class="n">listhist</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="hist-830"><a href="#hist-830"><span class="linenos">830</span></a>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="hist-831"><a href="#hist-831"><span class="linenos">831</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">):</span>
</span><span id="hist-832"><a href="#hist-832"><span class="linenos">832</span></a>          <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">)</span>
</span><span id="hist-833"><a href="#hist-833"><span class="linenos">833</span></a>
</span><span id="hist-834"><a href="#hist-834"><span class="linenos">834</span></a>        <span class="k">if</span> <span class="n">dateslider</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="hist-835"><a href="#hist-835"><span class="linenos">835</span></a>            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dateslider&#39;</span><span class="p">]</span>
</span><span id="hist-836"><a href="#hist-836"><span class="linenos">836</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cursor_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateslider</span>
</span><span id="hist-837"><a href="#hist-837"><span class="linenos">837</span></a>
</span><span id="hist-838"><a href="#hist-838"><span class="linenos">838</span></a>        <span class="k">if</span> <span class="n">typeofhist</span> <span class="o">==</span> <span class="s1">&#39;bylocation&#39;</span><span class="p">:</span>
</span><span id="hist-839"><a href="#hist-839"><span class="linenos">839</span></a>            <span class="k">if</span> <span class="s1">&#39;bins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="hist-840"><a href="#hist-840"><span class="linenos">840</span></a>                <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s2">&quot;The bins keyword cannot be set with histograms by location. See help.&quot;</span><span class="p">)</span>
</span><span id="hist-841"><a href="#hist-841"><span class="linenos">841</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_horizonhisto</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="hist-842"><a href="#hist-842"><span class="linenos">842</span></a>        <span class="k">elif</span> <span class="n">typeofhist</span> <span class="o">==</span> <span class="s1">&#39;byvalue&#39;</span><span class="p">:</span>
</span><span id="hist-843"><a href="#hist-843"><span class="linenos">843</span></a>            <span class="k">if</span> <span class="n">dateslider</span><span class="p">:</span>
</span><span id="hist-844"><a href="#hist-844"><span class="linenos">844</span></a>                <span class="n">info</span><span class="p">(</span><span class="s1">&#39;dateslider not implemented for typeofhist=</span><span class="se">\&#39;</span><span class="s1">byvalue</span><span class="se">\&#39;</span><span class="s1">.&#39;</span><span class="p">)</span>
</span><span id="hist-845"><a href="#hist-845"><span class="linenos">845</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_horizonhisto</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="hist-846"><a href="#hist-846"><span class="linenos">846</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="hist-847"><a href="#hist-847"><span class="linenos">847</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_histo</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="hist-848"><a href="#hist-848"><span class="linenos">848</span></a>        <span class="k">elif</span> <span class="n">typeofhist</span> <span class="o">==</span> <span class="s1">&#39;pie&#39;</span><span class="p">:</span>
</span><span id="hist-849"><a href="#hist-849"><span class="linenos">849</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_pie</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="hist-850"><a href="#hist-850"><span class="linenos">850</span></a>
</span><span id="hist-851"><a href="#hist-851"><span class="linenos">851</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="hist-852"><a href="#hist-852"><span class="linenos">852</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Unknown typeofhist value. Available value : listhist().&#39;</span><span class="p">)</span>
</span><span id="hist-853"><a href="#hist-853"><span class="linenos">853</span></a>        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create histogram according to arguments.
See help(hist).</p>

<h2 id="keyword-arguments">Keyword arguments</h2>

<p>where (mandatory if no input), what, which, whom, when : (see help(get))</p>

<p>input       --  input data to plot within the pycoa framework (e.g.
                after some analysis or filtering). Default is None which
                means that we use the basic raw data through the get
                function.
                When the 'input' keyword is set, where, what, which,
                whom when keywords are ignored.
                input should be given as valid pycoa pandas dataframe.</p>

<p>input_field --  is the name of the field of the input pandas to plot.
                Default is 'deaths/standard', the default output field of
                the get() function.</p>

<p>width_height : width and height of the picture .
            If specified should be a list of width and height.
            For instance width_height=[400,500]</p>

<p>typeofhist  --  'bylocation' (default), 'byvalue' or pie</p>

<p>bins        --  number of bins used, only available for 'byvalue' type of
                histograms.
                If none provided, a default value will be used.</p>
</div>


                </section>
                <section id="decoplot">
                            <input id="decoplot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">decoplot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">func</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="decoplot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#decoplot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="decoplot-871"><a href="#decoplot-871"><span class="linenos">871</span></a><span class="k">def</span> <span class="nf">decoplot</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="decoplot-872"><a href="#decoplot-872"><span class="linenos">872</span></a>    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="decoplot-873"><a href="#decoplot-873"><span class="linenos">873</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="decoplot-874"><a href="#decoplot-874"><span class="linenos">874</span></a><span class="sd">        Create a date plot according to arguments. See help(plot).</span>
</span><span id="decoplot-875"><a href="#decoplot-875"><span class="linenos">875</span></a><span class="sd">        Keyword arguments</span>
</span><span id="decoplot-876"><a href="#decoplot-876"><span class="linenos">876</span></a><span class="sd">        -----------------</span>
</span><span id="decoplot-877"><a href="#decoplot-877"><span class="linenos">877</span></a>
</span><span id="decoplot-878"><a href="#decoplot-878"><span class="linenos">878</span></a><span class="sd">        where (mandatory), what, which, whom, when : (see help(get))</span>
</span><span id="decoplot-879"><a href="#decoplot-879"><span class="linenos">879</span></a>
</span><span id="decoplot-880"><a href="#decoplot-880"><span class="linenos">880</span></a><span class="sd">        input       --  input data to plot within the pycoa framework (e.g.</span>
</span><span id="decoplot-881"><a href="#decoplot-881"><span class="linenos">881</span></a><span class="sd">                        after some analysis or filtering). Default is None which</span>
</span><span id="decoplot-882"><a href="#decoplot-882"><span class="linenos">882</span></a><span class="sd">                        means that we use the basic raw data through the get</span>
</span><span id="decoplot-883"><a href="#decoplot-883"><span class="linenos">883</span></a><span class="sd">                        function.</span>
</span><span id="decoplot-884"><a href="#decoplot-884"><span class="linenos">884</span></a><span class="sd">                        When the &#39;input&#39; keyword is set, where, what, which,</span>
</span><span id="decoplot-885"><a href="#decoplot-885"><span class="linenos">885</span></a><span class="sd">                        whom when keywords are ignored.</span>
</span><span id="decoplot-886"><a href="#decoplot-886"><span class="linenos">886</span></a><span class="sd">                        input should be given as valid pycoa pandas dataframe.</span>
</span><span id="decoplot-887"><a href="#decoplot-887"><span class="linenos">887</span></a>
</span><span id="decoplot-888"><a href="#decoplot-888"><span class="linenos">888</span></a><span class="sd">        input_field --  is the name of the field of the input pandas to plot.</span>
</span><span id="decoplot-889"><a href="#decoplot-889"><span class="linenos">889</span></a><span class="sd">                        Default is &#39;deaths/standard&#39;, the default output field of</span>
</span><span id="decoplot-890"><a href="#decoplot-890"><span class="linenos">890</span></a><span class="sd">                        the get() function.</span>
</span><span id="decoplot-891"><a href="#decoplot-891"><span class="linenos">891</span></a>
</span><span id="decoplot-892"><a href="#decoplot-892"><span class="linenos">892</span></a><span class="sd">        width_height : width and height of the picture .</span>
</span><span id="decoplot-893"><a href="#decoplot-893"><span class="linenos">893</span></a><span class="sd">                    If specified should be a list of width and height. For instance width_height=[400,500]</span>
</span><span id="decoplot-894"><a href="#decoplot-894"><span class="linenos">894</span></a>
</span><span id="decoplot-895"><a href="#decoplot-895"><span class="linenos">895</span></a><span class="sd">        title       --  to force the title of the plot</span>
</span><span id="decoplot-896"><a href="#decoplot-896"><span class="linenos">896</span></a>
</span><span id="decoplot-897"><a href="#decoplot-897"><span class="linenos">897</span></a><span class="sd">        textcopyright - to force the copyright lower left of the graph</span>
</span><span id="decoplot-898"><a href="#decoplot-898"><span class="linenos">898</span></a>
</span><span id="decoplot-899"><a href="#decoplot-899"><span class="linenos">899</span></a><span class="sd">        typeofplot  -- &#39;date&#39; (default), &#39;menulocation&#39; or &#39;versus&#39;</span>
</span><span id="decoplot-900"><a href="#decoplot-900"><span class="linenos">900</span></a><span class="sd">                       &#39;date&#39;:date plot</span>
</span><span id="decoplot-901"><a href="#decoplot-901"><span class="linenos">901</span></a><span class="sd">                       &#39;spiral&#39;: spiral plot if several location only the first one</span>
</span><span id="decoplot-902"><a href="#decoplot-902"><span class="linenos">902</span></a><span class="sd">                       &#39;menulocation&#39;: date plot with two scroll menu locations.</span>
</span><span id="decoplot-903"><a href="#decoplot-903"><span class="linenos">903</span></a><span class="sd">                                        Usefull to study the behaviour of a variable for two different countries.</span>
</span><span id="decoplot-904"><a href="#decoplot-904"><span class="linenos">904</span></a><span class="sd">                       &#39;versus&#39;: plot variable against an other one.</span>
</span><span id="decoplot-905"><a href="#decoplot-905"><span class="linenos">905</span></a><span class="sd">                                 For this type of plot one should used &#39;input&#39; and &#39;input_field&#39; (not fully tested).</span>
</span><span id="decoplot-906"><a href="#decoplot-906"><span class="linenos">906</span></a><span class="sd">                                 Moreover dim(input_field) must be 2.</span>
</span><span id="decoplot-907"><a href="#decoplot-907"><span class="linenos">907</span></a><span class="sd">                        &#39;spiral&#39; : plot variable as a spiral angular plot, angle being the date</span>
</span><span id="decoplot-908"><a href="#decoplot-908"><span class="linenos">908</span></a><span class="sd">                        &#39;yearly&#39; : same as date but modulo 1 year</span>
</span><span id="decoplot-909"><a href="#decoplot-909"><span class="linenos">909</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="decoplot-910"><a href="#decoplot-910"><span class="linenos">910</span></a>        <span class="nb">input</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="decoplot-911"><a href="#decoplot-911"><span class="linenos">911</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="decoplot-912"><a href="#decoplot-912"><span class="linenos">912</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">input</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="decoplot-913"><a href="#decoplot-913"><span class="linenos">913</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="decoplot-914"><a href="#decoplot-914"><span class="linenos">914</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="decoplot-915"><a href="#decoplot-915"><span class="linenos">915</span></a>        <span class="n">typeofplot</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;typeofplot&#39;</span><span class="p">,</span><span class="n">listplot</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="decoplot-916"><a href="#decoplot-916"><span class="linenos">916</span></a>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="decoplot-917"><a href="#decoplot-917"><span class="linenos">917</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">):</span>
</span><span id="decoplot-918"><a href="#decoplot-918"><span class="linenos">918</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">)</span>
</span><span id="decoplot-919"><a href="#decoplot-919"><span class="linenos">919</span></a>
</span><span id="decoplot-920"><a href="#decoplot-920"><span class="linenos">920</span></a>        <span class="k">if</span> <span class="s1">&#39;typeofplot&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="decoplot-921"><a href="#decoplot-921"><span class="linenos">921</span></a>            <span class="n">typeofplot</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;typeofplot&#39;</span><span class="p">)</span>
</span><span id="decoplot-922"><a href="#decoplot-922"><span class="linenos">922</span></a>        <span class="k">if</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span>
</span><span id="decoplot-923"><a href="#decoplot-923"><span class="linenos">923</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="decoplot-924"><a href="#decoplot-924"><span class="linenos">924</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;spiral&#39;</span><span class="p">:</span>
</span><span id="decoplot-925"><a href="#decoplot-925"><span class="linenos">925</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_spiral_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="decoplot-926"><a href="#decoplot-926"><span class="linenos">926</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;versus&#39;</span><span class="p">:</span>
</span><span id="decoplot-927"><a href="#decoplot-927"><span class="linenos">927</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_field</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_field</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="decoplot-928"><a href="#decoplot-928"><span class="linenos">928</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="decoplot-929"><a href="#decoplot-929"><span class="linenos">929</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="decoplot-930"><a href="#decoplot-930"><span class="linenos">930</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;typeofplot is versus but dim(input_field)!=2, versus has not effect ...&#39;</span><span class="p">)</span>
</span><span id="decoplot-931"><a href="#decoplot-931"><span class="linenos">931</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="decoplot-932"><a href="#decoplot-932"><span class="linenos">932</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;menulocation&#39;</span><span class="p">:</span>
</span><span id="decoplot-933"><a href="#decoplot-933"><span class="linenos">933</span></a>            <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nation&#39;</span> <span class="ow">and</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;World&#39;</span><span class="p">:</span>
</span><span id="decoplot-934"><a href="#decoplot-934"><span class="linenos">934</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;typeofplot is menulocation with a national DB granularity, use date plot instead ...&#39;</span><span class="p">)</span>
</span><span id="decoplot-935"><a href="#decoplot-935"><span class="linenos">935</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="decoplot-936"><a href="#decoplot-936"><span class="linenos">936</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="decoplot-937"><a href="#decoplot-937"><span class="linenos">937</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_field</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_field</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="decoplot-938"><a href="#decoplot-938"><span class="linenos">938</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;typeofplot is menulocation but dim(input_field)&gt;1, menulocation has not effect ...&#39;</span><span class="p">)</span>
</span><span id="decoplot-939"><a href="#decoplot-939"><span class="linenos">939</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_scrollingmenu</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="decoplot-940"><a href="#decoplot-940"><span class="linenos">940</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;yearly&#39;</span><span class="p">:</span>
</span><span id="decoplot-941"><a href="#decoplot-941"><span class="linenos">941</span></a>            <span class="k">if</span> <span class="nb">input</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="nb">input</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">):</span>
</span><span id="decoplot-942"><a href="#decoplot-942"><span class="linenos">942</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yearly will not be used since the time covered is less than 1 year&quot;</span><span class="p">)</span>
</span><span id="decoplot-943"><a href="#decoplot-943"><span class="linenos">943</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="decoplot-944"><a href="#decoplot-944"><span class="linenos">944</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="decoplot-945"><a href="#decoplot-945"><span class="linenos">945</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_yearly_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="decoplot-946"><a href="#decoplot-946"><span class="linenos">946</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="decoplot-947"><a href="#decoplot-947"><span class="linenos">947</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Unknown typeofplot value. Should be date, versus, menulocation or spiral.&#39;</span><span class="p">)</span>
</span><span id="decoplot-948"><a href="#decoplot-948"><span class="linenos">948</span></a>        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span><span id="decoplot-949"><a href="#decoplot-949"><span class="linenos">949</span></a>    <span class="k">return</span> <span class="n">inner</span>
</span></pre></div>


    

                </section>
                <section id="figureplot">
                            <input id="figureplot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">figureplot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="figureplot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#figureplot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="figureplot-872"><a href="#figureplot-872"><span class="linenos">872</span></a>    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="figureplot-873"><a href="#figureplot-873"><span class="linenos">873</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="figureplot-874"><a href="#figureplot-874"><span class="linenos">874</span></a><span class="sd">        Create a date plot according to arguments. See help(plot).</span>
</span><span id="figureplot-875"><a href="#figureplot-875"><span class="linenos">875</span></a><span class="sd">        Keyword arguments</span>
</span><span id="figureplot-876"><a href="#figureplot-876"><span class="linenos">876</span></a><span class="sd">        -----------------</span>
</span><span id="figureplot-877"><a href="#figureplot-877"><span class="linenos">877</span></a>
</span><span id="figureplot-878"><a href="#figureplot-878"><span class="linenos">878</span></a><span class="sd">        where (mandatory), what, which, whom, when : (see help(get))</span>
</span><span id="figureplot-879"><a href="#figureplot-879"><span class="linenos">879</span></a>
</span><span id="figureplot-880"><a href="#figureplot-880"><span class="linenos">880</span></a><span class="sd">        input       --  input data to plot within the pycoa framework (e.g.</span>
</span><span id="figureplot-881"><a href="#figureplot-881"><span class="linenos">881</span></a><span class="sd">                        after some analysis or filtering). Default is None which</span>
</span><span id="figureplot-882"><a href="#figureplot-882"><span class="linenos">882</span></a><span class="sd">                        means that we use the basic raw data through the get</span>
</span><span id="figureplot-883"><a href="#figureplot-883"><span class="linenos">883</span></a><span class="sd">                        function.</span>
</span><span id="figureplot-884"><a href="#figureplot-884"><span class="linenos">884</span></a><span class="sd">                        When the &#39;input&#39; keyword is set, where, what, which,</span>
</span><span id="figureplot-885"><a href="#figureplot-885"><span class="linenos">885</span></a><span class="sd">                        whom when keywords are ignored.</span>
</span><span id="figureplot-886"><a href="#figureplot-886"><span class="linenos">886</span></a><span class="sd">                        input should be given as valid pycoa pandas dataframe.</span>
</span><span id="figureplot-887"><a href="#figureplot-887"><span class="linenos">887</span></a>
</span><span id="figureplot-888"><a href="#figureplot-888"><span class="linenos">888</span></a><span class="sd">        input_field --  is the name of the field of the input pandas to plot.</span>
</span><span id="figureplot-889"><a href="#figureplot-889"><span class="linenos">889</span></a><span class="sd">                        Default is &#39;deaths/standard&#39;, the default output field of</span>
</span><span id="figureplot-890"><a href="#figureplot-890"><span class="linenos">890</span></a><span class="sd">                        the get() function.</span>
</span><span id="figureplot-891"><a href="#figureplot-891"><span class="linenos">891</span></a>
</span><span id="figureplot-892"><a href="#figureplot-892"><span class="linenos">892</span></a><span class="sd">        width_height : width and height of the picture .</span>
</span><span id="figureplot-893"><a href="#figureplot-893"><span class="linenos">893</span></a><span class="sd">                    If specified should be a list of width and height. For instance width_height=[400,500]</span>
</span><span id="figureplot-894"><a href="#figureplot-894"><span class="linenos">894</span></a>
</span><span id="figureplot-895"><a href="#figureplot-895"><span class="linenos">895</span></a><span class="sd">        title       --  to force the title of the plot</span>
</span><span id="figureplot-896"><a href="#figureplot-896"><span class="linenos">896</span></a>
</span><span id="figureplot-897"><a href="#figureplot-897"><span class="linenos">897</span></a><span class="sd">        textcopyright - to force the copyright lower left of the graph</span>
</span><span id="figureplot-898"><a href="#figureplot-898"><span class="linenos">898</span></a>
</span><span id="figureplot-899"><a href="#figureplot-899"><span class="linenos">899</span></a><span class="sd">        typeofplot  -- &#39;date&#39; (default), &#39;menulocation&#39; or &#39;versus&#39;</span>
</span><span id="figureplot-900"><a href="#figureplot-900"><span class="linenos">900</span></a><span class="sd">                       &#39;date&#39;:date plot</span>
</span><span id="figureplot-901"><a href="#figureplot-901"><span class="linenos">901</span></a><span class="sd">                       &#39;spiral&#39;: spiral plot if several location only the first one</span>
</span><span id="figureplot-902"><a href="#figureplot-902"><span class="linenos">902</span></a><span class="sd">                       &#39;menulocation&#39;: date plot with two scroll menu locations.</span>
</span><span id="figureplot-903"><a href="#figureplot-903"><span class="linenos">903</span></a><span class="sd">                                        Usefull to study the behaviour of a variable for two different countries.</span>
</span><span id="figureplot-904"><a href="#figureplot-904"><span class="linenos">904</span></a><span class="sd">                       &#39;versus&#39;: plot variable against an other one.</span>
</span><span id="figureplot-905"><a href="#figureplot-905"><span class="linenos">905</span></a><span class="sd">                                 For this type of plot one should used &#39;input&#39; and &#39;input_field&#39; (not fully tested).</span>
</span><span id="figureplot-906"><a href="#figureplot-906"><span class="linenos">906</span></a><span class="sd">                                 Moreover dim(input_field) must be 2.</span>
</span><span id="figureplot-907"><a href="#figureplot-907"><span class="linenos">907</span></a><span class="sd">                        &#39;spiral&#39; : plot variable as a spiral angular plot, angle being the date</span>
</span><span id="figureplot-908"><a href="#figureplot-908"><span class="linenos">908</span></a><span class="sd">                        &#39;yearly&#39; : same as date but modulo 1 year</span>
</span><span id="figureplot-909"><a href="#figureplot-909"><span class="linenos">909</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="figureplot-910"><a href="#figureplot-910"><span class="linenos">910</span></a>        <span class="nb">input</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="figureplot-911"><a href="#figureplot-911"><span class="linenos">911</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="figureplot-912"><a href="#figureplot-912"><span class="linenos">912</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">input</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="figureplot-913"><a href="#figureplot-913"><span class="linenos">913</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="figureplot-914"><a href="#figureplot-914"><span class="linenos">914</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="figureplot-915"><a href="#figureplot-915"><span class="linenos">915</span></a>        <span class="n">typeofplot</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;typeofplot&#39;</span><span class="p">,</span><span class="n">listplot</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="figureplot-916"><a href="#figureplot-916"><span class="linenos">916</span></a>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="figureplot-917"><a href="#figureplot-917"><span class="linenos">917</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">):</span>
</span><span id="figureplot-918"><a href="#figureplot-918"><span class="linenos">918</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">)</span>
</span><span id="figureplot-919"><a href="#figureplot-919"><span class="linenos">919</span></a>
</span><span id="figureplot-920"><a href="#figureplot-920"><span class="linenos">920</span></a>        <span class="k">if</span> <span class="s1">&#39;typeofplot&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="figureplot-921"><a href="#figureplot-921"><span class="linenos">921</span></a>            <span class="n">typeofplot</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;typeofplot&#39;</span><span class="p">)</span>
</span><span id="figureplot-922"><a href="#figureplot-922"><span class="linenos">922</span></a>        <span class="k">if</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span>
</span><span id="figureplot-923"><a href="#figureplot-923"><span class="linenos">923</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="figureplot-924"><a href="#figureplot-924"><span class="linenos">924</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;spiral&#39;</span><span class="p">:</span>
</span><span id="figureplot-925"><a href="#figureplot-925"><span class="linenos">925</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_spiral_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="figureplot-926"><a href="#figureplot-926"><span class="linenos">926</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;versus&#39;</span><span class="p">:</span>
</span><span id="figureplot-927"><a href="#figureplot-927"><span class="linenos">927</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_field</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_field</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="figureplot-928"><a href="#figureplot-928"><span class="linenos">928</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="figureplot-929"><a href="#figureplot-929"><span class="linenos">929</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="figureplot-930"><a href="#figureplot-930"><span class="linenos">930</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;typeofplot is versus but dim(input_field)!=2, versus has not effect ...&#39;</span><span class="p">)</span>
</span><span id="figureplot-931"><a href="#figureplot-931"><span class="linenos">931</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="figureplot-932"><a href="#figureplot-932"><span class="linenos">932</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;menulocation&#39;</span><span class="p">:</span>
</span><span id="figureplot-933"><a href="#figureplot-933"><span class="linenos">933</span></a>            <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nation&#39;</span> <span class="ow">and</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;World&#39;</span><span class="p">:</span>
</span><span id="figureplot-934"><a href="#figureplot-934"><span class="linenos">934</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;typeofplot is menulocation with a national DB granularity, use date plot instead ...&#39;</span><span class="p">)</span>
</span><span id="figureplot-935"><a href="#figureplot-935"><span class="linenos">935</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="figureplot-936"><a href="#figureplot-936"><span class="linenos">936</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="figureplot-937"><a href="#figureplot-937"><span class="linenos">937</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_field</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_field</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="figureplot-938"><a href="#figureplot-938"><span class="linenos">938</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;typeofplot is menulocation but dim(input_field)&gt;1, menulocation has not effect ...&#39;</span><span class="p">)</span>
</span><span id="figureplot-939"><a href="#figureplot-939"><span class="linenos">939</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_scrollingmenu</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="figureplot-940"><a href="#figureplot-940"><span class="linenos">940</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;yearly&#39;</span><span class="p">:</span>
</span><span id="figureplot-941"><a href="#figureplot-941"><span class="linenos">941</span></a>            <span class="k">if</span> <span class="nb">input</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="nb">input</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">):</span>
</span><span id="figureplot-942"><a href="#figureplot-942"><span class="linenos">942</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yearly will not be used since the time covered is less than 1 year&quot;</span><span class="p">)</span>
</span><span id="figureplot-943"><a href="#figureplot-943"><span class="linenos">943</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="figureplot-944"><a href="#figureplot-944"><span class="linenos">944</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="figureplot-945"><a href="#figureplot-945"><span class="linenos">945</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_yearly_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="figureplot-946"><a href="#figureplot-946"><span class="linenos">946</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="figureplot-947"><a href="#figureplot-947"><span class="linenos">947</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Unknown typeofplot value. Should be date, versus, menulocation or spiral.&#39;</span><span class="p">)</span>
</span><span id="figureplot-948"><a href="#figureplot-948"><span class="linenos">948</span></a>        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a date plot according to arguments. See help(plot).</p>

<h2 id="keyword-arguments">Keyword arguments</h2>

<p>where (mandatory), what, which, whom, when : (see help(get))</p>

<p>input       --  input data to plot within the pycoa framework (e.g.
                after some analysis or filtering). Default is None which
                means that we use the basic raw data through the get
                function.
                When the 'input' keyword is set, where, what, which,
                whom when keywords are ignored.
                input should be given as valid pycoa pandas dataframe.</p>

<p>input_field --  is the name of the field of the input pandas to plot.
                Default is 'deaths/standard', the default output field of
                the get() function.</p>

<p>width_height : width and height of the picture .
            If specified should be a list of width and height. For instance width_height=[400,500]</p>

<p>title       --  to force the title of the plot</p>

<p>textcopyright - to force the copyright lower left of the graph</p>

<p>typeofplot  -- 'date' (default), 'menulocation' or 'versus'
               'date':date plot
               'spiral': spiral plot if several location only the first one
               'menulocation': date plot with two scroll menu locations.
                                Usefull to study the behaviour of a variable for two different countries.
               'versus': plot variable against an other one.
                         For this type of plot one should used 'input' and 'input_field' (not fully tested).
                         Moreover dim(input_field) must be 2.
                'spiral' : plot variable as a spiral angular plot, angle being the date
                'yearly' : same as date but modulo 1 year</p>
</div>


                </section>
                <section id="plot">
                            <input id="plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="plot-872"><a href="#plot-872"><span class="linenos">872</span></a>    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="plot-873"><a href="#plot-873"><span class="linenos">873</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="plot-874"><a href="#plot-874"><span class="linenos">874</span></a><span class="sd">        Create a date plot according to arguments. See help(plot).</span>
</span><span id="plot-875"><a href="#plot-875"><span class="linenos">875</span></a><span class="sd">        Keyword arguments</span>
</span><span id="plot-876"><a href="#plot-876"><span class="linenos">876</span></a><span class="sd">        -----------------</span>
</span><span id="plot-877"><a href="#plot-877"><span class="linenos">877</span></a>
</span><span id="plot-878"><a href="#plot-878"><span class="linenos">878</span></a><span class="sd">        where (mandatory), what, which, whom, when : (see help(get))</span>
</span><span id="plot-879"><a href="#plot-879"><span class="linenos">879</span></a>
</span><span id="plot-880"><a href="#plot-880"><span class="linenos">880</span></a><span class="sd">        input       --  input data to plot within the pycoa framework (e.g.</span>
</span><span id="plot-881"><a href="#plot-881"><span class="linenos">881</span></a><span class="sd">                        after some analysis or filtering). Default is None which</span>
</span><span id="plot-882"><a href="#plot-882"><span class="linenos">882</span></a><span class="sd">                        means that we use the basic raw data through the get</span>
</span><span id="plot-883"><a href="#plot-883"><span class="linenos">883</span></a><span class="sd">                        function.</span>
</span><span id="plot-884"><a href="#plot-884"><span class="linenos">884</span></a><span class="sd">                        When the &#39;input&#39; keyword is set, where, what, which,</span>
</span><span id="plot-885"><a href="#plot-885"><span class="linenos">885</span></a><span class="sd">                        whom when keywords are ignored.</span>
</span><span id="plot-886"><a href="#plot-886"><span class="linenos">886</span></a><span class="sd">                        input should be given as valid pycoa pandas dataframe.</span>
</span><span id="plot-887"><a href="#plot-887"><span class="linenos">887</span></a>
</span><span id="plot-888"><a href="#plot-888"><span class="linenos">888</span></a><span class="sd">        input_field --  is the name of the field of the input pandas to plot.</span>
</span><span id="plot-889"><a href="#plot-889"><span class="linenos">889</span></a><span class="sd">                        Default is &#39;deaths/standard&#39;, the default output field of</span>
</span><span id="plot-890"><a href="#plot-890"><span class="linenos">890</span></a><span class="sd">                        the get() function.</span>
</span><span id="plot-891"><a href="#plot-891"><span class="linenos">891</span></a>
</span><span id="plot-892"><a href="#plot-892"><span class="linenos">892</span></a><span class="sd">        width_height : width and height of the picture .</span>
</span><span id="plot-893"><a href="#plot-893"><span class="linenos">893</span></a><span class="sd">                    If specified should be a list of width and height. For instance width_height=[400,500]</span>
</span><span id="plot-894"><a href="#plot-894"><span class="linenos">894</span></a>
</span><span id="plot-895"><a href="#plot-895"><span class="linenos">895</span></a><span class="sd">        title       --  to force the title of the plot</span>
</span><span id="plot-896"><a href="#plot-896"><span class="linenos">896</span></a>
</span><span id="plot-897"><a href="#plot-897"><span class="linenos">897</span></a><span class="sd">        textcopyright - to force the copyright lower left of the graph</span>
</span><span id="plot-898"><a href="#plot-898"><span class="linenos">898</span></a>
</span><span id="plot-899"><a href="#plot-899"><span class="linenos">899</span></a><span class="sd">        typeofplot  -- &#39;date&#39; (default), &#39;menulocation&#39; or &#39;versus&#39;</span>
</span><span id="plot-900"><a href="#plot-900"><span class="linenos">900</span></a><span class="sd">                       &#39;date&#39;:date plot</span>
</span><span id="plot-901"><a href="#plot-901"><span class="linenos">901</span></a><span class="sd">                       &#39;spiral&#39;: spiral plot if several location only the first one</span>
</span><span id="plot-902"><a href="#plot-902"><span class="linenos">902</span></a><span class="sd">                       &#39;menulocation&#39;: date plot with two scroll menu locations.</span>
</span><span id="plot-903"><a href="#plot-903"><span class="linenos">903</span></a><span class="sd">                                        Usefull to study the behaviour of a variable for two different countries.</span>
</span><span id="plot-904"><a href="#plot-904"><span class="linenos">904</span></a><span class="sd">                       &#39;versus&#39;: plot variable against an other one.</span>
</span><span id="plot-905"><a href="#plot-905"><span class="linenos">905</span></a><span class="sd">                                 For this type of plot one should used &#39;input&#39; and &#39;input_field&#39; (not fully tested).</span>
</span><span id="plot-906"><a href="#plot-906"><span class="linenos">906</span></a><span class="sd">                                 Moreover dim(input_field) must be 2.</span>
</span><span id="plot-907"><a href="#plot-907"><span class="linenos">907</span></a><span class="sd">                        &#39;spiral&#39; : plot variable as a spiral angular plot, angle being the date</span>
</span><span id="plot-908"><a href="#plot-908"><span class="linenos">908</span></a><span class="sd">                        &#39;yearly&#39; : same as date but modulo 1 year</span>
</span><span id="plot-909"><a href="#plot-909"><span class="linenos">909</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="plot-910"><a href="#plot-910"><span class="linenos">910</span></a>        <span class="nb">input</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="plot-911"><a href="#plot-911"><span class="linenos">911</span></a>        <span class="n">input_field</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="plot-912"><a href="#plot-912"><span class="linenos">912</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">input</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="plot-913"><a href="#plot-913"><span class="linenos">913</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="plot-914"><a href="#plot-914"><span class="linenos">914</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
</span><span id="plot-915"><a href="#plot-915"><span class="linenos">915</span></a>        <span class="n">typeofplot</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;typeofplot&#39;</span><span class="p">,</span><span class="n">listplot</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="plot-916"><a href="#plot-916"><span class="linenos">916</span></a>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
</span><span id="plot-917"><a href="#plot-917"><span class="linenos">917</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">):</span>
</span><span id="plot-918"><a href="#plot-918"><span class="linenos">918</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bypop&#39;</span><span class="p">)</span>
</span><span id="plot-919"><a href="#plot-919"><span class="linenos">919</span></a>
</span><span id="plot-920"><a href="#plot-920"><span class="linenos">920</span></a>        <span class="k">if</span> <span class="s1">&#39;typeofplot&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="plot-921"><a href="#plot-921"><span class="linenos">921</span></a>            <span class="n">typeofplot</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;typeofplot&#39;</span><span class="p">)</span>
</span><span id="plot-922"><a href="#plot-922"><span class="linenos">922</span></a>        <span class="k">if</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span>
</span><span id="plot-923"><a href="#plot-923"><span class="linenos">923</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="plot-924"><a href="#plot-924"><span class="linenos">924</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;spiral&#39;</span><span class="p">:</span>
</span><span id="plot-925"><a href="#plot-925"><span class="linenos">925</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_spiral_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="plot-926"><a href="#plot-926"><span class="linenos">926</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;versus&#39;</span><span class="p">:</span>
</span><span id="plot-927"><a href="#plot-927"><span class="linenos">927</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_field</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_field</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="plot-928"><a href="#plot-928"><span class="linenos">928</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="plot-929"><a href="#plot-929"><span class="linenos">929</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="plot-930"><a href="#plot-930"><span class="linenos">930</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;typeofplot is versus but dim(input_field)!=2, versus has not effect ...&#39;</span><span class="p">)</span>
</span><span id="plot-931"><a href="#plot-931"><span class="linenos">931</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="plot-932"><a href="#plot-932"><span class="linenos">932</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;menulocation&#39;</span><span class="p">:</span>
</span><span id="plot-933"><a href="#plot-933"><span class="linenos">933</span></a>            <span class="k">if</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nation&#39;</span> <span class="ow">and</span> <span class="n">_db_list_dict</span><span class="p">[</span><span class="n">_whom</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;World&#39;</span><span class="p">:</span>
</span><span id="plot-934"><a href="#plot-934"><span class="linenos">934</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;typeofplot is menulocation with a national DB granularity, use date plot instead ...&#39;</span><span class="p">)</span>
</span><span id="plot-935"><a href="#plot-935"><span class="linenos">935</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="plot-936"><a href="#plot-936"><span class="linenos">936</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="plot-937"><a href="#plot-937"><span class="linenos">937</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_field</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_field</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="plot-938"><a href="#plot-938"><span class="linenos">938</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;typeofplot is menulocation but dim(input_field)&gt;1, menulocation has not effect ...&#39;</span><span class="p">)</span>
</span><span id="plot-939"><a href="#plot-939"><span class="linenos">939</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_scrollingmenu</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="plot-940"><a href="#plot-940"><span class="linenos">940</span></a>        <span class="k">elif</span> <span class="n">typeofplot</span> <span class="o">==</span> <span class="s1">&#39;yearly&#39;</span><span class="p">:</span>
</span><span id="plot-941"><a href="#plot-941"><span class="linenos">941</span></a>            <span class="k">if</span> <span class="nb">input</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="nb">input</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">):</span>
</span><span id="plot-942"><a href="#plot-942"><span class="linenos">942</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yearly will not be used since the time covered is less than 1 year&quot;</span><span class="p">)</span>
</span><span id="plot-943"><a href="#plot-943"><span class="linenos">943</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_date_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="plot-944"><a href="#plot-944"><span class="linenos">944</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="plot-945"><a href="#plot-945"><span class="linenos">945</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">_cocoplot</span><span class="o">.</span><span class="n">pycoa_yearly_plot</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">input_field</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="plot-946"><a href="#plot-946"><span class="linenos">946</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="plot-947"><a href="#plot-947"><span class="linenos">947</span></a>            <span class="k">raise</span> <span class="n">CoaKeyError</span><span class="p">(</span><span class="s1">&#39;Unknown typeofplot value. Should be date, versus, menulocation or spiral.&#39;</span><span class="p">)</span>
</span><span id="plot-948"><a href="#plot-948"><span class="linenos">948</span></a>        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a date plot according to arguments. See help(plot).</p>

<h2 id="keyword-arguments">Keyword arguments</h2>

<p>where (mandatory), what, which, whom, when : (see help(get))</p>

<p>input       --  input data to plot within the pycoa framework (e.g.
                after some analysis or filtering). Default is None which
                means that we use the basic raw data through the get
                function.
                When the 'input' keyword is set, where, what, which,
                whom when keywords are ignored.
                input should be given as valid pycoa pandas dataframe.</p>

<p>input_field --  is the name of the field of the input pandas to plot.
                Default is 'deaths/standard', the default output field of
                the get() function.</p>

<p>width_height : width and height of the picture .
            If specified should be a list of width and height. For instance width_height=[400,500]</p>

<p>title       --  to force the title of the plot</p>

<p>textcopyright - to force the copyright lower left of the graph</p>

<p>typeofplot  -- 'date' (default), 'menulocation' or 'versus'
               'date':date plot
               'spiral': spiral plot if several location only the first one
               'menulocation': date plot with two scroll menu locations.
                                Usefull to study the behaviour of a variable for two different countries.
               'versus': plot variable against an other one.
                         For this type of plot one should used 'input' and 'input_field' (not fully tested).
                         Moreover dim(input_field) must be 2.
                'spiral' : plot variable as a spiral angular plot, angle being the date
                'yearly' : same as date but modulo 1 year</p>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>